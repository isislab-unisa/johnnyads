var hashListener={Registry:function(b,a){this[b]={fun:a}},RegistryAjax:function(b,a){this[b]={fun:a,isAjax:true}},ajaxCallParam:function(a,b){this.url=a;this.callback=b},call:function(b){if(b.length>0){var e=b.shift();var c=this.getHashRegistriedFunAndParam(e);var a=b.length==0;if(c){var d=c.fun(c.hash,a,c.param);if(d&&d.url&&d.callback){$.ajax({url:d.url,success:function(f){d.callback(f);hashListener.call(b)},error:function(f){alert("hash ajax error "+f.responseText)}})}else{hashListener.call(b)}}}},getHashRegistriedFunAndParam:function(a){var b=undefined;if(a.indexOf("=")>0){b=a.split("=")[1];a=a.split("=")[0]}if(this[a]&&this[a].fun){return new this.FunctionParam(this[a].fun,a,b)}return null},FunctionParam:function(a,b,c){this.fun=a;this.hash=b;this.param=c}};$(window).hashchange(function(){if(location.hash==""){if(hashListener.removeAllHashEvent&&hashListener.removeAllHashEvent.fun){hashListener.removeAllHashEvent.fun("/",true,"/")}}var b=location.hash?location.hash.replace(/^#/,""):false;if(hashListener.hashChangeTrackingEvent&&hashListener.hashChangeTrackingEvent.fun){hashListener.hashChangeTrackingEvent.fun(b)}if(b){var a=b.split("/");if(b!="/"&&a.length>0&&hashListener.getHashRegistriedFunAndParam(a[0])){hashListener.call(a)}else{if(hashListener.defaultHashEvent&&hashListener.defaultHashEvent.fun){hashListener.defaultHashEvent.fun(b,true,location.hash.replace(/^#/,""))}}}});$(function(){if(location.hash){$(window).hashchange()}});