!function(){var requirejs,require,define;!function(e){function t(e,t){return b.call(e,t)}function n(e,t){var n,r,i,a,o,s,c,u,l,h,d,p=t&&t.split("/"),f=g.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=e.split("/"),o=e.length-1,g.nodeIdCompat&&y.test(e[o])&&(e[o]=e[o].replace(y,"")),e=p.concat(e),l=0;l<e.length;l+=1)if(d=e[l],"."===d)e.splice(l,1),l-=1;else if(".."===d){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||m)&&f){for(n=e.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),p)for(h=p.length;h>0;h-=1)if(i=f[p.slice(0,h).join("/")],i&&(i=i[r])){a=i,s=l;break}if(a)break;!c&&m&&m[r]&&(c=m[r],u=l)}!a&&c&&(a=c,s=u),a&&(n.splice(0,s,a),e=n.join("/"))}return e}function r(t,n){return function(){return l.apply(e,v.call(arguments,0).concat([t,n]))}}function i(e){return function(t){return n(t,e)}}function a(e){return function(t){p[e]=t}}function o(n){if(t(f,n)){var r=f[n];delete f[n],m[n]=!0,u.apply(e,r)}if(!t(p,n)&&!t(m,n))throw new Error("No "+n);return p[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return g&&g.config&&g.config[e]||{}}}var u,l,h,d,p={},f={},g={},m={},b=Object.prototype.hasOwnProperty,v=[].slice,y=/\.js$/;h=function(e,t){var r,a=s(e),c=a[0];return e=a[1],c&&(c=n(c,t),r=o(c)),c?e=r&&r.normalize?r.normalize(e,i(t)):n(e,t):(e=n(e,t),a=s(e),c=a[0],e=a[1],c&&(r=o(c))),{f:c?c+"!"+e:e,n:e,pr:c,p:r}},d={require:function(e){return r(e)},exports:function(e){var t=p[e];return"undefined"!=typeof t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:c(e)}}},u=function(n,i,s,c){var u,l,g,b,v,y,_=[],x=typeof s;if(c=c||n,"undefined"===x||"function"===x){for(i=!i.length&&s.length?["require","exports","module"]:i,v=0;v<i.length;v+=1)if(b=h(i[v],c),l=b.f,"require"===l)_[v]=d.require(n);else if("exports"===l)_[v]=d.exports(n),y=!0;else if("module"===l)u=_[v]=d.module(n);else if(t(p,l)||t(f,l)||t(m,l))_[v]=o(l);else{if(!b.p)throw new Error(n+" missing "+l);b.p.load(b.n,r(c,!0),a(l),{}),_[v]=p[l]}g=s?s.apply(p[n],_):void 0,n&&(u&&u.exports!==e&&u.exports!==p[n]?p[n]=u.exports:g===e&&y||(p[n]=g))}else n&&(p[n]=s)},requirejs=require=l=function(t,n,r,i,a){if("string"==typeof t)return d[t]?d[t](n):o(h(t,n).f);if(!t.splice){if(g=t,g.deps&&l(g.deps,g.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=a),i?u(e,t,n,r):setTimeout(function(){u(e,t,n,r)},4),l},l.config=function(e){return l(e)},requirejs._defined=p,define=function(e,n,r){n.splice||(r=n,n=[]),t(p,e)||t(f,e)||(f[e]=[e,n,r])},define.amd={jQuery:!0}}(),define("lib/almond/almond",function(){}),define("jquery",[],function(){return window.$}),define("can/util/can",[],function(){var e=window.can||{};("undefined"==typeof GLOBALCAN||GLOBALCAN!==!1)&&(window.can=e),e.isDeferred=function(e){var t=this.isFunction;return e&&t(e.then)&&t(e.pipe)};var t=0;return e.cid=function(e,n){return e._cid?e._cid:e._cid=(n||"")+ ++t},e}),define("can/util/array/each",["can/util/can"],function(e){return e.each=function(e,t,n){var r,i=0;if(e)if("number"==typeof e.length&&e.pop)for(e.attr&&e.attr("length"),r=e.length;r>i&&t.call(n||e[i],e[i],i,e)!==!1;i++);else if(e.hasOwnProperty)for(r in e)if(e.hasOwnProperty(r)&&t.call(n||e[r],e[r],r,e)===!1)break;return e},e}),define("can/util/jquery",["jquery","can/util/can","can/util/array/each"],function(e,t){e.extend(t,e,{trigger:function(t,n,r){t.trigger?t.trigger(n,r):e.event.trigger(n,r,t,!0)},addEvent:function(t,n){return e([this]).bind(t,n),this},removeEvent:function(t,n){return e([this]).unbind(t,n),this},buildFragment:function(t,n){var r,i=e.buildFragment;return t=[t],n=n||document,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,r=i.call(jQuery,t,n),r.cacheable?e.clone(r.fragment):r.fragment||r},$:e,each:t.each}),e.each(["bind","unbind","undelegate","delegate"],function(n,r){t[r]=function(){var t=this[r]?this:e([this]);return t[r].apply(t,arguments),this}}),e.each(["append","filter","addClass","remove","data","get"],function(e,n){t[n]=function(e){return e[n].apply(e,t.makeArray(arguments).slice(1))}});var n=e.cleanData;return e.cleanData=function(r){e.each(r,function(e,n){n&&t.trigger(n,"destroyed",[],!1)}),n(r)},t}),define("can/util/library",["can/util/jquery"],function(e){return e}),define("can/util/string",["can/util/library"],function(e){var t=/_|-/,n=/\=\=/,r=/([A-Z]+)([A-Z][a-z])/g,i=/([a-z\d])([A-Z])/g,a=/([a-z\d])([A-Z])/g,o=/\{([^\}]+)\}/g,s=/"/g,c=/'/g,u=function(e,t,n){return t in e?e[t]:n&&(e[t]={})},l=function(e){return/^f|^o/.test(typeof e)};return e.extend(e,{esc:function(e){var t=null===e||void 0===e||isNaN(e)&&""+e=="NaN";return(""+(t?"":e)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(s,"&#34;").replace(c,"&#39;")},getObject:function(t,n,r){var i,a,o,s=t?t.split("."):[],c=s.length,h=0;if(n=e.isArray(n)?n:[n||window],!c)return n[0];for(;n[h];){for(i=n[h],o=0;c-1>o&&l(i);o++)i=u(i,s[o],r);if(l(i)&&(a=u(i,s[o],r),void 0!==a))return r===!1&&delete i[s[o]],a;h++}},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},underscore:function(e){return e.replace(n,"/").replace(r,"$1_$2").replace(i,"$1_$2").replace(a,"_").toLowerCase()},sub:function(t,n,r){var i=[];return i.push(t.replace(o,function(t,a){var o=e.getObject(a,n,void 0===r?r:!r);return void 0===o?(i=null,""):l(o)&&i?(i.push(o),""):""+o})),null===i?i:i.length<=1?i[0]:i},replacer:o,undHash:t}),e}),define("can/construct",["can/util/string"],function(e){var t=0;return e.Construct=function(){return arguments.length?e.Construct.extend.apply(e.Construct,arguments):void 0},e.extend(e.Construct,{newInstance:function(){{var e,t=this.instance();arguments}return t.setup&&(e=t.setup.apply(t,arguments)),t.init&&t.init.apply(t,e||arguments),t},_inherit:function(t,n,r){e.extend(r||t,t||{})},_overwrite:function(e,t,n,r){e[n]=r},setup:function(t){this.defaults=e.extend(!0,{},t.defaults,this.defaults)},instance:function(){t=1;var e=new this;return t=0,e},extend:function(n,r,i){function a(){return t?void 0:this.constructor!==a&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.constructor.newInstance.apply(this.constructor,arguments)}"string"!=typeof n&&(i=r,r=n,n=null),i||(i=r,r=null),i=i||{};var o,s,c,u,l=this,h=this.prototype;u=this.instance(),e.Construct._inherit(i,h,u);for(o in l)l.hasOwnProperty(o)&&(a[o]=l[o]);if(e.Construct._inherit(r,l,a),n){var d=n.split("."),s=d.pop(),p=e.getObject(d.join("."),window,!0),c=p,f=e.underscore(n.replace(/\./g,"_")),g=e.underscore(s);p[s]=a}e.extend(a,{constructor:a,prototype:u,namespace:c,shortName:s,_shortName:g,fullName:n,_fullName:f}),a.prototype.constructor=a;var m=[l].concat(e.makeArray(arguments)),b=a.setup.apply(a,m);return a.init&&a.init.apply(a,b||m),a}}),e.Construct}),define("can/control",["can/util/library","can/construct"],function(e){var t,n=function(t,n,r){return e.bind.call(t,n,r),function(){e.unbind.call(t,n,r)}},r=e.isFunction,i=e.extend,a=e.each,o=[].slice,s=/\{([^\}]+)\}/g,c=e.getObject("$.event.special",[e])||{},u=function(t,n,r,i){return e.delegate.call(t,n,r,i),function(){e.undelegate.call(t,n,r,i)}},l=function(t,r,i,a){return a?u(t,e.trim(a),r,i):n(t,r,i)},h=e.Control=e.Construct({setup:function(){if(e.Construct.setup.apply(this,arguments),e.Control){var t,n=this;n.actions={};for(t in n.prototype)n._isAction(t)&&(n.actions[t]=n._action(t))}},_shifter:function(t,n){var i="string"==typeof n?t[n]:n;return r(i)||(i=t[i]),function(){return t.called=n,i.apply(t,[this.nodeName?e.$(this):this].concat(o.call(arguments,0)))}},_isAction:function(e){var t=this.prototype[e],n=typeof t;return"constructor"!==e&&("function"==n||"string"==n&&r(this.prototype[t]))&&!!(c[e]||d[e]||/[^\w]/.test(e))},_action:function(n,r){if(s.lastIndex=0,r||!s.test(n)){var i=r?e.sub(n,[r,window]):n;if(!i)return null;var a=e.isArray(i),o=a?i[1]:i,c=o.split(/\s+/g),u=c.pop();return{processor:d[u]||t,parts:[o,c.join(" "),u],delegate:a?i[0]:void 0}}},processors:{},defaults:{}},{setup:function(t,n){var r,a=this.constructor,o=a.pluginName||a._fullName;return this.element=e.$(t),o&&"can_control"!==o&&this.element.addClass(o),(r=e.data(this.element,"controls"))||e.data(this.element,"controls",r=[]),r.push(this),this.options=i({},a.defaults,n),this.on(),[this.element,this.options]},on:function(t,n,r,i){if(!t){this.off();var a,o,s=this.constructor,c=this._bindings,u=s.actions,h=this.element,d=e.Control._shifter(this,"destroy");for(a in u)u.hasOwnProperty(a)&&(o=u[a]||s._action(a,this.options))&&c.push(o.processor(o.delegate||h,o.parts[2],o.parts[1],a,this));return e.bind.call(h,"destroyed",d),c.push(function(t){e.unbind.call(t,"destroyed",d)}),c.length}return"string"==typeof t&&(i=r,r=n,n=t,t=this.element),void 0===i&&(i=r,r=n,n=null),"string"==typeof i&&(i=e.Control._shifter(this,i)),this._bindings.push(l(t,r,i,n)),this._bindings.length},off:function(){var e=this.element[0];a(this._bindings||[],function(t){t(e)}),this._bindings=[]},destroy:function(){var t,n=this.constructor,r=n.pluginName||n._fullName;this.off(),r&&"can_control"!==r&&this.element.removeClass(r),t=e.data(this.element,"controls"),t.splice(e.inArray(this,t),1),e.trigger(this,"destroyed"),this.element=null}}),d=e.Control.processors,t=function(t,n,r,i,a){return l(t,n,e.Control._shifter(a,i),r)};return a(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave"],function(e){d[e]=t}),h}),define("can/control/route",["can/control"],function(){}),define("can/observe",["can/util/library","can/construct"],function(e){var t=function(t){return t&&(e.isArray(t)||e.isPlainObject(t)||t instanceof e.Observe)},n=function(t,n){return e.each(t,function(e){e&&e.unbind&&e.unbind("change"+n)})},r=function(t,r,i,a,o){return a=a||p,o=o||p.List,t instanceof p?n([t],i._cid):t=e.isArray(t)?new o(t):new a(t),t.bind("change"+i._cid,function(){var n=e.makeArray(arguments),a=n.shift();n[0]=("*"===r?[i.indexOf(t),n[0]]:[r,n[0]]).join("."),a.triggeredNS=a.triggeredNS||{},a.triggeredNS[i._cid]||(a.triggeredNS[i._cid]=!0,e.trigger(i,a,n))}),t},i=function(n,r,i){return n.each(function(n,a){i[a]=t(n)&&e.isFunction(n[r])?n[r]():n}),i},a=function(t){return function(){return e[t].apply(this,arguments)}},o=a("addEvent"),s=a("removeEvent"),c=function(t,n){return n?[t]:e.isArray(t)?t:(""+t).split(".")},u=1,l=0,h=[],d=[],p=e.Observe=e.Construct({bind:o,unbind:s,id:"id",canMakeObserve:t,startBatch:function(e){l++,e&&d.push(e)},stopBatch:function(t,n){if(t?l=0:l--,0==l){var r=h.slice(0),i=d.slice(0);h=[],d=[],u++,n&&this.startBatch(),e.each(r,function(t){e.trigger.apply(e,t)}),e.each(i,function(e){e()})}},triggerBatch:function(t,n,r){if(!t._init){if(0==l)return e.trigger(t,n,r);n="string"==typeof n?{type:n}:n,n.batchNum=u,h.push([t,n,r])}},keys:function(e){var t=[];p.__reading&&p.__reading(e,"__keys");for(var n in e._data)t.push(n);return t}},{setup:function(t){this._data={},e.cid(this,".observe"),this._init=1,this.attr(t),this.bind("change"+this._cid,e.proxy(this._changes,this)),delete this._init},_changes:function(e,t,n,r,i){p.triggerBatch(this,{type:t,batchNum:e.batchNum},[r,i])},_triggerChange:function(){p.triggerBatch(this,"change",e.makeArray(arguments))},attr:function(e,t){var n=typeof e;return"string"!==n&&"number"!==n?this._attrs(e,t):void 0===t?(p.__reading&&p.__reading(this,e),this._get(e)):(this._set(e,t),this)},each:function(){return p.__reading&&p.__reading(this,"__keys"),e.each.apply(void 0,[this.__get()].concat(e.makeArray(arguments)))},removeAttr:function(t){var n=this instanceof e.Observe.List,r=c(t),i=r.shift(),a=n?this[i]:this._data[i];return r.length?a.removeAttr(r):(n?this.splice(i,1):i in this._data&&(delete this._data[i],i in this.constructor.prototype||delete this[i],p.triggerBatch(this,"__keys"),this._triggerChange(i,"remove",void 0,a)),a)},_get:function(e){var t="string"==typeof e&&!!~e.indexOf(".")&&this.__get(e);if(t)return t;var n=c(e),r=this.__get(n.shift());return n.length?r?r._get(n):void 0:r},__get:function(e){return e?this._data[e]:this._data},_set:function(e,n,r){var i=c(e,r),a=i.shift(),o=this.__get(a);if(t(o)&&i.length)o._set(i,n);else{if(i.length)throw"can.Observe: Object does not exist";this.__convert&&(n=this.__convert(a,n)),this.__set(a,n,o)}},__set:function(e,i,a){if(i!==a){var o=this.__get().hasOwnProperty(e)?"set":"add";this.___set(e,t(i)?r(i,e,this):i),"add"==o&&p.triggerBatch(this,"__keys",void 0),this._triggerChange(e,o,i,a),a&&n([a],this._cid)}},___set:function(e,t){this._data[e]=t,e in this.constructor.prototype||(this[e]=t)},bind:o,unbind:s,serialize:function(){return i(this,"serialize",{})},_attrs:function(n,r){if(void 0===n)return i(this,"attr",{});n=e.extend({},n);var a,o,s=this;p.startBatch(),this.each(function(i,a){return o=n[a],void 0===o?void(r&&s.removeAttr(a)):(s.__convert&&(o=s.__convert(a,o)),o instanceof e.Observe?s.__set(a,o,i):t(i)&&t(o)&&i.attr?i.attr(o,r):i!=o&&s.__set(a,o,i),void delete n[a])});for(var a in n)o=n[a],this._set(a,o,!0);return p.stopBatch(),this},compute:function(t){var n=this,r=function(e){return n.attr(t,e)};return e.compute?e.compute(r):r}}),f=[].splice,g=p({setup:function(t,n){this.length=0,e.cid(this,".observe"),this._init=1,e.isDeferred(t)?this.replace(t):this.push.apply(this,e.makeArray(t||[])),this.bind("change"+this._cid,e.proxy(this._changes,this)),e.extend(this,n),delete this._init},_triggerChange:function(e,t,n,r){p.prototype._triggerChange.apply(this,arguments),~e.indexOf(".")||("add"===t?(p.triggerBatch(this,t,[n,+e]),p.triggerBatch(this,"length",[this.length])):"remove"===t?(p.triggerBatch(this,t,[r,+e]),p.triggerBatch(this,"length",[this.length])):p.triggerBatch(this,t,[n,+e]))},__get:function(e){return e?this[e]:this},___set:function(e,t){this[e]=t,+e>=this.length&&(this.length=+e+1)},serialize:function(){return i(this,"serialize",[])},splice:function(i,a){var o,s=e.makeArray(arguments);for(o=2;o<s.length;o++){var c=s[o];t(c)&&(s[o]=r(c,"*",this,this.constructor.Observe,this.constructor))}void 0===a&&(a=s[1]=this.length-i);var u=f.apply(this,s);return e.Observe.startBatch(),a>0&&(this._triggerChange(""+i,"remove",void 0,u),n(u,this._cid)),s.length>2&&this._triggerChange(""+i,"add",s.slice(2),u),e.Observe.stopBatch(),u},_attrs:function(t,n){return void 0===t?i(this,"attr",[]):(t=e.makeArray(t),p.startBatch(),this._updateAttrs(t,n),void p.stopBatch())},_updateAttrs:function(e,n){for(var r=Math.min(e.length,this.length),i=0;r>i;i++){var a=this[i],o=e[i];t(a)&&t(o)?a.attr(o,n):a!=o&&this._set(i,o)}e.length>this.length?this.push.apply(this,e.slice(this.length)):e.length<this.length&&n&&this.splice(e.length)}}),m=function(t){return t[0]&&e.isArray(t[0])?t[0]:e.makeArray(t)};return e.each({push:"length",unshift:0},function(e,n){var i=[][n];g.prototype[n]=function(){var n,a,o=[],s=e?this.length:0,c=arguments.length;for(this.constructor;c--;)a=arguments[c],o[c]=t(a)?r(a,"*",this,this.constructor.Observe,this.constructor):a;return n=i.apply(this,o),(!this.comparator||o.length)&&this._triggerChange(""+s,"add",o,void 0),n}}),e.each({pop:"length",shift:0},function(e,t){g.prototype[t]=function(){var n=m(arguments),r=e&&this.length?this.length-1:0,i=[][t].apply(this,n);return this._triggerChange(""+r,"remove",void 0,[i]),i&&i.unbind&&i.unbind("change"+this._cid),i}}),e.extend(g.prototype,{indexOf:function(t){return this.attr("length"),e.inArray(t,this)},join:[].join,reverse:[].reverse,slice:function(){var e=Array.prototype.slice.apply(this,arguments);return new this.constructor(e)},concat:function(){var t=[];return e.each(e.makeArray(arguments),function(n,r){t[r]=n instanceof e.Observe.List?n.serialize():n}),new this.constructor(Array.prototype.concat.apply(this.serialize(),t))},forEach:function(t,n){e.each(this,t,n||this)},replace:function(t){return e.isDeferred(t)?t.then(e.proxy(this.replace,this)):this.splice.apply(this,[0,this.length].concat(e.makeArray(t||[]))),this}}),p.List=g,p.setup=function(){e.Construct.setup.apply(this,arguments),this.List=p.List({Observe:this},{})},p}),define("can/model",["can/util/library","can/observe"],function(e){var t=function(t,n,r){var i=new e.Deferred;return t.then(function(){var t=e.makeArray(arguments);t[0]=n[r](t[0]),i.resolveWith(i,t)},function(){i.rejectWith(this,arguments)}),"function"==typeof t.abort&&(i.abort=function(){return t.abort()}),i},n=0,r=/change.observe\d+/,i=function(t){return e.Observe.__reading&&e.Observe.__reading(t,t.constructor.id),t.__get(t.constructor.id)},a=function(t,n,r,i,a,o){var s={};if("string"==typeof t){var c=t.split(/\s+/);s.url=c.pop(),c.length&&(s.type=c.pop())}else e.extend(s,t);return s.data="object"!=typeof n||e.isArray(n)?n:e.extend(s.data||{},n),s.url=e.sub(s.url,s.data,!0),e.ajax(e.extend({type:r||"post",dataType:i||"json",success:a,error:o},s))},o=function(t,n,r,a,o){var s;e.isArray(t)?(s=t[1],t=t[0]):s=t.serialize(),s=[s];var c,u,l=t.constructor;return"destroy"==n&&s.shift(),"create"!==n&&s.unshift(i(t)),u=l[n].apply(l,s),c=u.pipe(function(e){return t[o||n+"d"](e,u),t}),u.abort&&(c.abort=function(){u.abort()}),c.then(r,a),c},s={create:{url:"_shortName",type:"post"},update:{data:function(t,n){n=n||{};var r=this.id;return n[r]&&n[r]!==t&&(n["new"+e.capitalize(t)]=n[r],delete n[r]),n[r]=t,n},type:"put"},destroy:{type:"delete",data:function(e){var t={};return t.id=t[this.id]=e,t}},findAll:{url:"_shortName"},findOne:{}},c=function(e,t){return function(n){return n=e.data?e.data.apply(this,arguments):n,a(t||this[e.url||"_url"],n,e.type||"get")}};e.Model=e.Observe({fullName:"can.Model",setup:function(t){if(this.store={},e.Observe.setup.apply(this,arguments),e.Model){this.List=u({Observe:this},{});var r=this,i=e.proxy(this._clean,r);e.each(s,function(n,a){if(e.isFunction(r[a])||(r[a]=c(n,r[a])),r["make"+e.capitalize(a)]){var o=r["make"+e.capitalize(a)](r[a]);e.Construct._overwrite(r,t,a,function(){this._reqs++;var e=o.apply(this,arguments),t=e.then(i,i);return t.abort=e.abort,t})}}),"can.Model"!=r.fullName&&r.fullName||(r.fullName="Model"+ ++n),this._reqs=0,this._url=this._shortName+"/{"+this.id+"}"}},_ajax:c,_makeRequest:o,_clean:function(){if(this._reqs--,!this._reqs)for(var e in this.store)this.store[e]._bindings||delete this.store[e];return arguments[0]},models:function(t,n){if(t){if(t instanceof this.List)return t;var r=this,i=[],a=n instanceof e.Observe.List?n:new(r.List||u),o=e.isArray(t),s=t instanceof u,c=o?t:s?t.serialize():t.data;return a.length&&a.splice(0),e.each(c,function(e){i.push(r.model(e))}),a.push.apply(a,i),o||e.each(t,function(e,t){"data"!==t&&a.attr(t,e)}),a}},model:function(e){if(e){e instanceof this&&(e=e.serialize());var t=e[this.id],n=(t||0===t)&&this.store[t]?this.store[t].attr(e,this.removeAttr||!1):new this(e);return this._reqs&&(this.store[e[this.id]]=n),n}}},{isNew:function(){var e=i(this);return!(e||0===e)},save:function(e,t){return o(this,this.isNew()?"create":"update",e,t)},destroy:function(t,n){if(this.isNew()){var r=this;return e.Deferred().done(function(e){r.destroyed(e)}).resolve(r)}return o(this,"destroy",t,n,"destroyed")},bind:function(t){return r.test(t)||(this._bindings||(this.constructor.store[this.__get(this.constructor.id)]=this,this._bindings=0),this._bindings++),e.Observe.prototype.bind.apply(this,arguments)},unbind:function(t){return r.test(t)||(this._bindings--,this._bindings||delete this.constructor.store[i(this)]),e.Observe.prototype.unbind.apply(this,arguments)},___set:function(t,n){e.Observe.prototype.___set.call(this,t,n),t===this.constructor.id&&this._bindings&&(this.constructor.store[i(this)]=this)}}),e.each({makeFindAll:"models",makeFindOne:"model"},function(n,r){e.Model[r]=function(e){return function(r,i,a){var o=t(e.call(this,r),this,n);return o.then(i,a),o}}}),e.each(["created","updated","destroyed"],function(t){e.Model.prototype[t]=function(n){var r,i=this.constructor;r=n&&"object"==typeof n&&this.attr(n.attr?n.attr():n),e.trigger(this,t),e.trigger(this,"change",t),e.trigger(i,t,this)}});var u=e.Model.List=e.Observe.List({setup:function(){e.Observe.List.prototype.setup.apply(this,arguments);var t=this;this.bind("change",function(e,n){if(/\w+\.destroyed/.test(n)){var r=t.indexOf(e.target);-1!=r&&t.splice(r,1)}})}});return e.Model}),define("can/view",["can/util/library"],function(e){var t=e.isFunction,n=e.makeArray,r=1,i=e.view=function(n,r,a,o){t(a)&&(o=a,a=void 0);var s=function(e){return i.frag(e)},c=t(o)?function(e){o(s(e))}:null,u=i.render(n,r,a,c),l=e.Deferred();return t(u)?u:e.isDeferred(u)?(u.then(function(e,t){l.resolve.call(l,s(e),t)},function(){l.fail.apply(l,arguments)}),l):s(u)};e.extend(i,{frag:function(e,t){return i.hookup(i.fragment(e),t)},fragment:function(t){var n=e.buildFragment(t,document.body);return n.childNodes.length||n.appendChild(document.createTextNode("")),n},toId:function(t){return e.map(t.toString().split(/\/|\./g),function(e){return e?e:void 0}).join("_")},hookup:function(t,n){var r,a,o=[];return e.each(t.childNodes?e.makeArray(t.childNodes):t,function(t){1===t.nodeType&&(o.push(t),o.push.apply(o,e.makeArray(t.getElementsByTagName("*"))))}),e.each(o,function(e){e.getAttribute&&(r=e.getAttribute("data-view-id"))&&(a=i.hookups[r])&&(a(e,n,r),delete i.hookups[r],e.removeAttribute("data-view-id"))}),t},hookups:{},hook:function(e){return i.hookups[++r]=e," data-view-id='"+r+"'"},cached:{},cachedRenderers:{},cache:!0,register:function(e){this.types["."+e.suffix]=e},types:{},ext:".ejs",registerScript:function(){},preload:function(){},render:function(r,a,u,l){t(u)&&(l=u,u=void 0);var h=s(a);if(h.length){var d=new e.Deferred,p=e.extend({},a);return h.push(o(r,!0)),e.when.apply(e,h).then(function(t){var r,i=n(arguments),o=i.pop();if(e.isDeferred(a))p=c(t);else for(var s in a)e.isDeferred(a[s])&&(p[s]=c(i.shift()));r=o(p,u),d.resolve(r,p),l&&l(r,p)},function(){d.reject.apply(d,arguments)}),d}var f,g=t(l),d=o(r,g);if(g)f=d,d.then(function(e){l(a?e(a,u):e)});else{if("resolved"===d.state()&&d.__view_id){var m=i.cachedRenderers[d.__view_id];return a?m(a,u):m}d.then(function(e){f=a?e(a,u):e})}return f},registerView:function(t,n,r,a){var o=(r||i.types[i.ext]).renderer(t,n);return a=a||new e.Deferred,i.cache&&(i.cached[t]=a,a.__view_id=t,i.cachedRenderers[t]=o),a.resolve(o)}});var a=function(e,t){if(!e.length)throw"can.view: No template or empty template:"+t},o=function(t,n){var r,o,s,c=t.match(/\.[\w\d]+$/);if(t.match(/^#/)&&(t=t.substr(1)),(o=document.getElementById(t))&&(c="."+o.type.match(/\/(x\-)?(.+)/)[2]),c||i.cached[t]||(t+=c=i.ext),e.isArray(c)&&(c=c[0]),s=i.toId(t),t.match(/^\/\//)){var u=t.substr(2);t=window.steal?steal.config().root.mapJoin(u):u}if(r=i.types[c],i.cached[s])return i.cached[s];if(o)return i.registerView(s,o.innerHTML,r);var l=new e.Deferred;return e.ajax({async:n,url:t,dataType:"text",error:function(e){a("",t),l.reject(e)},success:function(e){a(e,t),i.registerView(s,e,r,l)}}),l},s=function(t){var n=[];if(e.isDeferred(t))return[t];for(var r in t)e.isDeferred(t[r])&&n.push(t[r]);return n},c=function(t){return e.isArray(t)&&"success"===t[1]?t[0]:t};return e.extend(i,{register:function(t){this.types["."+t.suffix]=t,i[t.suffix]=function(n,r){if(!r){var a=function(){return i.frag(a.render.apply(this,arguments))};return a.render=function(){var e=t.renderer(null,n);return e.apply(e,arguments)},a}return i.preload(n,t.renderer(n,r)),e.view(n)}},registerScript:function(e,t,n){return"can.view.preload('"+t+"',"+i.types["."+e].script(t,n)+");"},preload:function(t,n){function r(){return i.frag(n.apply(this,arguments))}return i.cached[t]=(new e.Deferred).resolve(function(e,t){return n.call(e,e,t)}),r.render=n,r}}),e}),define("can/observe/compute",["can/util/library"],function(e){var t=function(t,n){var r;e.Observe&&(r=e.Observe.__reading,e.Observe.__reading=function(e,t){i.push({obj:e,attr:t})});var i=[],a=t.call(n);return e.Observe&&(e.Observe.__reading=r),{value:a,observed:i}},n=function(n,r,i,a){var o,s={},c=!0,u={value:void 0,teardown:function(){for(var e in s){var t=s[e];t.observe.obj.unbind(t.observe.attr,l),delete s[e]}}},l=function(e){if(!(a&&!a.bound||void 0!==e.batchNum&&e.batchNum===o)){var t=u.value,n=h();u.value=n,n!==t&&i(n,t),o=o=e.batchNum}},h=function(){var i=t(n,r),a=i.observed,o=i.value;c=!c,e.each(a,function(e){s[e.obj._cid+"|"+e.attr]?s[e.obj._cid+"|"+e.attr].matched=c:(s[e.obj._cid+"|"+e.attr]={matched:c,observe:e},e.obj.bind(e.attr,l))});for(var u in s){var h=s[u];h.matched!==c&&(h.observe.obj.unbind(h.observe.attr,l),delete s[u])}return o};return u.value=h(),u.isListening=!e.isEmptyObject(s),u};return e.compute=function(t,r){if(t&&t.isComputed)return t;var i,a,o=0,s=!0;"function"==typeof t?a=function(n){return void 0===n?i?(o&&e.Observe.__reading&&e.Observe.__reading(a,"change"),i.value):t.call(r||this):t.apply(r||this,arguments)}:(a=function(n){if(void 0===n)return e.Observe.__reading&&e.Observe.__reading(a,"change"),t;var r=t;return t=n,r!==n&&e.Observe.triggerBatch(a,"change",[n,r]),n},s=!1),a.isComputed=!0,e.cid(a,"compute");var c={bound:!1};return a.bind=function(){e.addEvent.apply(a,arguments),0===o&&s&&(c.bound=!0,i=n(t,r||this,function(t,n){e.Observe.triggerBatch(a,"change",[t,n])},c)),o++},a.unbind=function(){e.removeEvent.apply(a,arguments),o--,0===o&&s&&(i.teardown(),c.bound=!1)},a},e.compute.binder=n,e.compute}),define("can/view/scanner",["can/view"],function(can){var newLine=/(\r|\n)+/g,tagToContentPropMap={option:"textContent",textarea:"value"},clean=function(e){return e.split("\\").join("\\\\").split("\n").join("\\n").split('"').join('\\"').split("	").join("\\t")},reverseTagMap={tr:"tbody",option:"select",td:"tr",th:"tr",li:"ul"},getTag=function(e,t,n){if(e)return e;for(;n<t.length;){if("<"==t[n]&&reverseTagMap[t[n+1]])return reverseTagMap[t[n+1]];n++}return""},bracketNum=function(e){return--e.split("{").length- --e.split("}").length},myEval=function(script){eval(script)},attrReg=/([^\s]+)[\s]*=[\s]*$/,startTxt="var ___v1ew = [];",finishTxt="return ___v1ew.join('')",put_cmd="___v1ew.push(",insert_cmd=put_cmd,htmlTag=null,quote=null,beforeQuote=null,rescan=null,status=function(){return quote?"'"+beforeQuote.match(attrReg)[1]+"'":htmlTag?1:0};return can.view.Scanner=Scanner=function(e){can.extend(this,{text:{},tokens:[]},e),this.tokenReg=[],this.tokenSimple={"<":"<",">":">",'"':'"',"'":"'"},this.tokenComplex=[],this.tokenMap={};for(var t,n=0;t=this.tokens[n];n++)t[2]?(this.tokenReg.push(t[2]),this.tokenComplex.push({abbr:t[1],re:new RegExp(t[2]),rescan:t[3]})):(this.tokenReg.push(t[1]),this.tokenSimple[t[1]]=t[0]),this.tokenMap[t[0]]=t[1];this.tokenReg=new RegExp("("+this.tokenReg.slice(0).concat(["<",">",'"',"'"]).join("|")+")","g")},Scanner.prototype={helpers:[{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(e){var t=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,n=e.match(t);return"function(__){var "+n[1]+"=can.$(__);"+n[2]+"}"}}],scan:function(e,t){var n=[],r=0,i=this.tokenSimple,a=this.tokenComplex;e=e.replace(newLine,"\n"),e.replace(this.tokenReg,function(t,o){var s=arguments[arguments.length-2];if(s>r&&n.push(e.substring(r,s)),i[t])n.push(t);else for(var c,u=0;c=a[u];u++)if(c.re.test(t)){n.push(c.abbr),c.rescan&&n.push(c.rescan(o));break}r=s+o.length}),r<e.length&&n.push(e.substr(r));var o,s,c,u="",l=[startTxt+(this.text.start||"")],h=function(e,t){l.push(put_cmd,'"',clean(e),'"'+(t||"")+");")},d=[],p=null,f=!1,g="",m=[],b=!1,v=0,y=this.tokenMap;for(htmlTag=quote=beforeQuote=null;void 0!==(c=n[v++]);){if(null===p)switch(c){case y.left:case y.escapeLeft:case y.returnLeft:f=htmlTag&&1;case y.commentLeft:p=c,u.length&&h(u),u="";break;case y.escapeFull:f=htmlTag&&1,rescan=1,p=y.escapeLeft,u.length&&h(u),rescan=n[v++],u=rescan.content||rescan,rescan.before&&h(rescan.before),n.splice(v,0,y.right);break;case y.commentFull:break;case y.templateLeft:u+=y.left;break;case"<":0!==n[v].indexOf("!--")&&(htmlTag=1,f=0),u+=c;break;case">":htmlTag=0;var _="/"==u.substr(u.length-1)||"--"==u.substr(u.length-2);f||!b&&tagToContentPropMap[m[m.length-1]]?(_?h(u.substr(0,u.length-1),',can.view.pending(),"/>"'):h(u,',can.view.pending(),">"'),u="",f=0):u+=c,(_||b)&&(m.pop(),g=m[m.length-1],b=!1);break;case"'":case'"':htmlTag&&(quote&&quote===c?quote=null:null===quote&&(quote=c,beforeQuote=o));default:"<"===o&&(g=c.split(/\s/)[0],0===g.indexOf("/")&&m[m.length-1]===g.substr(1)?(g=m[m.length-1],b=!0):m.push(g)),u+=c}else switch(c){case y.right:case y.returnRight:switch(p){case y.left:s=bracketNum(u),1==s?(l.push(insert_cmd,"can.view.txt(0,'"+getTag(g,n,v)+"',"+status()+",this,function(){",startTxt,u),d.push({before:"",after:finishTxt+"}));\n"})):(r=d.length&&-1==s?d.pop():{after:";"},r.before&&l.push(r.before),l.push(u,";",r.after));break;case y.escapeLeft:case y.returnLeft:s=bracketNum(u),s&&d.push({before:finishTxt,after:"}));"});for(var x=p===y.escapeLeft?1:0,w={insert:insert_cmd,tagName:getTag(g,n,v),status:status()},E=0;E<this.helpers.length;E++){var C=this.helpers[E];if(C.name.test(u)){u=C.fn(u,w),C.name.source==/^>[\s]*\w*/.source&&(x=0);break}}"object"==typeof u?u.raw&&l.push(u.raw):l.push(insert_cmd,"can.view.txt("+x+",'"+g+"',"+status()+",this,function(){ "+(this.text.escape||"")+"return ",u,s?startTxt:"}));"),rescan&&rescan.after&&rescan.after.length&&(h(rescan.after.length),rescan=null)}p=null,u="";break;case y.templateLeft:u+=y.left;break;default:u+=c}o=c}u.length&&h(u),l.push(";");var k=l.join(""),S={out:"with(_VIEW) { with (_CONTEXT) {"+k+" "+finishTxt+"}}"};return myEval.call(S,"this.fn = (function(_CONTEXT,_VIEW){"+S.out+"});\r\n//@ sourceURL="+t+".js"),S}},Scanner}),define("can/view/render",["can/view","can/util/string"],function(e){var t=!0;try{document.createTextNode("")._=0}catch(n){t=!1}var r={"class":"className",value:"value",innerText:"innerText",textContent:"textContent"},i={"":"span",table:"tbody",tr:"td",ol:"li",ul:"li",tbody:"tr",thead:"tr",tfoot:"tr",select:"option",optgroup:"option"},a="__!!__",o=/__!!__/g,s={option:"textContent"in document.createElement("option")?"textContent":"innerText",textarea:"value"},c=e.each(["checked","disabled","readonly","required"],function(e){r[e]=e}),u=function(e,t){return t&&11===e.parentNode.nodeType?t:e.parentNode},l=function(t,n,i){var a=t.nodeName.toString().toLowerCase(),o=r[n];o?(t[o]=e.inArray(n,c)>-1?!0:i,"value"!==o||"input"!==a&&"textarea"!==a||(t.defaultValue=i)):t.setAttribute(n,i)},h=function(e,t){return(r[t]&&e[r[t]]?e[r[t]]:e.getAttribute(t))||""},d=function(t,n){e.inArray(n,c)>-1?t[n]=!1:t.removeAttribute(n)},p=[],f=function(e){if("string"==typeof e)return e;if(!e&&0!==e)return"";var t=e.hookup&&function(t,n){e.hookup.call(e,t,n)}||"function"==typeof e&&e;return t?(p.push(t),""):""+e},g=function(t){return"string"==typeof t||"number"==typeof t?e.esc(t):f(t)},m={},b={},v={},y="ejs_"+Math.random(),_=0,x=function(e){if(t||3!==e.nodeType)return e[y]?e[y]:e[y]=(e.nodeName?"element_":"obj_")+ ++_;for(var n in b)if(b[n]===e)return n;return b["text_"+ ++_]=e,"text_"+_},w=function(t,n){var r=m[x(t)];if(r){var i=e.inArray(n,r);i>=0&&r.splice(i,1),r.length||delete m[x(t)]}},E=function(e,t){var n=m[x(e)];n||(n=m[x(e)]=[]),n.push(t)},C=function(e){var t=i[e]||"span";return"span"===t?"@@!!@@":"<"+t+">"+C(t)+"</"+t+">"};return e.extend(e.view,{pending:function(){var t=p.slice(0);return lastHookups=t,p=[],e.view.hook(function(n){e.each(t,function(e){e(n)})})},registerNode:function(t){var n=x(t);v[n]=t,e.each(t,function(e){E(e,n)})},unregisterNode:function(t){var n=x(t);e.each(t,function(e){w(e,n)}),delete v[n]},txt:function(t,n,r,c,m){var b=e.compute.binder(m,c,function(e,t){_(e,t)});if(!b.isListening)return(t||0!==r?g:f)(b.value);var v,y,_,x=function(){b.teardown(),y&&e.view.unregisterNode(y)},w=function(t){e.bind.call(t,"destroyed",x),v=t},E=function(t){t||(x(),e.unbind.call(v,"destroyed",x))},k=i[n]||"span",S=s[n];if(0!==r||S){if(1===r){var O=b.value.replace(/['"]/g,"").split("=")[0];
return p.push(function(e){_=function(t){var n=(t||"").replace(/['"]/g,"").split("="),r=n[0];r!=O&&O&&d(e,O),r&&(l(e,r,n[1]),O=r)},w(e)}),b.value}var A=0===r?S:r;return(0===r?lastHookups:p).push(function(t){_=function(){l(t,A,i.render(),S)};var n,r=e.$(t);n=e.data(r,"hooks"),n||e.data(r,"hooks",n={});var i,s=h(t,A,S),c=s.split(a),u=[];u.push(c.shift(),c.join(a)),n[A]?n[A].bindings.push(b):n[A]={render:function(){var e=0,t=s.replace(o,function(){return f(i.bindings[e++].value)});return t},bindings:[b],batchNum:void 0},i=n[A],u.splice(1,0,b.value),l(t,A,u.join(""),S),w(t)}),a}return"<"+k+e.view.hook(t?function(e,t){_=function(e){r.nodeValue=""+e,E(r.parentNode)};var n=u(e,t),r=document.createTextNode(b.value);e.parentNode!==n?(n=e.parentNode,n.insertBefore(r,e),n.removeChild(e)):(n.insertBefore(r,e),n.removeChild(e)),w(n)}:function(t,n){_=function(e){var t=r[0].parentNode;t&&i(e),E(r[0].parentNode)},n=u(t,n);var r,i=function(i){var a=e.view.frag(i,n),o=e.makeArray(a.childNodes),s=r?r[r.length-1]:t;if(s.nextSibling?s.parentNode.insertBefore(a,s.nextSibling):s.parentNode.appendChild(a),r){var c=e.makeArray(r);e.view.replace(r,o),e.remove(e.$(c))}else e.remove(e.$(t)),r=o,y=r,e.view.registerNode(r)};i(b.value,[t]),w(n)})+">"+C(k)+"</"+k+">"},replace:function(t,n){t=e.makeArray(t),e.each(t,function(r){e.each(e.makeArray(m[x(r)]),function(i){var a=v[i],o=e.inArray(r,a),s=e.inArray(t[t.length-1],a);if(o>=0&&s>=0){for(var c=o;s>=c;c++){var u=a[c];w(u,i)}a.splice.apply(a,[o,s-o+1].concat(n)),e.each(n,function(e){E(e,i)})}else e.view.unregisterNode(a)})})},canExpando:t,textNodeMap:b,nodeMap:m,nodeListMap:v}),e}),define("can/view/ejs",["can/util/library","can/view","can/util/string","can/observe/compute","can/view/scanner","can/view/render"],function(e){var t=e.extend,n=function(e){if(this.constructor!=n){var r=new n(e);return function(e,t){return r.render(e,t)}}return"function"==typeof e?void(this.template={fn:e}):(t(this,e),void(this.template=this.scanner.scan(this.text,this.name)))};return e.EJS=n,n.prototype.render=function(e,t){return e=e||{},this.template.fn.call(e,e,new n.Helpers(e,t||{}))},t(n.prototype,{scanner:new e.view.Scanner({tokens:[["templateLeft","<%%"],["templateRight","%>"],["returnLeft","<%=="],["escapeLeft","<%="],["commentLeft","<%#"],["left","<%"],["right","%>"],["returnRight","%>"]]})}),n.Helpers=function(e,n){this._data=e,this._extras=n,t(this,n)},n.Helpers.prototype={list:function(t,n){e.each(t,function(e,r){n(e,r,t)})}},e.view.register({suffix:"ejs",script:function(e,t){return"can.EJS(function(_CONTEXT,_VIEW) { "+new n({text:t,name:e}).template.out+" })"},renderer:function(e,t){return n({text:t,name:e})}}),e}),define("can/route",[],function(){}),define("can",["can/util/library","can/control/route","can/model","can/view/ejs","can/route"],function(e){return e}),function(e){function t(){}function n(e){o=[e]}function r(e,t,n){return e&&e.apply(t.context||t,n)}function i(e){return/\?/.test(e)?"&":"?"}function a(a){function p(e){Y++||(J(),V&&(S[G]={s:[e]}),H&&(e=H.apply(a,[e])),r(M,a,[e,x,a]),r(B,a,[a,x]))}function P(e){Y++||(J(),V&&e!=w&&(S[G]=e),r(U,a,[a,e]),r(B,a,[a,e]))}a=e.extend({},A,a);var L,R,N,T,D,M=a.success,U=a.error,B=a.complete,H=a.dataFilter,F=a.callbackParameter,q=a.callback,$=a.cache,V=a.pageCache,W=a.charset,G=a.url,K=a.data,z=a.timeout,Y=0,J=t;return C&&C(function(e){e.done(M).fail(U),M=e.resolve,U=e.reject}).promise(a),a.abort=function(){!Y++&&J()},r(a.beforeSend,a,[a])===!1||Y?a:(G=G||u,K=K?"string"==typeof K?K:e.param(K,a.traditional):u,G+=K?i(G)+K:u,F&&(G+=i(G)+encodeURIComponent(F)+"=?"),!$&&!V&&(G+=i(G)+"_"+(new Date).getTime()+"="),G=G.replace(/=\?(&|$)/,"="+q+"$1"),V&&(L=S[G])?L.s?p(L.s[0]):P(L):(E[q]=n,N=e(_)[0],N.id=d+O++,W&&(N[c]=W),I&&I.version()<11.6?(T=e(_)[0]).text="document.getElementById('"+N.id+"')."+g+"()":N[s]=s,j&&(N.htmlFor=N.id,N.event=f),N[m]=N[g]=N[b]=function(e){if(!N[v]||!/i/.test(N[v])){try{N[f]&&N[f]()}catch(t){}e=o,o=0,e?p(e[0]):P(l)}},N.src=G,J=function(){D&&clearTimeout(D),N[b]=N[m]=N[g]=null,k[y](N),T&&k[y](T)},k[h](N,R=k.firstChild),T&&k[h](T,R),D=z>0&&setTimeout(function(){P(w)},z)),a)}var o,s="async",c="charset",u="",l="error",h="insertBefore",d="_jqjsp",p="on",f=p+"click",g=p+l,m=p+"load",b=p+"readystatechange",v="readyState",y="removeChild",_="<script>",x="success",w="timeout",E=window,C=e.Deferred,k=e("head")[0]||document.documentElement,S={},O=0,A={callback:d,url:location.href},I=E.opera,j=!!e("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;a.setup=function(t){e.extend(A,t)},e.jsonp=a}(jQuery),define("lib/jquery-jsonp/src/jquery.jsonp",function(){}),define("scripts/components/price-generator/models/product-offers-model",["jquery","can","lib/jquery-jsonp/src/jquery.jsonp"],function(e,t){var n=t.Model({marketSegment:"COM",countryCode:"US",landscape:"prod",timeout:2e4,rootNode:"productOffering",requestCount:0,findAll:function(t){var n,r=t.countryCode||this.countryCode,i=t.landscape||this.landsscape;if(!t)throw new Error("Params not defined");if(!t.productKeys)throw new Error("ProductKeys not defined in params!");if(!e.isArray(t.productKeys))throw new Error("ProductKeys not an Array!");return n=this.getCountryQueryString(this.getUpperCaseValue(r)),n+="&"+this.getMarketSegmentQueryString(t.marketSegment),n+="&"+this.getProductKeyQueryString(t.productKeys),t.promoCodes&&e.isArray(t.promoCodes)&&t.promoCodes.length&&(n+="&"+this.getPromoCodesQueryString(t.promoCodes)),t.languageCode&&(n+="&language="+t.languageCode),e.jsonp({type:"GET",url:this.getUrl(r,i)+"?callback=?",callback:this.getCallbackName(),data:n,dataType:"jsonp",timeout:this.timeout})},getUpperCaseValue:function(t){return e.isValue(t)?t.toUpperCase():void 0},getUrl:function(e,t){var n="/svcs/offers/products.json",r=this.isNorthAmerica(e)?"//store1.":"//store2.";switch(t){case"stage":r+="stage.";break;case"pre-stage":r+="qa04.";break;case"dev":r+="dev04."}return r+="adobe.com"+n},getCallbackName:function(){return"productOffers"+this.requestCount++},isNorthAmerica:function(e){return"US"===e||"CA"===e||"MX"===e},getProductKeyQueryString:function(e){return"product_key="+e.join("&product_key=")},getCountryQueryString:function(e){return"countryCode="+(e?e:this.countryCode)},getMarketSegmentQueryString:function(e){return"marketSegment="+(e?e:this.marketSegment)},getPromoCodesQueryString:function(e){return"promotion_code="+e.join(",")},models:function(e){return this.model(e[this.rootNode])}},{});return n}),define("scripts/components/common/util/number-util",[],function(){return{formatByMask:function(e,t){if(!e||isNaN(+t))return t;t="-"===e.charAt(0)?-t:+t;var n=0>t?t=-t:0,r=e.match(/[^\d\-\+#]/g),i=r&&r[r.length-1]||".",a=r&&r[1]&&r[0]||",";e=e.split(i),t=t.toFixed(e[1]&&e[1].length),t=+t+"";var o=e[1]&&e[1].lastIndexOf("0"),s=t.split(".");(!s[1]||s[1]&&s[1].length<=o)&&(t=(+t).toFixed(o+1));var c=e[0].split(a);e[0]=c.join("");var u=e[0]&&e[0].indexOf("0");if(u>-1)for(;s[0].length<e[0].length-u;)s[0]="0"+s[0];else 0===+s[0]&&(s[0]="");t=t.split("."),t[0]=s[0];var l=c[1]&&c[c.length-1].length;if(l){for(var h=t[0],d="",p=h.length%l,f=0,g=h.length;g>f;f++)d+=h.charAt(f),(f-p+1)%l===0&&g-l>f&&(d+=a);t[0]=d}return t[1]=e[1]&&t[1]?i+t[1]:"",(n?"-":"")+t[0]+t[1]}}}),define("can-proxy",["can/util/library","can/construct"],function(e){var t=(e.isFunction,e.isArray),n=e.makeArray,r=function(e){var r,i=n(arguments);return e=i.shift(),t(e)||(e=[e]),r=this,function(){for(var a,o,s=i.concat(n(arguments)),c=e.length,u=0;c>u;u++)o=e[u],o&&(a="string"==typeof o,s=(a?r[o]:o).apply(r,s||[]),c-1>u&&(s=!t(s)||s._use_call?[s]:s));return s}};e.Construct.proxy=e.Construct.prototype.proxy=r;for(var i=[e.Observe,e.Control,e.Model],a=0;a<i.length;a++)i[a]&&(i[a].proxy=r);return e}),define("price-generator",["jquery","can","scripts/components/price-generator/models/product-offers-model","scripts/components/common/util/number-util","can-proxy"],function(e,t,n,r){var i=t.Construct({defaults:{landscape:"prod",countryCode:"US",marketSegment:"COM",promoCodes:[]}},{init:function(t){this.options=e.extend({},this.constructor.defaults,t)},getPrices:function(t){var r=e.extend({},this.options,t),i=new e.Deferred;return n.findAll(r).done(this.proxy("productPriceSuccess",i)).fail(this.proxy("productPriceFailed",i)),i.promise()},productPriceSuccess:function(t,n){var r=this.getPriceObjects(n);e.isEmptyObject(r)?t.reject({errorType:"NO_PRICE_DATA_FOUND"}):t.resolve(r)},productPriceFailed:function(e){e.reject({errorType:"INVALID_PRICE_REQUEST"})},getPriceObjects:function(t){var n=t.attr("currency"),r=t.attr("productOffers"),i={},a=this;try{e.each(r,function(e,t){i[t.attr("productKey")]=a.getProductPrices(n,t)})}catch(o){}return i},getProductPrices:function(t,n){var r=this,i={};return e.each(n.attr("priceMap"),function(e,n){i[n.attr("priceTypeKey")]=r.getPriceParts(t,n.attr("price"))}),i},getPriceParts:function(t,n){var r=n.display_price,i=t.formatString,a={price:r,formattedPrice:this.getFormattedPrice(t,r),symbol:e.trim(t.symbol),decimalDelim:this.getDecimalDelim(t),thousandDelim:i.match(/#.(?=#)/)[0].replace(/#/,""),includesTax:n.attr("includes_tax")};return a},getFormattedPrice:function(t,n){var i=e.trim(t.symbol),a=t.formatString,o=this.getNumberMask(t),s=r.formatByMask(o,n);return a.replace(/'.*'/,i).replace(/#.*0/,s)},getNumberMask:function(t){var n=t.formatString,r=e.trim(n.replace(/'.*'/,"")),i=t.usePrecision;return i?r:r+"."},getDecimalDelim:function(e){var t=e.formatString,n=t.match(/0.(?=0)/);return n?n[0].replace(/0/,""):""}});return i}),define("OpenAjax/hub/hub",[],function(){var e=window.OpenAjax||{};return e.hub||(window.OpenAjax=e,e.hub=function(){var e={},t="org.openajax.hub.";return{implementer:"http://openajax.org",implVersion:"2.0.7",specVersion:"2.0",implExtraData:{},libraries:e,registerLibrary:function(n,r,i,a){e[n]={prefix:n,namespaceURI:r,version:i,extraData:a},this.publish(t+"registerLibrary",e[n])},unregisterLibrary:function(n){this.publish(t+"unregisterLibrary",e[n]),delete e[n]}}}(),e.hub.Error={BadParameters:"OpenAjax.hub.Error.BadParameters",Disconnected:"OpenAjax.hub.Error.Disconnected",Duplicate:"OpenAjax.hub.Error.Duplicate",NoContainer:"OpenAjax.hub.Error.NoContainer",NoSubscription:"OpenAjax.hub.Error.NoSubscription",NotAllowed:"OpenAjax.hub.Error.NotAllowed",WrongProtocol:"OpenAjax.hub.Error.WrongProtocol",IncompatBrowser:"OpenAjax.hub.Error.IncompatBrowser"},e.hub.SecurityAlert={LoadTimeout:"OpenAjax.hub.SecurityAlert.LoadTimeout",FramePhish:"OpenAjax.hub.SecurityAlert.FramePhish",ForgedMsg:"OpenAjax.hub.SecurityAlert.ForgedMsg"},e.hub._debugger=function(){e.hub.enableDebug},e.hub.ManagedHub=function(t){if(!t||!t.onPublish||!t.onSubscribe)throw new Error(e.hub.Error.BadParameters);if(this._p=t,this._onUnsubscribe=t.onUnsubscribe?t.onUnsubscribe:null,this._scope=t.scope||window,t.log){var n=this;this._log=function(r){try{t.log.call(n._scope,"ManagedHub: "+r)}catch(i){e.hub._debugger()}}}else this._log=function(){};this._subscriptions={c:{},s:null},this._containers={},this._seq=0,this._active=!0,this._isPublishing=!1,this._pubQ=[]},e.hub.ManagedHub.prototype.subscribeForClient=function(t,n,r){if(this._assertConn(),this._invokeOnSubscribe(n,t))return this._subscribe(n,this._sendToClient,this,{c:t,sid:r});throw new Error(e.hub.Error.NotAllowed)},e.hub.ManagedHub.prototype.unsubscribeForClient=function(e,t){this._unsubscribe(t),this._invokeOnUnsubscribe(e,t)},e.hub.ManagedHub.prototype.publishForClient=function(e,t,n){this._assertConn(),this._publish(t,n,e)},e.hub.ManagedHub.prototype.disconnect=function(){this._active=!1;for(var e in this._containers)this.removeContainer(this._containers[e])},e.hub.ManagedHub.prototype.getContainer=function(e){var t=this._containers[e];return t?t:null},e.hub.ManagedHub.prototype.listContainers=function(){var e=[];for(var t in this._containers)e.push(this._containers[t]);return e},e.hub.ManagedHub.prototype.addContainer=function(t){this._assertConn();var n=t.getClientID();if(this._containers[n])throw new Error(e.hub.Error.Duplicate);this._containers[n]=t},e.hub.ManagedHub.prototype.removeContainer=function(t){var n=t.getClientID();if(!this._containers[n])throw new Error(e.hub.Error.NoContainer);t.remove(),delete this._containers[n]},e.hub.ManagedHub.prototype.subscribe=function(t,n,r,i,a){function o(t,i,o,c){if(s._invokeOnPublish(t,i,c,null))try{n.call(r,t,i,a)}catch(u){e.hub._debugger(),s._log("caught error from onData callback to Hub.subscribe(): "+u.message)}}if(this._assertConn(),this._assertSubTopic(t),!n)throw new Error(e.hub.Error.BadParameters);if(r=r||window,!this._invokeOnSubscribe(t,null))return void this._invokeOnComplete(i,r,null,!1,e.hub.Error.NotAllowed);var s=this,c=this._subscribe(t,o,r,a);return this._invokeOnComplete(i,r,c,!0),c},e.hub.ManagedHub.prototype.publish=function(e,t){this._assertConn(),this._assertPubTopic(e),this._publish(e,t,null)},e.hub.ManagedHub.prototype.unsubscribe=function(t,n,r){if(this._assertConn(),!t)throw new Error(e.hub.Error.BadParameters);this._unsubscribe(t),this._invokeOnUnsubscribe(null,t),this._invokeOnComplete(n,r,t,!0)},e.hub.ManagedHub.prototype.isConnected=function(){return this._active},e.hub.ManagedHub.prototype.getScope=function(){return this._scope},e.hub.ManagedHub.prototype.getSubscriberData=function(t){this._assertConn();var n=t.split("."),r=n.pop(),i=this._getSubscriptionObject(this._subscriptions,n,0,r);if(i)return i.data;throw new Error(e.hub.Error.NoSubscription)},e.hub.ManagedHub.prototype.getSubscriberScope=function(t){this._assertConn();var n=t.split("."),r=n.pop(),i=this._getSubscriptionObject(this._subscriptions,n,0,r);if(i)return i.scope;throw new Error(e.hub.Error.NoSubscription)},e.hub.ManagedHub.prototype.getParameters=function(){return this._p},e.hub.ManagedHub.prototype._sendToClient=function(e,t,n,r){this.isConnected()&&this._invokeOnPublish(e,t,r,n.c)&&n.c.sendToClient(e,t,n.sid)},e.hub.ManagedHub.prototype._assertConn=function(){if(!this.isConnected())throw new Error(e.hub.Error.Disconnected)},e.hub.ManagedHub.prototype._assertPubTopic=function(t){if(!t||""===t||-1!=t.indexOf("*")||-1!=t.indexOf("..")||"."==t.charAt(0)||"."==t.charAt(t.length-1))throw new Error(e.hub.Error.BadParameters)},e.hub.ManagedHub.prototype._assertSubTopic=function(t){if(!t)throw new Error(e.hub.Error.BadParameters);for(var n=t.split("."),r=n.length,i=0;r>i;i++){var a=n[i];if(""===a||-1!=a.indexOf("*")&&"*"!=a&&"**"!=a)throw new Error(e.hub.Error.BadParameters);if("**"==a&&r-1>i)throw new Error(e.hub.Error.BadParameters)}},e.hub.ManagedHub.prototype._invokeOnComplete=function(t,n,r,i,a){if(t)try{n=n||window,t.call(n,r,i,a)}catch(o){e.hub._debugger(),this._log("caught error from onComplete callback: "+o.message)}},e.hub.ManagedHub.prototype._invokeOnPublish=function(t,n,r,i){try{return this._p.onPublish.call(this._scope,t,n,r,i)}catch(a){e.hub._debugger(),this._log("caught error from onPublish callback to constructor: "+a.message)}return!1},e.hub.ManagedHub.prototype._invokeOnSubscribe=function(t,n){try{return this._p.onSubscribe.call(this._scope,t,n)}catch(r){e.hub._debugger(),this._log("caught error from onSubscribe callback to constructor: "+r.message)}return!1},e.hub.ManagedHub.prototype._invokeOnUnsubscribe=function(t,n){if(this._onUnsubscribe){var r=n.slice(0,n.lastIndexOf("."));try{this._onUnsubscribe.call(this._scope,r,t)}catch(i){e.hub._debugger(),this._log("caught error from onUnsubscribe callback to constructor: "+i.message)}}},e.hub.ManagedHub.prototype._subscribe=function(e,t,n,r){var i=e+"."+this._seq,a={scope:n,cb:t,data:r,sid:this._seq++},o=e.split(".");return this._recursiveSubscribe(this._subscriptions,o,0,a),i},e.hub.ManagedHub.prototype._recursiveSubscribe=function(e,t,n,r){var i=t[n];n==t.length?(r.next=e.s,e.s=r):("undefined"==typeof e.c&&(e.c={}),"undefined"==typeof e.c[i]?(e.c[i]={c:{},s:null},this._recursiveSubscribe(e.c[i],t,n+1,r)):this._recursiveSubscribe(e.c[i],t,n+1,r))},e.hub.ManagedHub.prototype._publish=function(e,t,n){if(this._isPublishing)return void this._pubQ.push({t:e,d:t,p:n});for(this._safePublish(e,t,n);this._pubQ.length>0;){var r=this._pubQ.shift();this._safePublish(r.t,r.d,r.p)}},e.hub.ManagedHub.prototype._safePublish=function(e,t,n){this._isPublishing=!0;var r=e.split(".");this._recursivePublish(this._subscriptions,r,0,e,t,n),this._isPublishing=!1},e.hub.ManagedHub.prototype._recursivePublish=function(e,t,n,r,i,a){if("undefined"!=typeof e){var o;if(n==t.length?o=e:(this._recursivePublish(e.c[t[n]],t,n+1,r,i,a),this._recursivePublish(e.c["*"],t,n+1,r,i,a),o=e.c["**"]),"undefined"!=typeof o)for(var s=o.s;s;){var c=s.scope,u=s.cb,l=s.data;"string"==typeof u&&(u=c[u]),u.call(c,r,i,l,a),s=s.next}}},e.hub.ManagedHub.prototype._unsubscribe=function(t){var n=t.split("."),r=n.pop();if(!this._recursiveUnsubscribe(this._subscriptions,n,0,r))throw new Error(e.hub.Error.NoSubscription)},e.hub.ManagedHub.prototype._recursiveUnsubscribe=function(e,t,n,r){if("undefined"==typeof e)return!1;if(n<t.length){var i=e.c[t[n]];if(!i)return!1;if(this._recursiveUnsubscribe(i,t,n+1,r),!i.s){for(var a in i.c)return!0;delete e.c[t[n]]}}else{for(var o=e.s,s=null,c=!1;o;){if(r==o.sid){c=!0,o==e.s?e.s=o.next:s.next=o.next;break}s=o,o=o.next}if(!c)return!1}return!0},e.hub.ManagedHub.prototype._getSubscriptionObject=function(e,t,n,r){if("undefined"!=typeof e){if(n<t.length){var i=e.c[t[n]];return this._getSubscriptionObject(i,t,n+1,r)}for(var a=e.s;a;){if(r==a.sid)return a;a=a.next}}return null},e.hub._hub=new e.hub.ManagedHub({onSubscribe:function(){return!0},onPublish:function(){return!0}}),e.hub.subscribe=function(t,n,r,i){return"string"==typeof n&&(r=r||window,n=r[n]||null),e.hub._hub.subscribe(t,n,r,null,i)},e.hub.unsubscribe=function(t){return e.hub._hub.unsubscribe(t)},e.hub.publish=function(t,n){e.hub._hub.publish(t,n)},e.hub.registerLibrary("OpenAjax","http://openajax.org/hub","2.0",{})),e}),define("OpenAjax/containers/inline/inline",["OpenAjax/hub/hub"],function(e){return e.hub.InlineContainer=function(t,n,r){function i(t,n,r,i,a){if(t)try{n=n||window,t.call(n,r,i,a)}catch(o){e.hub._debugger(),f._log("caught error from onComplete callback: "+o.message)}}function a(){for(var e in d)t.unsubscribeForClient(this,d[e].h);d=[],p=0,h=!1}function o(){if(!h)throw new Error(e.hub.Error.Disconnected)}function s(t){if(null==t||""===t||-1!=t.indexOf("*")||-1!=t.indexOf("..")||"."==t.charAt(0)||"."==t.charAt(t.length-1))throw new Error(e.hub.Error.BadParameters)}function c(t){if(!t)throw new Error(e.hub.Error.BadParameters);for(var n=t.split("."),r=n.length,i=0;r>i;i++){var a=n[i];if(""===a||-1!=a.indexOf("*")&&"*"!=a&&"**"!=a)throw new Error(e.hub.Error.BadParameters);if("**"==a&&r-1>i)throw new Error(e.hub.Error.BadParameters)}}function u(t){var n=d[t];if(n)return n;throw new Error(e.hub.Error.NoSubscription)}if(!(t&&n&&r&&r.Container&&r.Container.onSecurityAlert))throw new Error(e.hub.Error.BadParameters);var l=r.Container.scope||window,h=!1,d=[],p=0,f=null;if(r.Container.log)var g=function(t){try{r.Container.log.call(l,"InlineContainer::"+n+": "+t)}catch(i){e.hub._debugger()}};else g=function(){};this._init=function(){t.addContainer(this)},this.getHub=function(){return t},this.sendToClient=function(t,n,r){if(h){var i=d[r];try{i.cb.call(i.sc,t,n,i.d)}catch(a){e.hub._debugger(),f._log("caught error from onData callback to HubClient.subscribe(): "+a.message)}}},this.remove=function(){h&&a()},this.isConnected=function(){return h},this.getClientID=function(){return n},this.getPartnerOrigin=function(){return h?window.location.protocol+"//"+window.location.hostname:null},this.getParameters=function(){return r},this.connect=function(t,n,a){if(h)throw new Error(e.hub.Error.Duplicate);if(h=!0,f=t,r.Container.onConnect)try{r.Container.onConnect.call(l,this)}catch(o){e.hub._debugger(),g("caught error from onConnect callback to constructor: "+o.message)}i(n,a,t,!0)},this.disconnect=function(t,n,o){if(!h)throw new Error(e.hub.Error.Disconnected);if(a(),r.Container.onDisconnect)try{r.Container.onDisconnect.call(l,this)}catch(s){e.hub._debugger(),g("caught error from onDisconnect callback to constructor: "+s.message)}i(n,o,t,!0)},this.subscribe=function(n,r,a,s,u){if(o(),c(n),!r)throw new Error(e.hub.Error.BadParameters);var l=""+p++,h=!1,f=null;try{var g=t.subscribeForClient(this,n,l);h=!0}catch(m){l=null,f=m.message}return a=a||window,h&&(d[l]={h:g,cb:r,sc:a,d:u}),i(s,a,l,h,f),l},this.publish=function(e,n){o(),s(e),t.publishForClient(this,e,n)},this.unsubscribe=function(n,r,a){if(o(),"undefined"==typeof n||null===n)throw new Error(e.hub.Error.BadParameters);var s=d[n];if(!s)throw new Error(e.hub.Error.NoSubscription);t.unsubscribeForClient(this,s.h),delete d[n],i(r,a,n,!0)},this.getSubscriberData=function(e){return o(),u(e).d},this.getSubscriberScope=function(e){return o(),u(e).sc},this._init()},e.hub.InlineHubClient=function(t){if(!(t&&t.HubClient&&t.HubClient.onSecurityAlert&&t.InlineHubClient&&t.InlineHubClient.container))throw new Error(e.hub.Error.BadParameters);var n=t.InlineHubClient.container,r=t.HubClient.scope||window;if(t.HubClient.log)var i=function(i){try{t.HubClient.log.call(r,"InlineHubClient::"+n.getClientID()+": "+i)}catch(a){e.hub._debugger()}};else i=function(){};this._log=i,this.connect=function(e,t){n.connect(this,e,t)},this.disconnect=function(e,t){n.disconnect(this,e,t)},this.getPartnerOrigin=function(){return n.getPartnerOrigin()},this.getClientID=function(){return n.getClientID()},this.subscribe=function(e,t,r,i,a){return n.subscribe(e,t,r,i,a)},this.publish=function(e,t){n.publish(e,t)},this.unsubscribe=function(e,t,r){n.unsubscribe(e,t,r)},this.isConnected=function(){return n.isConnected()},this.getScope=function(){return r},this.getSubscriberData=function(e){return n.getSubscriberData(e)},this.getSubscriberScope=function(e){return n.getSubscriberScope(e)},this.getParameters=function(){return t}},e}),define("OpenAjax/containers/iframe/iframe",["OpenAjax/hub/hub"],function(OpenAjax){var OpenAjax=OpenAjax||{};return OpenAjax.hub=OpenAjax.hub||{},OpenAjax.gadgets="object"==typeof OpenAjax.gadgets?OpenAjax.gadgets:"object"==typeof gadgets?gadgets:{},OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},function(){if("undefined"==typeof gadgets){if("undefined"==typeof oaaConfig)for(var scripts=document.getElementsByTagName("script"),reHub=/openajax(?:managedhub-(?:all|core).*|-mashup)\.js$/i,i=scripts.length-1;i>=0;i--){var src=scripts[i].getAttribute("src");if(src){var m=src.match(reHub);if(m){var config=scripts[i].getAttribute("oaaConfig");if(config)try{oaaConfig=eval("({ "+config+" })")}catch(e){}break}}}"undefined"!=typeof oaaConfig&&oaaConfig.gadgetsGlobal&&(gadgets=OpenAjax.gadgets)}}(),OpenAjax.hub.IframeContainer||!function(){function e(e,t,n){if(!OpenAjax.hub.IframeContainer._prng){var r=(new Date).getTime()+Math.random()+document.cookie;OpenAjax.hub.IframeContainer._prng=OpenAjax._smash.crypto.newPRNG(r)}var i=e.IframeContainer||e.IframeHubClient;if(i&&i.seed)try{var a=i.seed.call(t);OpenAjax.hub.IframeContainer._prng.addSeed(a)}catch(o){OpenAjax.hub._debugger(),n("caught error from 'seed' callback: "+o.message)}var s=i&&i.tokenLength||6;return OpenAjax.hub.IframeContainer._prng.nextRandomB64Str(s)}OpenAjax.hub.IframeContainer=function(n,r,i){function a(e){var t=e[0],n=e[1],r=e[2];if(!(t&&n&&r&&r.Container&&r.Container.onSecurityAlert&&r.IframeContainer&&r.IframeContainer.parent&&r.IframeContainer.uri))throw new Error(OpenAjax.hub.Error.BadParameters)}function o(){var e=document.createElement("span");i.IframeContainer.parent.appendChild(e);var t='<iframe id="'+d+'" name="'+d+'" src="javascript:\'<html></html>\'"',n="",a=i.IframeContainer.iframeAttrs;if(a)for(var o in a)switch(o){case"style":for(var s in a.style)n+=s+":"+a.style[s]+";";break;case"className":t+=' class="'+a[o]+'"';break;default:t+=" "+o+'="'+a[o]+'"'}n+="visibility:hidden;",t+=' style="'+n+'"></iframe>',e.innerHTML=t;var c;c=i.IframeContainer.tunnelURI?"&parent="+encodeURIComponent(i.IframeContainer.tunnelURI)+"&forcesecure=true":"&oahParent="+encodeURIComponent(OpenAjax.gadgets.rpc.getOrigin(window.location.href));var u="";d!==r&&(u="&oahId="+d.substring(d.lastIndexOf("_")+1)),document.getElementById(d).src=i.IframeContainer.uri+"#rpctoken="+h+c+u}function s(){function e(e){if(e&&(m=!0,clearTimeout(p),document.getElementById(d).style.visibility="visible",i.Container.onConnect))try{i.Container.onConnect.call(g,f)}catch(t){OpenAjax.hub._debugger(),y("caught error from onConnect callback to constructor: "+t.message)}}OpenAjax.gadgets.rpc.call(d,"openajax.pubsub",e,"cmd","con")}function c(){if(m){m=!1,document.getElementById(d).style.visibility="hidden";for(var e in b)n.unsubscribeForClient(f,b[e]);b={}}}function u(e){try{i.Container.onSecurityAlert.call(g,f,e)}catch(t){OpenAjax.hub._debugger(),y("caught error from onSecurityAlert callback to constructor: "+t.message)}}function l(){p=setTimeout(function(){u(OpenAjax.hub.SecurityAlert.LoadTimeout),f._handleIncomingRPC=function(){}},v)}a(arguments);var h,d,p,f=this,g=i.Container.scope||window,m=!1,b={},v=i.IframeContainer.timeout||15e3;if(i.Container.log)var y=function(e){try{i.Container.log.call(g,"IframeContainer::"+r+": "+e)}catch(t){OpenAjax.hub._debugger()}};else y=function(){};this._init=function(){n.addContainer(this),d=OpenAjax.hub.IframeContainer._rpcRouter.add(r,this),h=e(i,g,y);var t=i.IframeContainer.clientRelay,a=OpenAjax.gadgets.rpc.getRelayChannel();if(i.IframeContainer.tunnelURI){if("wpm"!==a&&"ifpc"!==a)throw new Error(OpenAjax.hub.Error.IncompatBrowser)}else y("WARNING: Parameter 'IframeContaienr.tunnelURI' not specified. Connection will not be fully secure."),"rmr"!==a||t||(t=OpenAjax.gadgets.rpc.getOrigin(i.IframeContainer.uri)+"/robots.txt");o(),OpenAjax.gadgets.rpc.setupReceiver(d,t),l()},this.sendToClient=function(e,t,n){OpenAjax.gadgets.rpc.call(d,"openajax.pubsub",null,"pub",e,t,n)},this.remove=function(){c(),clearTimeout(p),OpenAjax.gadgets.rpc.removeReceiver(d);var e=document.getElementById(d);e.parentNode.removeChild(e),OpenAjax.hub.IframeContainer._rpcRouter.remove(d)},this.isConnected=function(){return m},this.getClientID=function(){return r},this.getPartnerOrigin=function(){if(m){var e=OpenAjax.gadgets.rpc.getReceiverOrigin(d);if(e)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(e)[1]}return null},this.getParameters=function(){return i},this.getHub=function(){return n},this.getIframe=function(){return document.getElementById(d)},this._handleIncomingRPC=function(e,t,r){switch(e){case"pub":n.publishForClient(f,t,r);break;case"sub":var a="";try{b[r]=n.subscribeForClient(f,t,r)}catch(o){a=o.message}return a;case"uns":var u=b[r];return n.unsubscribeForClient(f,u),delete b[r],r;case"con":return s(),!0;case"dis":if(l(),c(),i.Container.onDisconnect)try{i.Container.onDisconnect.call(g,f)}catch(o){OpenAjax.hub._debugger(),y("caught error from onDisconnect callback to constructor: "+o.message)}return!0}},this._onSecurityAlert=function(e){u(t[e])},this._init()},OpenAjax.hub.IframeHubClient=function(e){function t(){if(!s)throw new Error(OpenAjax.hub.Error.Disconnected)}function n(e){if(!e)throw new Error(OpenAjax.hub.Error.BadParameters);for(var t=e.split("."),n=t.length,r=0;n>r;r++){var i=t[r];if(""===i||-1!=i.indexOf("*")&&"*"!=i&&"**"!=i)throw new Error(OpenAjax.hub.Error.BadParameters);if("**"==i&&n-1>r)throw new Error(OpenAjax.hub.Error.BadParameters)}}function r(e){if(!e||""===e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))throw new Error(OpenAjax.hub.Error.BadParameters)}if(!e||!e.HubClient||!e.HubClient.onSecurityAlert)throw new Error(OpenAjax.hub.Error.BadParameters);var i,a=this,o=e.HubClient.scope||window,s=!1,c={},u=0;if(e.HubClient.log)var l=function(t){try{e.HubClient.log.call(o,"IframeHubClient::"+i+": "+t)}catch(n){OpenAjax.hub._debugger()}};else l=function(){};this._init=function(){var t=OpenAjax.gadgets.util.getUrlParameters();if(!t.parent){var n=t.oahParent+"/robots.txt";OpenAjax.gadgets.rpc.setupReceiver("..",n)}if(e.IframeHubClient&&e.IframeHubClient.requireParentVerifiable&&null===OpenAjax.gadgets.rpc.getReceiverOrigin(".."))throw OpenAjax.gadgets.rpc.removeReceiver(".."),new Error(OpenAjax.hub.Error.IncompatBrowser);OpenAjax.hub.IframeContainer._rpcRouter.add("..",this),i=OpenAjax.gadgets.rpc.RPC_ID,t.oahId&&(i=i.substring(0,i.lastIndexOf("_")))},this.connect=function(e,t){function n(n){if(n&&(s=!0,e))try{e.call(t||window,a,!0)}catch(r){OpenAjax.hub._debugger(),l("caught error from onComplete callback to connect(): "+r.message)}}if(s)throw new Error(OpenAjax.hub.Error.Duplicate);OpenAjax.gadgets.rpc.call("..","openajax.pubsub",n,"con")},this.disconnect=function(e,t){if(!s)throw new Error(OpenAjax.hub.Error.Disconnected);s=!1;var n=null;e&&(n=function(){try{e.call(t||window,a,!0)}catch(n){OpenAjax.hub._debugger(),l("caught error from onComplete callback to disconnect(): "+n.message)}}),OpenAjax.gadgets.rpc.call("..","openajax.pubsub",n,"dis")},this.getPartnerOrigin=function(){if(s){var e=OpenAjax.gadgets.rpc.getReceiverOrigin("..");if(e)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(e)[1]}return null},this.getClientID=function(){return i},this.subscribe=function(e,r,i,a,o){function s(e){if(""!==e&&delete c[h],a)try{a.call(i,h,""===e,e)}catch(t){OpenAjax.hub._debugger(),l("caught error from onComplete callback to subscribe(): "+t.message)}}if(t(),n(e),!r)throw new Error(OpenAjax.hub.Error.BadParameters);i=i||window;var h=""+u++;return c[h]={cb:r,sc:i,d:o},OpenAjax.gadgets.rpc.call("..","openajax.pubsub",s,"sub",e,h),h},this.publish=function(e,n){t(),r(e),OpenAjax.gadgets.rpc.call("..","openajax.pubsub",null,"pub",e,n)},this.unsubscribe=function(e,n,r){function i(){if(delete c[e],n)try{n.call(r||window,e,!0)}catch(t){OpenAjax.hub._debugger(),l("caught error from onComplete callback to unsubscribe(): "+t.message)}}if(t(),!e)throw new Error(OpenAjax.hub.Error.BadParameters);if(!c[e]||c[e].uns)throw new Error(OpenAjax.hub.Error.NoSubscription);c[e].uns=!0,OpenAjax.gadgets.rpc.call("..","openajax.pubsub",i,"uns",null,e)},this.isConnected=function(){return s},this.getScope=function(){return o},this.getSubscriberData=function(e){if(t(),c[e])return c[e].d;throw new Error(OpenAjax.hub.Error.NoSubscription)},this.getSubscriberScope=function(e){if(t(),c[e])return c[e].sc;throw new Error(OpenAjax.hub.Error.NoSubscription)},this.getParameters=function(){return e},this._handleIncomingRPC=function(e,t,n,r){if("pub"===e&&c[r]&&!c[r].uns)try{c[r].cb.call(c[r].sc,t,n,c[r].d)}catch(i){OpenAjax.hub._debugger(),l("caught error from onData callback to subscribe(): "+i.message)}return"con"===t?!0:!1},this._init()},OpenAjax.hub.IframeContainer._rpcRouter=function(){function e(){var e=r[this.f];return e?e._handleIncomingRPC.apply(e,arguments):void 0}function n(e,t){var n=r[e];n&&n._onSecurityAlert.call(n,t)}var r={};return{add:function(i,a){function o(e,t){if(".."===e)return void(r[".."]||(r[".."]=t));for(var n=e;document.getElementById(n);)n=e+"_"+(32767*Math.random()|0).toString(16);return r[n]=t,n}return OpenAjax.gadgets.rpc.register("openajax.pubsub",e),OpenAjax.gadgets.rpc.config({securityCallback:n}),t[OpenAjax.gadgets.rpc.SEC_ERROR_LOAD_TIMEOUT]=OpenAjax.hub.SecurityAlert.LoadTimeout,t[OpenAjax.gadgets.rpc.SEC_ERROR_FRAME_PHISH]=OpenAjax.hub.SecurityAlert.FramePhish,t[OpenAjax.gadgets.rpc.SEC_ERROR_FORGED_MSG]=OpenAjax.hub.SecurityAlert.ForgedMsg,this.add=o,o(i,a)},remove:function(e){delete r[e]}}}();var t={}}(),OpenAjax}),define("OpenAjax/containers/iframe/crypto",["OpenAjax/hub/hub"],function(e){return"undefined"==typeof e._smash&&(e._smash={}),e._smash.crypto={strToWA:function(e,t){for(var n=Array(),r=(1<<t)-1,i=0;i<e.length*t;i+=t)n[i>>5]|=(e.charCodeAt(i/t)&r)<<32-t-i%32;return n},hmac_sha1:function(e,t,n){for(var r=Array(16),i=Array(16),a=0;16>a;a++)r[a]=909522486^e[a],i[a]=1549556828^e[a];var o=this.sha1(r.concat(this.strToWA(t,n)),512+t.length*n);return this.sha1(i.concat(o),672)},newPRNG:function(e){function t(e){return r.hmac_sha1(a,e,8)}function n(e){for(var n=t(e),r=0;5>r;r++)o[r]^=n[r]}var r=this;
("string"!=typeof e||e.length<12)&&alert("WARNING: Seed length too short ...");var a=[43417,15926,18182,33130,9585,30800,49772,40144,47678,55453,4659,38181,65340,6787,54417,65301],o=[],s=0;return n(e),{addSeed:function(e){n(e)},nextRandomOctets:function(e){for(var t=[];e>0;){s+=1;var n=r.hmac_sha1(o,s.toString(16),8);for(i=0;i<20&e>0;i++,e--)t.push((n[i>>2]>>i%4)%256)}return t},nextRandomB64Str:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",n=this.nextRandomOctets(e),r="",i=0;e>i;i++)r+=t.charAt(63&n[i]);return r}}},sha1:function(){function e(e,t,n,r){return 20>e?t&n|~t&r:40>e?t^n^r:60>e?t&n|t&r|n&r:t^n^r}function t(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}var n=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n},r=function(e,t){return e<<t|e>>>32-t};return function(i,a){i[a>>5]|=128<<24-a%32,i[(a+64>>9<<4)+15]=a;for(var o=Array(80),s=1732584193,c=-271733879,u=-1732584194,l=271733878,h=-1009589776,d=0;d<i.length;d+=16){for(var p=s,f=c,g=u,m=l,b=h,v=0;80>v;v++){o[v]=16>v?i[d+v]:r(o[v-3]^o[v-8]^o[v-14]^o[v-16],1);var y=n(n(r(p,5),e(v,f,g,m)),n(n(b,o[v]),t(v)));b=m,m=g,g=r(f,30),f=p,p=y}s=n(p,s),c=n(f,c),u=n(g,u),l=n(m,l),h=n(b,h)}return Array(s,c,u,l,h)}}()},e}),this.JSON||(JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,a,o,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,n=0;a>n;n+=1)o[n]=str(n,c)||"null";return i=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)r=rep[n],"string"==typeof r&&(i=str(r,c),i&&o.push(quote(r)+(gap?": ":":")+i));else for(r in c)Object.hasOwnProperty.call(c,r)&&(i=str(r,c),i&&o.push(quote(r)+(gap?": ":":")+i));return i=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("OpenAjax/containers/iframe/json2",function(){}),define("OpenAjax/containers/iframe/rpc/rpc-dependencies",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2"],function(e){return e.gadgets.util=function(){function e(e){var t,n=e.indexOf("?"),r=e.indexOf("#");return t=-1===r?e.substr(n+1):[e.substr(n+1,r-n-1),"&",e.substr(r+1)].join(""),t.split("&")}var t=null,n=[];return{getUrlParameters:function(n){if(null!==t&&"undefined"==typeof n)return t;for(var r={},i=e(n||document.location.href),a=window.decodeURIComponent?decodeURIComponent:unescape,o=0,s=i.length;s>o;++o){var c=i[o].indexOf("=");if(-1!==c){var u=i[o].substring(0,c),l=i[o].substring(c+1);l=l.replace(/\+/g," "),r[u]=a(l)}}return"undefined"==typeof n&&(t=r),r},registerOnLoadHandler:function(e){n.push(e)},runOnLoadHandlers:function(){for(var e=0,t=n.length;t>e;++e)n[e]()},attachBrowserEvent:function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n)},removeBrowserEvent:function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n)}}}(),e.gadgets.util.getUrlParameters(),e.gadgets.json=e.gadgets.json||{},e.gadgets.json.stringify||(e.gadgets.json={parse:function(e){try{return window.JSON.parse(e)}catch(t){return!1}},stringify:function(e){try{return window.JSON.stringify(e)}catch(t){return null}}}),e.gadgets.log=function(t){e.gadgets.log.logAtLevel(e.gadgets.log.INFO,t)},e.gadgets.warn=function(t){e.gadgets.log.logAtLevel(e.gadgets.log.WARNING,t)},e.gadgets.error=function(t){e.gadgets.log.logAtLevel(e.gadgets.log.ERROR,t)},e.gadgets.setLogLevel=function(t){e.gadgets.log.logLevelThreshold_=t},e.gadgets.log.logAtLevel=function(t,n){if(!(t<e.gadgets.log.logLevelThreshold_)&&e.gadgets.log._console){var r=e.gadgets.log._console;t==e.gadgets.log.WARNING&&r.warn?r.warn(n):t==e.gadgets.log.ERROR&&r.error?r.error(n):r.log&&r.log(n)}},e.gadgets.log.INFO=1,e.gadgets.log.WARNING=2,e.gadgets.log.ERROR=3,e.gadgets.log.NONE=4,e.gadgets.log.logLevelThreshold_=e.gadgets.log.INFO,e.gadgets.log._console=window.console?window.console:window.opera?window.opera.postError:void 0,function(){function t(){n||(n=!0,e.gadgets.util.runOnLoadHandlers(),e.gadgets.util.registerOnLoadHandler=function(e){setTimeout(e,0)},window.detachEvent&&window.detachEvent("onload",t))}if(!window.__isgadget){var n=!1;window.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):window.attachEvent&&window.attachEvent("onload",t)}}(),e}),define("OpenAjax/containers/iframe/rpc/fe.transport",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies"],function(e){return e.gadgets.rpctx=e.gadgets.rpctx||{},e.gadgets.rpctx.frameElement||(e.gadgets.rpctx.frameElement=function(){function t(t,r,o){try{if(".."!==r){var s=window.frameElement;if("function"==typeof s[i])return"function"!=typeof s[i][a]&&(s[i][a]=function(t){n(e.gadgets.json.parse(t))}),void s[i](e.gadgets.json.stringify(o))}else{var c=document.getElementById(t);if("function"==typeof c[i]&&"function"==typeof c[i][a])return void c[i][a](e.gadgets.json.stringify(o))}}catch(u){}return!0}var n,r,i="__g2c_rpc",a="__c2g_rpc";return{getCode:function(){return"fe"},isParentVerifiable:function(){return!1},init:function(e,t){return n=e,r=t,!0},setup:function(t){if(".."!==t)try{var a=document.getElementById(t);a[i]=function(t){n(e.gadgets.json.parse(t))}}catch(o){return!1}if(".."===t){r("..",!0);var s=function(){window.setTimeout(function(){e.gadgets.rpc.call(t,e.gadgets.rpc.ACK)},500)};e.gadgets.util.registerOnLoadHandler(s)}return!0},call:function(e,n,r){t(e,n,r)}}}()),e}),define("OpenAjax/containers/iframe/rpc/ifpc.transport",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies","OpenAjax/containers/iframe/rpc/fe.transport"],function(e){return e.gadgets.rpctx=e.gadgets.rpctx||{},e.gadgets.rpctx.ifpc||(e.gadgets.rpctx.ifpc=function(){function t(t){for(var n=[],r=0,i=t.length;i>r;++r)n.push(encodeURIComponent(e.gadgets.json.stringify(t[r])));return n.join("&")}function n(e){for(var t,n=a.length-1;n>=0;--n){var r=a[n];try{if(r&&(r.recyclable||"complete"===r.readyState)){if(r.parentNode.removeChild(r),!window.ActiveXObject){r.recyclable=!1,t=r;break}a[n]=r=null,a.splice(n,1)}}catch(i){}}t||(t=document.createElement("iframe"),t.style.border=t.style.width=t.style.height="0px",t.style.visibility="hidden",t.style.position="absolute",t.onload=function(){this.recyclable=!0},a.push(t)),t.src=e,window.setTimeout(function(){document.body.appendChild(t)},0)}function r(e,t){for(var n=t-1;n>=0;--n)if("undefined"==typeof e[n])return!1;return!0}var i,a=[],o=0,s=2e3,c={};return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return!0},init:function(e,t){return i=t,i("..",!0),!0},setup:function(e){return i(e,!0),!0},call:function(r,i,a){var c=e.gadgets.rpc.getRelayUrl(r);if(++o,!c)return void e.gadgets.warn("No relay file assigned for IFPC");var u=null,l=[];if(a.l){var h=a.a;u=[c,"#",t([i,o,1,0,t([i,a.s,"","",i].concat(h))])].join(""),l.push(u)}else{u=[c,"#",r,"&",i,"@",o,"&"].join("");for(var d,p=encodeURIComponent(e.gadgets.json.stringify(a)),f=s-u.length,g=Math.ceil(p.length/f),m=0;p.length>0;)d=p.substring(0,f),p=p.substring(f),l.push([u,g,"&",m,"&",d].join("")),m+=1}do n(l.shift());while(l.length>0);return!0},_receiveMessage:function(t,n){var i=t[1],a=parseInt(t[2],10),o=parseInt(t[3],10),s=t[t.length-1],u=1===a;a>1&&(c[i]||(c[i]=[]),c[i][o]=s,r(c[i],a)&&(s=c[i].join(""),delete c[i],u=!0)),u&&n(e.gadgets.json.parse(decodeURIComponent(s)))}}}()),e}),define("OpenAjax/containers/iframe/rpc/rmr.transport",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies","OpenAjax/containers/iframe/rpc/fe.transport","OpenAjax/containers/iframe/rpc/ifpc.transport"],function(e){return e.gadgets.rpctx=e.gadgets.rpctx||{},e.gadgets.rpctx.rmr||(e.gadgets.rpctx.rmr=function(){function t(t,n,r,i){var a=function(){document.body.appendChild(t),t.src="about:blank",i&&(t.onload=function(){o(i)}),t.src=n+"#"+r};document.body?a():e.gadgets.util.registerOnLoadHandler(function(){a()})}function n(n){if("object"!=typeof d[n]){var i=document.createElement("iframe"),o=i.style;o.position="absolute",o.top="0px",o.border="0",o.opacity="0",o.width="10px",o.height="1px",i.id="rmrtransport-"+n,i.name=i.id;var s=e.gadgets.rpc.getRelayUrl(n);s||(s=e.gadgets.rpc.getOrigin(e.gadgets.util.getUrlParameters().parent)+"/robots.txt"),d[n]={frame:i,receiveWindow:null,relayUri:s,searchCounter:0,width:10,waiting:!0,queue:[],sendId:0,recvId:0},".."!==n&&t(i,s,a(n)),r(n)}}function r(t){var n=null;d[t].searchCounter++;try{var i=e.gadgets.rpc._getTargetWin(t);n=".."===t?i.frames["rmrtransport-"+e.gadgets.rpc.RPC_ID]:i.frames["rmrtransport-.."]}catch(a){}var o=!1;if(n&&(o=s(t,n)),!o){if(d[t].searchCounter>h)return;window.setTimeout(function(){r(t)},l)}}function i(t,n,r,i){var o=null;if(o=".."!==r?d[".."]:d[t]){if(n!==e.gadgets.rpc.ACK&&o.queue.push(i),o.waiting||0===o.queue.length&&(n!==e.gadgets.rpc.ACK||!i||i.ackAlone!==!0))return!0;o.queue.length>0&&(o.waiting=!0);var s=o.relayUri+"#"+a(t);try{o.frame.contentWindow.location=s;var c=10==o.width?20:10;o.frame.style.width=c+"px",o.width=c}catch(u){return!1}}return!0}function a(t){var n=d[t],r={id:n.sendId};return n&&(r.d=Array.prototype.slice.call(n.queue,0),r.d.push({s:e.gadgets.rpc.ACK,id:n.recvId})),e.gadgets.json.stringify(r)}function o(t){for(var n=d[t],r=n.receiveWindow.location.hash.substring(1),a=e.gadgets.json.parse(decodeURIComponent(r))||{},o=a.d||[],s=!1,l=!1,h=0,p=n.recvId-a.id,f=0;f<o.length;++f){var g=o[f];if(g.s!==e.gadgets.rpc.ACK)s=!0,++h<=p||(++n.recvId,c(g));else{u(t,!0),n.waiting&&(l=!0),n.waiting=!1;var m=Math.max(0,g.id-n.sendId);n.queue.splice(0,m),n.sendId=Math.max(n.sendId,g.id||0)}}if(s||l&&n.queue.length>0){var b=".."===t?e.gadgets.rpc.RPC_ID:"..";i(t,e.gadgets.rpc.ACK,b,{ackAlone:s})}}function s(e,n){function r(){o(e)}var i=d[e];try{var s=!1;if(s="document"in n,!s)return!1;if(s="object"==typeof n.document,!s)return!1;var c=n.location.href;if("about:blank"===c)return!1}catch(u){return!1}return i.receiveWindow=n,"undefined"==typeof n.attachEvent?n.onresize=r:n.attachEvent("onresize",r),".."===e?t(i.frame,i.relayUri,a(e),e):o(e),!0}var c,u,l=500,h=10,d={};return{getCode:function(){return"rmr"},isParentVerifiable:function(){return!0},init:function(e,t){return c=e,u=t,!0},setup:function(t){try{n(t)}catch(r){return e.gadgets.warn("Caught exception setting up RMR: "+r),!1}return!0},call:function(e,t,n){return i(e,n.s,t,n)}}}()),e}),define("OpenAjax/containers/iframe/rpc/wpm.transport",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies","OpenAjax/containers/iframe/rpc/fe.transport","OpenAjax/containers/iframe/rpc/ifpc.transport","OpenAjax/containers/iframe/rpc/rmr.transport"],function(e){return e.gadgets.rpctx=e.gadgets.rpctx||{},e.gadgets.rpctx.wpm||(e.gadgets.rpctx.wpm=function(){function t(){function t(e){"postmessage.test"==e.data&&(n=!0,"undefined"==typeof e.origin&&(s=!0))}var n=!1;e.gadgets.util.attachBrowserEvent(window,"message",t,!1),window.postMessage("postmessage.test","*"),n&&(o=!0),e.gadgets.util.removeBrowserEvent(window,"message",t,!1)}function n(t){var n=e.gadgets.json.parse(t.data);if(n&&n.f){var i=e.gadgets.rpc.getRelayUrl(n.f)||e.gadgets.util.getUrlParameters().parent,a=e.gadgets.rpc.getOrigin(i);(s?t.domain===/^.+:\/\/([^:]+).*/.exec(a)[1]:t.origin===a)&&r(n)}}var r,i,a,o=!1,s=!1;return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},init:function(s,c){return r=s,i=c,t(),a=o?function(e,t,n){window.setTimeout(function(){e.postMessage(t,n)},0)}:function(e,t,n){e.postMessage(t,n)},e.gadgets.util.attachBrowserEvent(window,"message",n,!1),i("..",!0),!0},setup:function(t,n,r){return".."===t&&(r?e.gadgets.rpc._createRelayIframe(n):e.gadgets.rpc.call(t,e.gadgets.rpc.ACK)),!0},call:function(t,n,r){var i=e.gadgets.rpc._getTargetWin(t),o=e.gadgets.rpc.getRelayUrl(t)||e.gadgets.util.getUrlParameters().parent,s=e.gadgets.rpc.getOrigin(o);return s?a(i,e.gadgets.json.stringify(r),s):e.gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message"),!0},relayOnload:function(e){i(e,!0)}}}()),e}),define("OpenAjax/containers/iframe/rpc/rpc",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies","OpenAjax/containers/iframe/rpc/fe.transport","OpenAjax/containers/iframe/rpc/ifpc.transport","OpenAjax/containers/iframe/rpc/rmr.transport","OpenAjax/containers/iframe/rpc/wpm.transport"],function(e){return e.gadgets.rpc||(e.gadgets.rpc=function(){function t(){return"function"==typeof window.postMessage?e.gadgets.rpctx.wpm:"object"==typeof window.postMessage?e.gadgets.rpctx.wpm:navigator.userAgent.indexOf("WebKit")>0?e.gadgets.rpctx.rmr:"Gecko"===navigator.product?e.gadgets.rpctx.frameElement:e.gadgets.rpctx.ifpc}function n(e,t){var n=q;t||(n=B),P[e]=n;for(var r=L[e]||[],i=0;i<r.length;++i){var a=r[i];a.t=h(e),n.call(e,a.f,a)}L[e]=[]}function r(){function t(){H=!0}F||(e.gadgets.util.attachBrowserEvent(window,"unload",t,!1),F=!0)}function i(t,n,i,a,o){k[n]&&k[n]===i||(e.gadgets.error("Invalid auth token. "+k[n]+" vs "+i),T(n,U)),o.onunload=function(){A[n]&&!H&&(T(n,M),e.gadgets.rpc.removeReceiver(n))},r(),a=e.gadgets.json.parse(decodeURIComponent(a)),q.relayOnload(n,a)}function a(t){if(t&&"string"==typeof t.s&&"string"==typeof t.f&&t.a instanceof Array){if(k[t.f]&&k[t.f]!==t.t&&(e.gadgets.error("Invalid auth token. "+k[t.f]+" vs "+t.t),T(t.f,U)),t.s===y)return void window.setTimeout(function(){n(t.f,!0)},0);t.c&&(t.callback=function(n){e.gadgets.rpc.call(t.f,b,null,t.c,n)});var r=(w[t.s]||w[v]).apply(t,t.a);t.c&&"undefined"!=typeof r&&e.gadgets.rpc.call(t.f,b,null,t.c,r)}}function o(e){if(!e)return"";e=e.toLowerCase(),0==e.indexOf("//")&&(e=window.location.protocol+e),-1==e.indexOf("://")&&(e=window.location.protocol+"//"+e);var t=e.substring(e.indexOf("://")+3),n=t.indexOf("/");-1!=n&&(t=t.substring(0,n));var r=e.substring(0,e.indexOf("://")),i="",a=t.indexOf(":");if(-1!=a){var o=t.substring(a+1);t=t.substring(0,a),("http"===r&&"80"!==o||"https"===r&&"443"!==o)&&(i=":"+o)}return r+"://"+t+i}function s(e){if("undefined"==typeof e||".."===e)return window.parent;e=String(e);var t=window.frames[e];return t?t:(t=document.getElementById(e),t&&t.contentWindow?t.contentWindow:null)}function c(e,t,n){if(A[e]!==!0){"undefined"==typeof A[e]&&(A[e]=0);var r=document.getElementById(e);return".."!==e&&null==r||q.setup(e,t,n)!==!0?void(A[e]!==!0&&A[e]++<x?window.setTimeout(function(){c(e,t,n)},_):(P[e]=B,A[e]=!0)):void(A[e]=!0)}}function u(t,n){if("undefined"==typeof I[t]){I[t]=!1;var r=e.gadgets.rpc.getRelayUrl(t);if(o(r)!==o(window.location.href))return!1;var i=s(t);try{I[t]=i.OpenAjax.gadgets.rpc.receiveSameDomain}catch(a){e.gadgets.error("Same domain call failed: parent= incorrectly set.")}}return"function"==typeof I[t]?(I[t](n),!0):!1}function l(e,t,n){/http(s)?:\/\/.+/.test(t)||(0==t.indexOf("//")?t=window.location.protocol+t:"/"==t.charAt(0)?t=window.location.protocol+"//"+window.location.host+t:-1==t.indexOf("://")&&(t=window.location.protocol+"//"+t)),E[e]=t,C[e]=!!n}function h(e){return k[e]}function d(e,t,n){t=t||"",k[e]=String(t),c(e,t,n)}function p(t,r){function i(i){var s=i?i.rpc:{},c=s.parentRelayUrl;if("http://"!==c.substring(0,7)&&"https://"!==c.substring(0,8)&&"//"!==c.substring(0,2)&&"string"==typeof j.parent&&""!==j.parent)if("/"!==c.substring(0,1)){var u=j.parent.lastIndexOf("/");c=j.parent.substring(0,u+1)+c}else c=o(j.parent)+c;var h=!!s.useLegacyProtocol;l("..",c,h),h&&(q=e.gadgets.rpctx.ifpc,q.init(a,n));var p=r||j.forcesecure||!1;d("..",t,p)}var s={parentRelayUrl:e.gadgets.config.NonEmptyStringValidator};e.gadgets.config.register("rpc",s,i)}function f(e,t,n){var r=n||j.forcesecure||!1,i=t||j.parent;i&&(l("..",i),d("..",e,r))}function g(t,n,r,i){if(e.gadgets.util){var a=document.getElementById(t);if(!a)throw new Error("Cannot set up gadgets.rpc receiver with ID: "+t+", element not found.");var o=n||a.src;l(t,o);var s=e.gadgets.util.getUrlParameters(a.src),c=r||s.rpctoken,u=i||s.forcesecure;d(t,c,u)}}function m(e,t,n,r){if(".."===e){var i=n||j.rpctoken||j.ifpctok||"";window.__isgadget===!0?p(i,r):f(i,t,r)}else g(e,t,n,r)}var b="__cb",v="",y="__ack",_=500,x=10,w={},E={},C={},k={},S=0,O={},A={},I={},j={},P={},L={},R=window.top!==window.self,N=window.name,T=function(){},D=0,M=1,U=2,B=function(){function t(t){return function(){e.gadgets.log("gadgets.rpc."+t+"("+e.gadgets.json.stringify(Array.prototype.slice.call(arguments))+"): call ignored. [caller: "+document.location+", isChild: "+R+"]")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:t("init"),setup:t("setup"),call:t("call")}}();e.gadgets.util&&(j=e.gadgets.util.getUrlParameters());var H=!1,F=!1,q=t();return w[v]=function(){e.gadgets.warn("Unknown RPC service: "+this.s)},w[b]=function(e,t){var n=O[e];n&&(delete O[e],n(t))},{config:function(e){"function"==typeof e.securityCallback&&(T=e.securityCallback)},register:function(e,t){if(e===b||e===y)throw new Error("Cannot overwrite callback/ack service");if(e===v)throw new Error("Cannot overwrite default service: use registerDefault");w[e]=t},unregister:function(e){if(e===b||e===y)throw new Error("Cannot delete callback/ack service");if(e===v)throw new Error("Cannot delete default service: use unregisterDefault");delete w[e]},registerDefault:function(e){w[v]=e},unregisterDefault:function(){delete w[v]},forceParentVerifiable:function(){q.isParentVerifiable()||(q=e.gadgets.rpctx.ifpc)},call:function(t,n,r){t=t||"..";var i="..";".."===t&&(i=N),++S,r&&(O[S]=r);var a={s:n,f:i,c:r?S:0,a:Array.prototype.slice.call(arguments,3),t:k[t],l:C[t]};if(".."!==t&&!document.getElementById(t))return void e.gadgets.log("WARNING: attempted send to nonexistent frame: "+t);if(!u(t,a)){var o=P[t];if(!o)return void(L[t]?L[t].push(a):L[t]=[a]);C[t]&&(o=e.gadgets.rpctx.ifpc),o.call(t,i,a)===!1&&(P[t]=B,q.call(t,i,a))}},getRelayUrl:function(e){var t=E[e];return t&&"/"===t.substring(0,1)&&(t="/"===t.substring(1,2)?document.location.protocol+t:document.location.protocol+"//"+document.location.host+t),t},setRelayUrl:l,setAuthToken:d,setupReceiver:m,getAuthToken:h,removeReceiver:function(e){delete E[e],delete C[e],delete k[e],delete A[e],delete I[e],delete P[e]},getRelayChannel:function(){return q.getCode()},receive:function(e,t){e.length>4?q._receiveMessage(e,a):i.apply(null,e.concat(t))},receiveSameDomain:function(e){e.a=Array.prototype.slice.call(e.a),window.setTimeout(function(){a(e)},0)},getOrigin:o,getReceiverOrigin:function(t){var n=P[t];if(!n)return null;if(!n.isParentVerifiable(t))return null;var r=e.gadgets.rpc.getRelayUrl(t)||e.gadgets.util.getUrlParameters().parent;return e.gadgets.rpc.getOrigin(r)},init:function(){q.init(a,n)===!1&&(q=B),R&&m("..")},_getTargetWin:s,_createRelayIframe:function(t,n){function r(){document.body.appendChild(o),o.src='javascript:"<html></html>"',o.src=a}var i=e.gadgets.rpc.getRelayUrl("..");if(i){var a=i+"#..&"+N+"&"+t+"&"+encodeURIComponent(e.gadgets.json.stringify(n)),o=document.createElement("iframe");return o.style.border=o.style.width=o.style.height="0px",o.style.visibility="hidden",o.style.position="absolute",document.body?r():e.gadgets.util.registerOnLoadHandler(function(){r()}),o}},ACK:y,RPC_ID:N,SEC_ERROR_LOAD_TIMEOUT:D,SEC_ERROR_FRAME_PHISH:M,SEC_ERROR_FORGED_MSG:U}}(),e.gadgets.rpc.init()),e}),define("OpenAjax",["OpenAjax/hub/hub","OpenAjax/containers/inline/inline","OpenAjax/containers/iframe/iframe","OpenAjax/containers/iframe/crypto","OpenAjax/containers/iframe/json2","OpenAjax/containers/iframe/rpc/rpc-dependencies","OpenAjax/containers/iframe/rpc/fe.transport","OpenAjax/containers/iframe/rpc/ifpc.transport","OpenAjax/containers/iframe/rpc/rmr.transport","OpenAjax/containers/iframe/rpc/wpm.transport","OpenAjax/containers/iframe/rpc/rpc"],function(e){return e}),define("scripts/core/open-ajax/open-ajax",["OpenAjax"],function(e){return e}),define("scripts/core/hub/hub",["scripts/core/open-ajax/open-ajax"],function(){var e=function(){function e(){var e="anyware",t=function(t){return e+"."+t},n=function(){return!0},r=function(){},i=new OpenAjax.hub.ManagedHub({onPublish:n,onSubscribe:n,onUnsubscribe:n,onSecurityAlert:r});return{subscribe:function(e,n){return i.subscribe(t(e),n)},unsubscribe:function(e){return i.unsubscribe(e)},publish:function(e,n){return i.publish(t(e),n)},getMessageHub:function(){return i},removeContainer:function(e){return i.removeContainer(e)}}}var t;return{getInstance:function(){return t||(t=e(),window.Adobe=window.Adobe||{},window.Adobe.Anyware=window.Adobe.Anyware||{},window.Adobe.Anyware.Hub=t),t}}}();return e}),define("scripts/core/container/container",["jquery","scripts/core/hub/hub"],function(e,t){var n=function(e,t,n,r,i,a){this.init(e,t,n,r,i,a)};return n.prototype={hub:t.getInstance(),container:null,init:function(e,t,n,r,i,a){var o;this.checkRequiredParams(e,t,n),o=i||{"class":"anyware-iframe",style:{border:"none",width:"100%",height:"100%",overflow:"hidden",scroll:"no"},allowTransparency:!0,frameborder:0},this.componentName=e,this.componentId=this.createComponentId(e),this.element=t,this.clientUrl=n,this.tunnelUrl=this.getTunnelUrl(r),this.iframeAttrs=o,this.timeout=a||15e3},checkRequiredParams:function(e,t,n){if(!e||!t||!n)throw new Error("Expect element, clientUrl and handlers to be passed to constructor.")},loadComponent:function(t){var n=this.hub.getMessageHub(),r=this;this.container=new OpenAjax.hub.IframeContainer(n,this.componentId,{Container:{onSecurityAlert:function(t,n){t===r.container&&e(r.element).trigger("errorEvent",{errorType:r.getSecurityErrorType(n),errors:n})},onConnect:function(){r.readyHandler=r.setUpReadyHandler(t)},onDisconnect:function(){}},IframeContainer:{parent:this.element,iframeAttrs:this.iframeAttrs,uri:this.clientUrl,tunnelURI:this.tunnelUrl,timeout:this.timeout}})},unloadComponent:function(){this.hub.removeContainer(this.container),this.container=null},isConnected:function(){var e=!1;return this.container&&(e=this.container.isConnected()),e},subscribe:function(e,t){return this.hub.subscribe(this.getTopic(e),t)},unsubscribe:function(e){this.hub.unsubscribe(e)},publish:function(e,t){this.hub.publish(this.getTopic(e),t)},getComponentId:function(){return this.container.getClientID()},getComponentName:function(){return this.componentName},createComponentId:function(e){var t=Math.floor(1e4*Math.random());return e+"."+t},getSecurityErrorType:function(e){switch(e){case OpenAjax.hub.SecurityAlert.LoadTimeout:e="APPLICATION_LOAD_FAILURE";break;default:e="CROSS_DOMAIN_SECURITY_ERROR"}return e},setUpReadyHandler:function(e){var t=this;return this.subscribe("applicationReady",function(){e.apply(),t.removeReadyHandler()})},removeReadyHandler:function(){this.readyHandler&&(this.unsubscribe(this.readyHandler),this.readyHandler=null)},getTopic:function(e){return this.componentId+"."+e},getTunnelUrl:function(e){var t,n,r="rpc_relay.html",i=location.host,a=location.protocol;return e?t=e:(n=window.location.pathname,t=n.substring(0,n.lastIndexOf("/")+1)+r),a+"//"+i+t}},n}),define("scripts/components/common/util/lang",["jquery"],function(e){return e.extend({type:function(e){var t={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return t[typeof e]||t[Object.prototype.toString.call(e)]||(e?"object":"null")},isBoolean:function(e){return"boolean"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){var t=this.type(e);switch(t){case"number":return isFinite(e);case"null":case"undefined":return!1;default:return!!t}},isDate:function(e){return"date"===this.type(e)},timeStampToDate:function(e){var t,n,r=new RegExp("^([\\d]{4})-([\\d]{2})-([\\d]{2})T([\\d]{2}):([\\d]{2}):([\\d]{2}\\.?[\\d]{0,3})([\\+\\-])([\\d]{2}):([\\d]{2})$"),i=r.exec(e);return null!=i?(t=60*parseInt(i[8],10)+parseInt(i[9],10),"-"===i[7]&&(t=-t),n=new Date(Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),parseInt(i[6],10))-60*t*1e3)):null},ISO8601DateString:function(e){function t(e){return 10>e?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"},isPrimitive:function(e){var t=this.type(e);switch(t){case"undefined":case"number":case"boolean":case"string":return!0;default:return!1}},hasKey:function(e,t){return t in e},createNs:function(t){var n,r;return r=t.split("."),n=window[r[0]]=window[r[0]]||{},e.each(r.slice(1),function(e,t){n=n[t]=n[t]||{}}),n},rgb2hex:function(e){function t(e){return isNaN(e)?"00":n[(e-e%16)/16]+n[e%16]}var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],r=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+t(r[1])+t(r[2])+t(r[3])},localToGlobal:function(e,t,n){var r={},i=e.offset();return r.x=Math.floor(t+i.left),r.y=Math.floor(n+i.top),r},globalToLocal:function(e,t,n){var r={},i=e.offset();return r.x=Math.floor(t-i.left),r.y=Math.floor(n-i.top),r}}),jQuery}),define("scripts/components/common/models/configuration-model",["jquery","can","can-proxy","scripts/components/common/util/lang"],function(e,t){var n=t.Model.extend({domains:{dev:"store1.dev04.adobe.com","pre-stage":"store1.qa04.adobe.com",stage:"store1.stage.adobe.com",prod:"store1.adobe.com"},requiredAttrs:["appId","clientId","countryCode","marketSegment"],MISSING_REQUIRED_ATTRIBUTES:"Missing required attributes: ",CONFIGURATION_ERROR:"CONFIGURATION_ERROR",CLIENT_URL_UNAVAILABLE:"CLIENT_URL_UNAVAILABLE"},{init:function(){for(var e,t=this.constructor.requiredAttrs,n=0;n<t.length;n++)if(e=t[n],!this.attr(e))throw new Error(this.constructor.MISSING_REQUIRED_ATTRIBUTES+e)},load:function(t,n,r){var i=this.attr();return this.callbackScope=t,this.successCallback=n,this.errorCallback=r,e.ajax({url:this.getRequestUrl(i),dataType:"jsonp",jsonpCallback:this.getCallbackName(i),success:this.proxy("handleLoadSuccess"),error:this.proxy("handleLoadError")})},handleLoadSuccess:function(e){if(this.isClientUrlAvailable(e)){var t=this.updateData(e);this.doSuccessCallback(t)}else{var n={errorType:this.constructor.CLIENT_URL_UNAVAILABLE};this.doErrorCallback(n)}},handleLoadError:function(){var e={errorType:this.constructor.CONFIGURATION_ERROR};this.doErrorCallback(e)},doSuccessCallback:function(e){this.successCallback.call(this.callbackScope,e)},doErrorCallback:function(e){this.errorCallback.call(this.callbackScope,e)},isClientUrlAvailable:function(e){return this.isMarketSegmentSupported(e)&&!this.is404Response(e)},isMarketSegmentSupported:function(t){var n=!0;return e.isValue(t.supportedMarketSegments)&&(n=t.supportedMarketSegments.indexOf(this.attr("marketSegment"))>-1),n},is404Response:function(t){var n=!1;return e.isValue(t.errorCode)&&(n=404===t.errorCode),n},updateData:function(e){if(e.appPath){var t=this.attr(),n=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),r=t.isLocal?n:e.baseUrl[this.attr("landscape")],i=t.isLocal?e.appPath.replace("/anyware/latest/","/app/"):e.appPath;t.debug&&(i+=i.indexOf("?")>0?"&compress=false":"?compress=false"),e.appUrl=r+i}return this.attr(e)},getRequestUrl:function(){var e=this.attr(),t=this.getBaseUrl(),n=e.isLocal?"/app":"/anyware/latest",r=n+"/resources/config/";return t+r+e.appId+"/"+e.clientId+"/"+e.countryCode.toUpperCase()+"/config.json"},getBaseUrl:function(){var t=this.attr(),n=document.location.protocol,r="";return e.isValue(t.landscape)&&!t.isLocal&&(r=n+"//"+this.getConfigDomain(t.landscape)),r},getConfigDomain:function(e){var t=this.constructor.domains;return t[e]||t.prod},getCallbackName:function(e){return e.appId+"Config"},getConfigBaseUrl:function(e){var t=this.attr().baseUrl[e];return t}});return n}),function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function r(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;e=!0;var a=new this;e=!1;for(var o in n)a[o]="function"==typeof n[o]&&"function"==typeof i[o]&&t.test(n[o])?function(e,t){return function(){var n=this._super;this._super=i[e];var r=t.apply(this,arguments);return this._super=n,r}}(o,n[o]):n[o];return r.prototype=a,r.constructor=r,r.extend=arguments.callee,r}}(),define("lib/jquery-encoder/libs/Class.create",function(){}),function(e){var t={attr:[",",".","-","_"],css:["(",",","'",'"',")"," "],js:[",",".","_"," "]},n={attr:[],css:["behavior","-moz-behavior","-ms-behavior"]};e.encoder={encodeForHTML:function(t){var n=document.createElement("div");return e(n).text(t),e(n).html()},encodeForHTMLAttribute:function(n,r){r||(r=t.attr);for(var i="",a=0;a<n.length;a++){var o=n.charAt(a),s=n.charCodeAt(a);
if(!o.match(/[a-zA-Z0-9]/)&&e.inArray(o,r)<0){var c=s.toString(16);i+="&#x"+c+";"}else i+=o}return i},encodeForCSS:function(n,r){r||(r=t.css);for(var i="",a=0;a<n.length;a++){var o=n.charAt(a),s=n.charCodeAt(a);if(!o.match(/[a-zA-Z0-9]/)&&e.inArray(o,r)<0){var c=s.toString(16);i+="\\"+c+" "}else i+=o}return i},encodeForURL:function(e){return encodeURIComponent(e)},encodeForJavascript:function(n,i){i||(i=t.js);for(var a="",o=0;o<n.length;o++){var s=n.charAt(o),c=n.charCodeAt(o);if(e.inArray(s,i)>=0||null==r[c])a+=s;else{var u,l=c.toString(16);256>c?(u="00".substr(l.length),a+="\\x"+u+l.toUpperCase()):(u="0000".substr(l.length),a+="\\u"+u+l.toUpperCase())}}return a},canonicalize:function(e,t){if(null===e)return null;for(var n=e,r=e,i=0,a=0,o=[new c,new u,new l];;){r=n;for(var s=0;s<o.length;s++){var h=o[s].decode(n);h!=n&&(i++,n=h)}if(r==n)break;a++}if(t&&i>1)throw"Attack Detected - Multiple/Double Encodings used in input";return n}};for(var r=[],i=0;255>i;i++)r[i]=i>=48&&57>=i||i>=65&&90>=i||i>=97&&122>=i?null:i.toString(16);var a={html:function(t){return e.encoder.encodeForHTML(t.unsafe)},css:function(t){var r=[],i=[];t.map?r=t.map:r[t.name]=t.unsafe;for(var a in r)if("function"!=typeof r[a]&&r.hasOwnProperty(a)){var o=e.encoder.canonicalize(a,t.strict);e.inArray(o,n[t.context])<0&&(i[a]=e.encoder.encodeForCSS(r[a]))}return i},attr:function(t){var r=[],i=[];t.map?r=t.map:r[t.name]=t.unsafe;for(var a in r)if("function"!=typeof r[a]&&r.hasOwnProperty(a)){var o=e.encoder.canonicalize(a,t.strict);e.inArray(o,n[t.context])<0&&(i[a]=e.encoder.encodeForHTMLAttribute(r[a]))}return i}};e.fn.encode=function(){var t=arguments.length,n={context:"html",unsafe:null,name:null,map:null,setter:null,strict:!0};return 1==t&&"object"==typeof arguments[0]?e.extend(n,arguments[0]):(n.context=arguments[0],2==arguments.length?"html"==n.context?n.unsafe=arguments[1]:("attr"==n.content||"css"==n.content)&&(n.map=arguments[1]):(n.name=arguments[1],n.unsafe=arguments[2])),"html"==n.context?n.setter=this.html:"css"==n.context?n.setter=this.css:"attr"==n.context&&(n.setter=this.attr),n.setter.call(this,a[n.context].call(this,n))};var o=Class.extend({_input:null,_pushback:null,_temp:null,_index:0,_mark:0,_hasNext:function(){return null==this._input?!1:0==this._input.length?!1:this._index<this._input.length},init:function(e){this._input=e},pushback:function(e){this._pushback=e},index:function(){return this._index},hasNext:function(){return null!=this._pushback?!0:this._hasNext()},next:function(){if(null!=this._pushback){var e=this._pushback;return this._pushback=null,e}return this._hasNext()?this._input.charAt(this._index++):null},nextHex:function(){var e=this.next();return null==e?null:e.match(/[0-9A-Fa-f]/)?e:null},peek:function(e){return e?this._pushback&&this._pushback==e?!0:this._hasNext()?this._input.charAt(this._index)==e:!1:this._pushback?this._pushback:this._hasNext()?this._input.charAt(this._index):null},mark:function(){this._temp=this._pushback,this._mark=this._index},reset:function(){this._pushback=this._temp,this._index=this._mark},remainder:function(){var e=this._input.substr(this._index);return null!=this._pushback&&(e=this._pushback+e),e}}),s=Class.extend({decode:function(e){for(var t="",n=new o(e);n.hasNext();){var r=this.decodeCharacter(n);t+=null!=r?r:n.next()}return t},decodeCharacter:function(e){return e.next()}}),c=s.extend({decodeCharacter:function(e){e.mark();var t=e.next();if(null==t||"&"!=t)return e.reset(),null;var n=e.next();if(null==n)return e.reset(),null;var r;if("#"==n){if(r=this._getNumericEntity(e),null!=r)return r}else if(n.match(/[A-Za-z]/)&&(e.pushback(n),r=this._getNamedEntity(e),null!=r))return r;return e.reset(),null},_getNamedEntity:function(e){var t,n,r="";n=Math.min(e.remainder().length,m.getMaxKeyLength());for(var i=0;n>i;i++)r+=e.next().toLowerCase();if(t=m.getLongestMatch(r),null==t)return null;e.reset(),e.next(),n=t.getKey().length;for(var a=0;n>a;a++)e.next();return e.peek(";")&&e.next(),t.getValue()},_getNumericEntity:function(e){var t=e.peek();return null==t?null:"x"==t||"X"==t?(e.next(),this._parseHex(e)):this._parseNumber(e)},_parseHex:function(e){for(var t="";e.hasNext();){var n=e.peek();if(isNaN(parseInt(n,16))){if(";"==n){e.next();break}break}t+=n,e.next()}var r=parseInt(t,16);return!isNaN(r)&&d(r)?String.fromCharCode(r):null},_parseNumber:function(e){for(var t="";e.hasNext();){var n=e.peek();if(isNaN(parseInt(n,10))){if(";"==n){e.next();break}break}t+=n,e.next()}var r=parseInt(t,10);return!isNaN(r)&&d(r)?String.fromCharCode(r):null}}),u=s.extend({decodeCharacter:function(e){e.mark();var t=e.next();if(null==t)return e.reset(),null;if("%"!=t)return e.reset(),null;for(var n="",r=0;2>r;r++){var i=e.nextHex();null!=i&&(n+=i)}if(2==n.length){var a=parseInt(n,16);if(d(a))return String.fromCharCode(a)}return e.reset(),null}}),l=s.extend({decodeCharacter:function(e){e.mark();var t=e.next();if(null==t||"\\"!=t)return e.reset(),null;var n=e.next();if(null==n)return e.reset(),null;switch(n){case"\r":e.peek("\n")&&e.next();case"\n":case"\f":case"\x00":return this.decodeCharacter(e)}if("NaN"==parseInt(n,16))return n;for(var r=n,i=0;5>i;i++){var a=e.next();if(null==a||p(a))break;if("NaN"==parseInt(a,16)){e.pushback(a);break}r+=a}var o=parseInt(r,16);return d(o)?String.fromCharCode(o):"�"}}),h=Class.extend({root:null,maxKeyLen:0,size:0,init:function(){this.clear()},getLongestMatch:function(e){return null==this.root&&null==e?null:this.root.getLongestMatch(e,0)},getMaxKeyLength:function(){return this.maxKeyLen},clear:function(){this.root=null,this.maxKeyLen=0,this.size=0},put:function(e,t){var n,r;return null==this.root&&(this.root=new h.Node),null!=(r=this.root.put(e,0,t))?r:((n=e.length)>this.maxKeyLen&&(this.maxKeyLen=e.length),this.size++,null)}});h.Entry=Class.extend({_key:null,_value:null,init:function(e,t){this._key=e,this._value=t},getKey:function(){return this._key},getValue:function(){return this._value},equals:function(e){return e instanceof h.Entry?this._key==e._key&&this._value==e._value:!1}}),h.Node=Class.extend({_value:null,_nextMap:null,setValue:function(e){this._value=e},getNextNode:function(e){return this._nextMap?this._nextMap[e]:null},put:function(e,t,n){var r,i,a;return e.length==t?(a=this._value,this.setValue(n),a):(i=e.charAt(t),null==this._nextMap?(this._nextMap=h.Node.newNodeMap(),r=new h.Node,this._nextMap[i]=r):null==(r=this._nextMap[i])&&(r=new h.Node,this._nextMap[i]=r),r.put(e,t+1,n))},get:function(e,t){var n;return e.length<=t?this._value:null==(n=this.getNextNode(e.charAt(t)))?null:n.get(e,t+1)},getLongestMatch:function(e,t){var n,r;return e.length<=t?h.Entry.newInstanceIfNeeded(e,this._value):null==(n=this.getNextNode(e.charAt(t)))?h.Entry.newInstanceIfNeeded(e,t,this._value):null!=(r=n.getLongestMatch(e,t+1))?r:h.Entry.newInstanceIfNeeded(e,t,this._value)}}),h.Entry.newInstanceIfNeeded=function(){var e,t,n=arguments[0];return"string"==typeof arguments[1]?(e=arguments[1],t=n.length):(t=arguments[1],e=arguments[2]),null==e||null==n?null:(n.length>t&&(n=n.substr(0,t)),new h.Entry(n,e))},h.Node.newNodeMap=function(){return{}};var d=function(e){return e>=0&&1114111>=e},p=function(e){return e.match(/[\s]/)},f=[],g=[],m=new h;!function(){f["&quot"]="34",f["&amp"]="38",f["&lt"]="60",f["&gt"]="62",f["&nbsp"]="160",f["&iexcl"]="161",f["&cent"]="162",f["&pound"]="163",f["&curren"]="164",f["&yen"]="165",f["&brvbar"]="166",f["&sect"]="167",f["&uml"]="168",f["&copy"]="169",f["&ordf"]="170",f["&laquo"]="171",f["&not"]="172",f["&shy"]="173",f["&reg"]="174",f["&macr"]="175",f["&deg"]="176",f["&plusmn"]="177",f["&sup2"]="178",f["&sup3"]="179",f["&acute"]="180",f["&micro"]="181",f["&para"]="182",f["&middot"]="183",f["&cedil"]="184",f["&sup1"]="185",f["&ordm"]="186",f["&raquo"]="187",f["&frac14"]="188",f["&frac12"]="189",f["&frac34"]="190",f["&iquest"]="191",f["&Agrave"]="192",f["&Aacute"]="193",f["&Acirc"]="194",f["&Atilde"]="195",f["&Auml"]="196",f["&Aring"]="197",f["&AElig"]="198",f["&Ccedil"]="199",f["&Egrave"]="200",f["&Eacute"]="201",f["&Ecirc"]="202",f["&Euml"]="203",f["&Igrave"]="204",f["&Iacute"]="205",f["&Icirc"]="206",f["&Iuml"]="207",f["&ETH"]="208",f["&Ntilde"]="209",f["&Ograve"]="210",f["&Oacute"]="211",f["&Ocirc"]="212",f["&Otilde"]="213",f["&Ouml"]="214",f["&times"]="215",f["&Oslash"]="216",f["&Ugrave"]="217",f["&Uacute"]="218",f["&Ucirc"]="219",f["&Uuml"]="220",f["&Yacute"]="221",f["&THORN"]="222",f["&szlig"]="223",f["&agrave"]="224",f["&aacute"]="225",f["&acirc"]="226",f["&atilde"]="227",f["&auml"]="228",f["&aring"]="229",f["&aelig"]="230",f["&ccedil"]="231",f["&egrave"]="232",f["&eacute"]="233",f["&ecirc"]="234",f["&euml"]="235",f["&igrave"]="236",f["&iacute"]="237",f["&icirc"]="238",f["&iuml"]="239",f["&eth"]="240",f["&ntilde"]="241",f["&ograve"]="242",f["&oacute"]="243",f["&ocirc"]="244",f["&otilde"]="245",f["&ouml"]="246",f["&divide"]="247",f["&oslash"]="248",f["&ugrave"]="249",f["&uacute"]="250",f["&ucirc"]="251",f["&uuml"]="252",f["&yacute"]="253",f["&thorn"]="254",f["&yuml"]="255",f["&OElig"]="338",f["&oelig"]="339",f["&Scaron"]="352",f["&scaron"]="353",f["&Yuml"]="376",f["&fnof"]="402",f["&circ"]="710",f["&tilde"]="732",f["&Alpha"]="913",f["&Beta"]="914",f["&Gamma"]="915",f["&Delta"]="916",f["&Epsilon"]="917",f["&Zeta"]="918",f["&Eta"]="919",f["&Theta"]="920",f["&Iota"]="921",f["&Kappa"]="922",f["&Lambda"]="923",f["&Mu"]="924",f["&Nu"]="925",f["&Xi"]="926",f["&Omicron"]="927",f["&Pi"]="928",f["&Rho"]="929",f["&Sigma"]="931",f["&Tau"]="932",f["&Upsilon"]="933",f["&Phi"]="934",f["&Chi"]="935",f["&Psi"]="936",f["&Omega"]="937",f["&alpha"]="945",f["&beta"]="946",f["&gamma"]="947",f["&delta"]="948",f["&epsilon"]="949",f["&zeta"]="950",f["&eta"]="951",f["&theta"]="952",f["&iota"]="953",f["&kappa"]="954",f["&lambda"]="955",f["&mu"]="956",f["&nu"]="957",f["&xi"]="958",f["&omicron"]="959",f["&pi"]="960",f["&rho"]="961",f["&sigmaf"]="962",f["&sigma"]="963",f["&tau"]="964",f["&upsilon"]="965",f["&phi"]="966",f["&chi"]="967",f["&psi"]="968",f["&omega"]="969",f["&thetasym"]="977",f["&upsih"]="978",f["&piv"]="982",f["&ensp"]="8194",f["&emsp"]="8195",f["&thinsp"]="8201",f["&zwnj"]="8204",f["&zwj"]="8205",f["&lrm"]="8206",f["&rlm"]="8207",f["&ndash"]="8211",f["&mdash"]="8212",f["&lsquo"]="8216",f["&rsquo"]="8217",f["&sbquo"]="8218",f["&ldquo"]="8220",f["&rdquo"]="8221",f["&bdquo"]="8222",f["&dagger"]="8224",f["&Dagger"]="8225",f["&bull"]="8226",f["&hellip"]="8230",f["&permil"]="8240",f["&prime"]="8242",f["&Prime"]="8243",f["&lsaquo"]="8249",f["&rsaquo"]="8250",f["&oline"]="8254",f["&frasl"]="8260",f["&euro"]="8364",f["&image"]="8365",f["&weierp"]="8472",f["&real"]="8476",f["&trade"]="8482",f["&alefsym"]="8501",f["&larr"]="8592",f["&uarr"]="8593",f["&rarr"]="8594",f["&darr"]="8595",f["&harr"]="8596",f["&crarr"]="8629",f["&lArr"]="8656",f["&uArr"]="8657",f["&rArr"]="8658",f["&dArr"]="8659",f["&hArr"]="8660",f["&forall"]="8704",f["&part"]="8706",f["&exist"]="8707",f["&empty"]="8709",f["&nabla"]="8711",f["&isin"]="8712",f["&notin"]="8713",f["&ni"]="8715",f["&prod"]="8719",f["&sum"]="8721",f["&minus"]="8722",f["&lowast"]="8727",f["&radic"]="8730",f["&prop"]="8733",f["&infin"]="8734",f["&ang"]="8736",f["&and"]="8743",f["&or"]="8744",f["&cap"]="8745",f["&cup"]="8746",f["&int"]="8747",f["&there4"]="8756",f["&sim"]="8764",f["&cong"]="8773",f["&asymp"]="8776",f["&ne"]="8800",f["&equiv"]="8801",f["&le"]="8804",f["&ge"]="8805",f["&sub"]="8834",f["&sup"]="8835",f["&nsub"]="8836",f["&sube"]="8838",f["&supe"]="8839",f["&oplus"]="8853",f["&otimes"]="8855",f["&perp"]="8869",f["&sdot"]="8901",f["&lceil"]="8968",f["&rceil"]="8969",f["&lfloor"]="8970",f["&rfloor"]="8971",f["&lang"]="9001",f["&rang"]="9002",f["&loz"]="9674",f["&spades"]="9824",f["&clubs"]="9827",f["&hearts"]="9829",f["&diams"]="9830";for(var e in f)"function"!=typeof f[e]&&f.hasOwnProperty(e)&&(g[f[e]]=e);for(var t in g)if("function"!=typeof g[t]&&g.hasOwnProperty(t)){var n=g[t].toLowerCase().substr(1);m.put(n,String.fromCharCode(t))}}(),Object.freeze?(e.encoder=Object.freeze(e.encoder),e.fn.encode=Object.freeze(e.fn.encode)):Object.seal?(e.encoder=Object.seal(e.encoder),e.fn.encode=Object.seal(e.fn.encode)):Object.preventExtensions&&(e.encoder=Object.preventExtensions(e.encoder),e.fn.encode=Object.preventExtensions(e.fn.encode))}(jQuery),define("lib/jquery-encoder/jquery-encoder-0.1.0",["lib/jquery-encoder/libs/Class.create"],function(){}),define("scripts/components/common/util/jquery-encoder",["can","jquery","lib/jquery-encoder/jquery-encoder-0.1.0","scripts/components/common/util/lang"],function(e,t){var n=e.Construct.extend({encode:function(e){return t.isArray(e)?this.encodeArray(e):t.isPlainObject(e)?this.encodeObject(e):this.encodeSimpleValue(e)},doesNotRequireEncoding:function(e){return t.isBoolean(e)||t.isNumber(e)},encodeArray:function(e){var n=[],r=this;return t.each(e,function(e,t){n.push(r.encode(t))}),n},encodeObject:function(e){var n={},r=this;return t.each(e,function(e,t){n[e]=r.encode(t)}),n},encodeSimpleValue:function(e){return this.doesNotRequireEncoding(e)?e:t.encoder.encodeForHTML(e)}},{});return n}),define("lib/canjs/amd/can/control/plugin",["jquery","can/util/library","can/control"],function(e,t){var n,r=function(e,t){for(n=0;n<t.length;n++)if("string"==typeof t[n]?e.constructor._shortName==t[n]:e instanceof t[n])return!0;return!1},i=t.makeArray,a=t.Control.setup;return t.Control.setup=function(){if(this!==t.Control){var e=this.pluginName||this._fullName;"can_control"!==e&&this.plugin(e),a.apply(this,arguments)}},e.fn.extend({controls:function(){var e,n,a=i(arguments),o=[];return this.each(function(){if(e=t.$(this).data("controls"))for(var i=0;i<e.length;i++)n=e[i],(!a.length||r(n,a))&&o.push(n)}),o},control:function(){return this.controls.apply(this,arguments)[0]}}),t.Control.plugin=function(n){var r=this;e.fn[n]||(e.fn[n]=function(n){var a,o=i(arguments),s="string"==typeof n&&e.isFunction(r.prototype[n]),c=o[0];return this.each(function(){var e=t.$(this).control(r);e?s?a=e[c].apply(e,o.slice(1)):e.update.apply(e,o):r.newInstance.apply(r,[this].concat(o))}),void 0!==a?a:this})},t.Control.prototype.update=function(e){t.extend(this.options,e),this.on()},t}),define("scripts/anyware-widgets/base-widget/base-widget",["jquery","can","scripts/core/container/container","scripts/components/common/models/configuration-model","scripts/components/common/util/jquery-encoder","lib/canjs/amd/can/control/plugin","can-proxy"],function(e,t,n,r,i){var a=t.Control.extend({pluginName:"",appId:"",defaults:{clientId:"",countryCode:"",acceptedCreditCardTypes:[],languageCode:"",landscape:"prod",marketSegment:"COM",autoLoad:!0,autoRun:!0,tunnelPath:"",debug:!1,timeout:15e3,requiredOptions:["clientId","countryCode"]}},{eventObj:{},init:function(){this.initStateFlags(),this.processOptions(),this.loadConfig()},initStateFlags:function(){this.isComponentRunning=!1},processOptions:function(){this.setAdditionalOptions(),this.encodeOptions(),this.checkRequiredOptions(),this.enforceOptionFormatting()},encodeOptions:function(){this.options=i.encode(this.options)},checkRequiredOptions:function(){for(var e=0;e<this.options.requiredOptions.length;e++){var t=this.options.requiredOptions[e];if(this.options[t].length<1)throw new Error("Missing Required Option: "+t)}},enforceOptionFormatting:function(){this.options.countryCode=this.options.countryCode.toUpperCase(),this.options.languageCode=this.options.languageCode.toLowerCase()},setAdditionalOptions:function(){},loadConfig:function(){var e={landscape:this.options.landscape,appId:this.constructor.appId,clientId:this.options.clientId,countryCode:this.options.countryCode,marketSegment:this.options.marketSegment,isLocal:this.options.isLocal,debug:this.options.debug};this.configurationModel=new r(e),this.configurationModel.load(this,this.proxy("onConfigLoaded"),this.proxy("onConfigError"))},onConfigLoaded:function(){var e=this.configurationModel.attr();this.triggerEvent("configured",{configurationData:e}),this.options.autoLoad&&this.load()},onConfigError:function(e){this.configErrorOccurred=!0,this.triggerEvent("errorEvent",e)},load:function(){if(this.container)throw new Error("Load requested, but component is already loaded.");this.container=this.createContainer(),this.container.loadComponent(this.proxy("onComponentLoaded")),this.container.subscribe("**",this.proxy("globalHandler"))},loaded:function(){return this.isLoaded()},isLoaded:function(){var e=!1;return this.container&&(e=this.container.isConnected()),e},onComponentLoaded:function(){this.triggerEvent("loaded"),this.subscribeToHubEvents(),this.options.autoRun&&this.run()},createContainer:function(){var e=this.constructor.appId,t=this.element[0],r=this.configurationModel.attr("appUrl"),i=this.options.tunnelPath,a=this.options.iframeAttrs,o=this.options.timeout,s=new n(e,t,r,i,a,o);return this.setContainerListeners(),s},subscribe:function(e,t){this.eventObj[e]=this.eventObj[e]||[],this.eventObj[e].push(t)},globalHandler:function(t,n){var r=t.split("."),i=r[r.length-1];e.isArray(this.eventObj[i])?this.triggerSubscribe(i,n):this.triggerDefault(i,n)},triggerSubscribe:function(e,t){for(var n=this.eventObj[e],r=0;r<n.length;r++)"function"==typeof n[r]?n[r](e,t):this.triggerDefault(e,t)},triggerDefault:function(e,t){this.triggerEvent(e,t)},run:function(){if(this.isComponentRunning)throw new Error("Run requested, but component is already running.");this.isLoaded()&&this.initializeComponent()},isRunning:function(){return this.isComponentRunning},initializeComponent:function(){if(this.isLoaded()){var e=this.getComponentData();this.container.publish("initialize",e),this.isComponentRunning=!0}},getComponentData:function(){return{initOptions:this.options,configuration:this.configurationModel.attr()}},destroy:function(){this.isLoaded()&&this.container.unloadComponent(),t.Control.prototype.destroy.call(this)},unload:function(){this.isLoaded()&&(this.container.unloadComponent(),this.element.empty().trigger("unloaded"))},reload:function(){this.isLoaded()&&(this.container.unloadComponent(),this.container.loadComponent(this.proxy("componentReloaded")))},componentReloaded:function(){this.isComponentRunning&&(this.isComponentRunning=!1,this.run())},subscribeToHubEvents:function(){},setContainerListeners:function(){this.subscribe("formError",this.proxy("onFormError")),this.subscribe("validationError",this.proxy("onValidationError"))},onFormError:function(e,t){var n="FORM_ERROR";this.triggerEvent("errorEvent",{errorType:n,errors:t})},onValidationError:function(e,t){var n="VALIDATION_ERROR";this.triggerEvent("errorEvent",{errorType:n,errors:t})},triggerEvent:function(e,t){this.element&&this.element.trigger(e,t)},__getAppUrl:function(){return this.configurationModel.attr("appUrl")},__setAppUrl:function(e){this.configurationModel.attr("appUrl",e)}});return a}),define("can-super",["can/util/library","can/construct"],function(e){var t=e.isFunction,n=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;return e.Construct._overwrite=function(e,r,i,a){e[i]=t(a)&&t(r[i])&&n.test(a)?function(e,t){return function(){var n,i=this._super;return this._super=r[e],n=t.apply(this,arguments),this._super=i,n}}(i,a):a},e.Construct._inherit=function(t,n,r){r=r||t;for(var i in t)e.Construct._overwrite(r,n,i,t[i])},e}),define("tokenizer",["jquery","scripts/anyware-widgets/base-widget/base-widget","lib/canjs/amd/can/control/plugin","can-super"],function(e,t){var n=t.extend({pluginName:"anyware_payment_tokenizer",appId:"tokenizer"},{checkRequiredOptions:function(){this.options.requiredOptions.push("acceptedCreditCardTypes"),this._super()},setAddress:function(e){this.container.publish("setAddress",e)},getToken:function(){this.container.publish("getToken")},clearData:function(){this.container.publish("clearData")},subscribeToHubEvents:function(){var e=this;this.subscribe("tokenErrorReceived",function(t,n){e.onTokenErrorReceived(t,n)})},onTokenErrorReceived:function(t,n){n.errorType="TOKENIZATION_ERROR",e(this.element).trigger("errorEvent",n)}});return n}),define("can/util/string/deparam",["can/util/library","can/util/string"],function(e){var t=/^\d+$/,n=/([^\[\]]+)|(\[\])/g,r=/([^?#]*)(#.*)?$/,i=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return e.extend(e,{deparam:function(a){var o,s,c={};return a&&r.test(a)&&(o=a.split("&"),e.each(o,function(e){var r=e.split("="),a=i(r.shift()),o=i(r.join("=")),u=c;if(a){r=a.match(n);for(var l=0,h=r.length-1;h>l;l++)u[r[l]]||(u[r[l]]=t.test(r[l+1])||"[]"==r[l+1]?[]:{}),u=u[r[l]];s=r.pop(),"[]"==s?u.push(o):u[s]=o}})),c}}),e}),define("scripts/components/common/util/page-util",["jquery","can","can/util/string/deparam"],function(e,t){var n={getUrlParameter:function(e){for(var t,n=window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)if(t=r[i].split("="),t[0]===e)return t[1]},getUrlParameters:function(){var e=window.location.search.substring(1);return t.deparam(e)},addParamToUrl:function(e,t,n){var r,i,a,o;return e.indexOf(t+"=")>=0?(r=e.substring(0,e.indexOf(t)),i=e.substring(e.indexOf(t)),i=i.substring(i.indexOf("=")+1),i=i.indexOf("&")>=0?i.substring(i.indexOf("&")):"",e=r+t+"="+n+i):(a=e.split("#"),e=a[0],o=a[1]?"#"+a[1]:"",e+=e.indexOf("?")<0?"?":"&",e+=t+"="+n,e+=o),e},removeParamFromUrl:function(e,t){var n=this.getParamIndex(e,t);if(n>-1){var r,i,a=e.substring(0,n-1),o=e.substring(n),s=o.indexOf("&"),c=o.indexOf("#");s>-1?(r=e.charAt(n-1),i=s+1):c>-1&&(r="#",i=c+1),o=i?r+o.substring(i):"",e=a+o}return e},getParamIndex:function(e,t){var n=-1,r=["?","&","#"],i=e.indexOf(t+"="),a=(e.substring(i),e.charAt(i-1)),o=r.indexOf(a);return i>-1&&o>-1&&(n=i),n}};return n}),define("checkout",["jquery","can","scripts/anyware-widgets/base-widget/base-widget","scripts/components/common/util/page-util","lib/canjs/amd/can/control/plugin","scripts/components/common/util/lang","can-proxy","can-super"],function(e,t,n,r){var i=n.extend({pluginName:"anyware_checkout",appId:"checkout",ORDER_VALIDATED_EVENT:"orderValidated",ORDER_COMPLETED_EVENT:"orderCompleted",ORDER_STATUS_CHANGE_EVENT:"orderStatusChanged",PAYMENT_METHOD_SELECTED_EVENT:"paymentMethodSelected",READY_EVENT:"ready",ERROR_ORDER_NOT_VALIDATED:"Error! : Order Not In VALIDATED State!",UNIVERSAL_APP_PATH:"/anyware/latest/universal/checkout/index.html",UNIVERSAL_APP_PATH_LOCAL:"/app/universal/checkout/index.html"},{order:{},setAdditionalOptions:function(){var t,n;e.isValue(this.options.payPalReturnUrl)||(this.options.payPalReturnUrl=window.location.href),e.isValue(this.options.cartId)||(t=r.getUrlParameter("cartId"),e.isValue(t)&&(this.options.cartId=t)),n=r.getUrlParameter("paypal"),e.isValue(n)&&(this.options.paypal=n)},orderValid:function(){return void 0!==this.order&&"VALIDATED"===this.order.status},validateOrder:function(){this.orderValid()?this.orderValidated({},{order:this.order}):this.container.publish("validateOrder")},placeOrder:function(){if(!this.orderValid())throw new Error(this.constructor.ERROR_ORDER_NOT_VALIDATED);this.container.publish("placeOrder")},requiresRedirect:function(){var e=this.configurationModel.attr();return!!e.redirectRequired},getRedirectUrl:function(){return this.redirectUrl},setItems:function(e){this.options.items=e,this.options.cartId=null,this.isComponentRunning&&this.reload()},updatePayPalReturnUrl:function(e){this.options.payPalReturnUrl=e||window.location.href},subscribeToHubEvents:function(){this.subscribe("orderStatusChange",this.proxy("orderStatusChange")),this.subscribe("orderValidated",this.proxy("orderValidated")),this.subscribe("orderCompleted",this.proxy("orderCompleted")),this.subscribe("paymentMethodSelected",this.proxy("paymentMethodSelected")),this.subscribe("uiReady",this.proxy("uiReady")),this.subscribe("payPalFlowRequested",this.proxy("payPalFlowRequested"))},orderStatusChange:function(e,t){this.order=t.order,this.triggerEvent(this.constructor.ORDER_STATUS_CHANGE_EVENT,t)},orderValidated:function(e,t){this.order=t.order,this.triggerEvent(this.constructor.ORDER_VALIDATED_EVENT,t)},orderCompleted:function(e,t){this.order=t.order,this.triggerEvent(this.constructor.ORDER_COMPLETED_EVENT,t),this.unload()},paymentMethodSelected:function(e,t){this.order=t.order,this.triggerEvent(this.constructor.PAYMENT_METHOD_SELECTED_EVENT,t)},uiReady:function(){this.triggerEvent(this.constructor.READY_EVENT)},payPalFlowRequested:function(e,t){var n=t.redirectUrl;window.location.href=n},onConfigLoaded:function(){this.checkForRedirect(),this.checkForPendingUniversalRequest(),this._super()},load:function(){this.isEmbedded()?this._super():!this.isUniversalMode()&&this.options.autoRun&&this.run()},run:function(){this.requiresRedirect()?this.performRedirect():this._super()},isEmbedded:function(){return!this.requiresRedirect()&&!this.isUniversalMode()},checkForRedirect:function(){this.requiresRedirect()&&this.setRedirectUrl()},setRedirectUrl:function(){this.redirectOptions={marketSegment:this.getRedirectMarketSegment(),languageCode:this.getRedirectLanguageCode()};var e=this.configurationModel.attr(),t=e.redirectUrl,n=this.parseRedirectUrl(t);this.redirectUrl=this.processRedirectUrl(n)},parseRedirectUrl:function(t){if(e.isString(t))return t;for(var n in t)return this.parseRedirectUrl(t[n][this.redirectOptions[n]])},processRedirectUrl:function(e){var t=this.configurationModel.attr(),n=t.redirectVendor,r=this.options.items,i=e;if("DIGITAL_RIVER"===n){if(!r||1!==r.length)throw new Error("Item Not Found or More than One Item Found");var a=r[0].productKey;i=e.replace("<product_key>",a)}return i},getRedirectMarketSegment:function(){return this.options.marketSegment},getRedirectLanguageCode:function(){var e=this.configurationModel.attr(),t=this.options.languageCode,n=e.supportedLanguages,r=e.defaultLanguage;return this.isSupportedLanguage(t,n)||(t=r),t},isSupportedLanguage:function(n,r){var i=t.makeArray(r);return e.inArray(n,i)>-1},performRedirect:function(){var e=this.getRedirectUrl();this.options.autoRedirect?this.redirectToUrl(e):this.triggerEvent("redirectToCheckout",e)},redirectToUrl:function(e){window.location=e},isUniversalMode:function(){return!!this.options.universalMode},startUniversalCheckout:function(t){this.configErrorOccurred||(e.isValue(this.configurationModel)?this.performUniversalRedirect(t):this.savePendingUniversalRequest(t))},performUniversalRedirect:function(e){var t;this.requiresRedirect()?this.performRedirect():(t=this.assembleUniversalUrl(e),this.redirectToUrl(t))},checkForPendingUniversalRequest:function(){e.isValue(this.pendingUniversalRequest)&&this.startUniversalCheckout(this.pendingUniversalRequest.options)},savePendingUniversalRequest:function(e){this.pendingUniversalRequest={options:e}},assembleUniversalUrl:function(e){var t=this.getUrlParams(e),n=this.getBaseUrl()+this.getAppPath()+"?"+t;return n},getUrlParams:function(t){var n=this.getUniversalParams(t),r=["debug","autoLoad","autoRun","requiredOptions","autoRedirect","payPalReturnUrl","paypal","tunnelPath"];e.isValue(n.debug)&&n.debug&&(n.compress=!1);for(var i=0;i<r.length;i++){var a=r[i];e.isValue(n[a])&&delete n[a]}return e.param(n)},getUniversalParams:function(t){var n=e.extend(!0,{},this.options,t),r=this.getRedirectLanguageCode();return n.languageCode=r,n},getBaseUrl:function(){var e="",t=this.configurationModel.attr();return this.options.isLocal||(e=t.baseUrl[this.options.landscape]),e},getAppPath:function(){return this.options.isLocal?this.constructor.UNIVERSAL_APP_PATH_LOCAL:this.constructor.UNIVERSAL_APP_PATH}});return i}),define("scripts/anyware-widgets/price-display/price-display-controller",["jquery","can","scripts/anyware-widgets/base-widget/base-widget"],function(e,t,n){var r=n.extend({pluginName:"price_display_controller",appId:"priceDisplay",requiredOptions:[]},{getPrices:function(e){this.container.publish("getPrices",e)}});return r}),define("price-display",["jquery","can","scripts/anyware-widgets/price-display/price-display-controller","lib/canjs/amd/can/control/plugin","can-super","can-proxy"],function(e,t,n){var r=t.Control.extend({pluginName:"anyware_price_display",appId:"priceDisplay",defaults:{styles:{PRICE_TYPE_LABEL:"",FORMATTED_PRICE_CONTAINER:"",SUBSCRIPTION_TERM_LABEL:"",TAX_LABEL:"",ORIGINAL_PRICE:"EcommPrice_originalPrice",CURRENCY_SYMBOL:"cart-price-currency-symbol",INTEGER_PRICE_VALUE:"cart-price-dollar",DECIMAL_PRICE_VALUE:"cart-price-cent",INT_DELIMITER:"cart-price-integer-delimiter",DECIMAL_DELIMITER:"cart-price-decimal-delimiter",PRICE_STYLE:"CartCostWeak"}},widgetCount:0,numberOfWidgets:0,widgetsByMarketSegment:{COM:[],EDU:[]},mainControl:null,onConfigured:function(){},onApplicationReady:function(){var e=this.getPriceData();e.options=this.options,this.mainControl.getPrices(e)},onPriceLabelsReady:function(e,t){for(var n=this.widgetsByMarketSegment[t.marketSegment],r=t.priceLabelDivs,i=0;i<n.length;i++)n[i].element.append(r[i])},registerWidget:function(t,n){var r,i;this.numberOfWidgets||(this.numberOfWidgets=e(n).length),i=t.element.data().marketSegment||"COM",this.widgetsByMarketSegment[i.toUpperCase()].push(t),this.widgetCount++,this.mainControl||this.widgetCount!==this.numberOfWidgets||(r=t.options,this.createMainControl(r))},getPriceData:function(){var t,n,r={COM:[],EDU:[]},i=this;return e.each(this.widgetsByMarketSegment,function(a,o){for(var s=0;s<o.length;s++){var c=o[s];n=c.options,t=i.getWidgetData(c),r[a].push(e.extend(!0,{},n,t))}}),r},getWidgetData:function(t){var n=e.extend(!0,{},t.element.data());return n.controls=null,n},createMainControl:function(t){var r=e('<div id="price-display-controller" style="height:0px;width:0px"></div>');e("body").append(r),r.on("configured",e.proxy(this,"onConfigured")),r.on("applicationReady",e.proxy(this,"onApplicationReady")),r.on("priceLabelsReady",e.proxy(this,"onPriceLabelsReady")),this.mainControl=new n(r,t)},destroyMainController:function(){e("#price-display-controller").remove(),this.mainControl=null},unregisterWidget:function(e){var t=e.element.data().marketSegment||"COM",n=this.widgetsByMarketSegment[t.toUpperCase()];this.widgetCount--,this.numberOfWidgets--,n.splice(n.indexOf(e),1),0===this.numberOfWidgets&&this.destroyMainController()}},{init:function(){this.constructor.registerWidget(this,this.options.selector)},destroy:function(){this.constructor.unregisterWidget(this),this._super()}});return r}),require(["jquery","price-generator","tokenizer","checkout","price-display"],function(e,t){e.createNs("Adobe.Anyware"),Adobe.Anyware.PriceGenerator=t,e(document).trigger("anywareReady")}),define("scripts/anyware-widgets/anyware-widgets",function(){})}(),define("vendor/misc/anyware",function(){}),define("page_config",["jquery"],function(e){return JSON.parse(e("#js-page-config").text())}),define("lib/cookie",[],function(){return function(e,t,n){if("undefined"==typeof t){var r=null;if(document.cookie&&""!==document.cookie)for(var i=document.cookie.split(";"),a=0;a<i.length;a++){var o=i[a].trim();if(o.substring(0,e.length+1)===e+"="){r=decodeURIComponent(o.substring(e.length+1));break}}return r}n=n||{},null===t&&(t="",n.expires=-1);var s="";if(n.expires&&("number"==typeof n.expires||n.expires.toUTCString)){var c;"number"==typeof n.expires?(c=new Date,c.setTime(c.getTime()+24*n.expires*60*60*1e3)):c=n.expires,s="; expires="+c.toUTCString()}var u=n.path?"; path="+n.path:"",l=n.domain?"; domain="+n.domain:"",h=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),s,u,l,h].join("")}}),define("models/AssetLibrary",[],function(){var e=function(e){this.name=e.name,this.id=e.id,this.totalCount=e.num_elements};return e}),define("models/AssetLibraryItem",[],function(){var e=function(e,t,n){this.name=t.name,this.id=t.id,this.modified=t.modified,this.imageUrl=n,this.rendition=t.renditions[0],this.content_id=t.representations[0]["adobestock#trackingdata"].content_id,this.licensed="undefined"!=typeof t.representations[0]["adobestock#trackingdata"].license?t.representations[0]["adobestock#trackingdata"].license:!1,this.parentLibraryId=e,this.representations=t.representations};return e}),define("lib/libraries",["jquery","page_config","lib/cookie","models/AssetLibrary","models/AssetLibraryItem"],function(e,t,n,r,i){var a="iat0",o=n(a),s=t.libraries_service_url,c=t.libraries_use_stock_thumbnails,u=t.libraries_stock_base_url;
return e.ajaxSetup({headers:{"X-api-key":t.SUSI.CLIENT_ID,"X-Product":"AdobeStock/1.0",Authorization:"Bearer "+o}}),{getLibraries:function(){var n,r=this,i=e.Deferred();return e.ajax({url:s+"/libraries/",dataType:"json",headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){n=r.processLibraryData(e).libraries,i.resolve(n)},function(){i.reject()}),i},createLibrary:function(n){var i=e.Deferred(),a={name:n};return e.ajax({url:s+"/libraries",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(a),headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){i.resolve(new r(e))},function(){i.reject()}),i},deleteLibrary:function(n){var r=e.Deferred();return e.ajax({url:s+"/libraries/"+n+"?state=archive",type:"POST",contentType:"application/json",libraryId:n,headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(){r.resolve(n)},function(){r.reject()}),r},renameLibrary:function(n,r){var i=e.Deferred();return e.ajax({url:s+"/libraries/"+n+"?name="+encodeURIComponent(r),type:"POST",contentType:"application/json",libraryId:n,libraryName:r,headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){i.resolve(e)},function(){i.reject()}),i},getLibraryElements:function(n){var r=e.Deferred(),a=this;return e.ajax({url:s+"/libraries/"+n+"/elements?data_field=adobestock%23trackingdata",dataType:"json",headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){var t=e.elements.map(function(e){return new i(n,e,a.generateRenditionByHeight(e,240))});t.sort(function(e,t){return new Date(t.modified)-new Date(e.modified)}),r.resolve(t)},function(){r.reject()}),r},getLibraryThumbnails:function(t){var n=this,r=e.Deferred();return n.getLibraryElements(t).done(function(e){var i=null;e.length>0&&(i=n.generateLibraryThumbnails(e)),r.resolve(i,t)}).fail(function(){r.reject()}),r},libraryContains:function(n,r){var i=e.Deferred();return e.ajax({url:s+"/libraries/"+n+"/elements?data_field=adobestock%23trackingdata.content_id&data_value="+r,dataType:"json",headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){i.resolve(e.elements.length>0?e.elements[0]:null)},function(){i.reject()}),i},deleteLibraryElement:function(n,r){var i=e.Deferred();return e.ajax({url:s+"/libraries/"+n+"/elements/"+r,type:"DELETE",headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(){i.resolve(r)},function(){i.reject()}),i},analyticsLibraryElement:function(n,r){var i=e.Deferred();return e.ajax({url:s+"/libraries/analytics/useElement?libraryid="+n+"&elementid="+r,type:"POST",headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(){i.resolve(r)},function(){i.reject()}),i},addLibraryElement:function(n,r,i,a,o,c,u,l,h,d){var p=e.Deferred(),f=this;a=f.fixDevUrlForLibraries(a);var g={type:"application/vnd.adobe.element.image+dcx",name:u,representations:[{source:{href:a},rel:"primary",width:h,height:d,"adobestock#trackingdata":{content_id:String(r),stock_id:String(i)}}]};return null!=c?(g.representations[0]["adobestock#trackingdata"].license=c,g.representations[0]["adobestock#trackingdata"].state=o):g.representations[0]["adobestock#trackingdata"].state="not_purchased",null!=l&&(g.representations[0].type=l),e.ajax({url:s+"/libraries/"+n+"/elements?invocation_mode=async",type:"POST",contentType:"application/json",libraryId:n,data:JSON.stringify(g),headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){p.resolve(e)},function(){p.reject()}),p},updateElementInAllLibraries:function(n,r,i,a,o,c,u,l){var h=e.Deferred(),d=this;i=d.fixDevUrlForLibraries(i);var p={type:"application/vnd.adobe.element.image+dcx",representations:[{source:{href:i},rel:"primary",width:u,height:l,"adobestock#trackingdata":{content_id:String(n),stock_id:String(r)}}]};return null!=o?(p.representations[0]["adobestock#trackingdata"].license=o,p.representations[0]["adobestock#trackingdata"].state=a):p.representations[0]["adobestock#trackingdata"].state="not_purchased",null!=c&&(p.representations[0].type=c),e.ajax({url:s+"/libraries/elements?data_field=adobestock%23trackingdata.content_id&invocation_mode=async&data_value="+n,type:"POST",contentType:"application/json",data:JSON.stringify(p),headers:{"X-Request-Id":t.x_request_id+"-"+Date.now()}}).then(function(e){h.resolve(e)},function(){h.reject()}),h},useStockThumbnails:function(e){var t=null;if(c&&void 0!=e.representations&&void 0!=e.representations[0]&&void 0!=e.representations[0]["adobestock#trackingdata"].stock_id&&e.representations[0]["adobestock#trackingdata"].stock_id.length>=32){var n,r;n=-1==e.representations[0]["adobestock#trackingdata"].stock_id.indexOf(",")?e.representations[0]["adobestock#trackingdata"].stock_id.substr(0,32):e.representations[0]["adobestock#trackingdata"].stock_id.substr(0,e.representations[0]["adobestock#trackingdata"].stock_id.indexOf(",")),r=e.representations[0]["adobestock#trackingdata"].content_id;var i=Math.floor(Number(r)/100);i=String("00000000"+i).slice(-8),i=i.substr(0,2)+"/"+i.substr(2,2)+"/"+i.substr(4,2)+"/"+i.substr(6,2),t=u+"/jpg/"+i+"/240_F_"+r+"_"+n+".jpg"}return t},generateRenditionByHeight:function(e,n){var r=this,i=r.useStockThumbnails(e);if(null==i){var a=n;if(void 0!=e.renditions[0].height&&void 0!=e.renditions[0].width){var s=Number(e.renditions[0].height),c=Number(e.renditions[0].width);c>s&&(a=c*n/s,a=a.toFixed())}i=e.renditions[0].href.replace(/{size}/g,a)+"&api_key="+t.SUSI.CLIENT_ID+"&user_token="+o}return i},generateRenditionFill:function(e,n,r){var i=this,a=i.useStockThumbnails(e);if(null==a){var s=r;if(void 0!=e.rendition.height&&void 0!=e.rendition.width){var c=Number(e.rendition.height),u=Number(e.rendition.width),l=u/c,h=n/r;h>=1?s=h>=l&&l>=1?n:l>h&&l>=1?l*r:n/l:1>h&&(s=l>=h&&1>=l?r:l>h&&1>=l?l/n:r*l)}s=s.toFixed(),a=e.rendition.href.replace(/{size}/g,s)+"&api_key="+t.SUSI.CLIENT_ID+"&user_token="+o}return a},processLibraryData:function(e){var t=e.libraries.map(function(e){return new r(e)}),n={};return n.libraries=t,t.length>0&&(n.newestLibrary=t[t.length-1]),t.sort(function(e,t){return e.name.localeCompare(t.name)}),n},generateLibraryThumbnails:function(e){var t=this;return e.length>=4?[t.generateRenditionFill(e[0],280,266),t.generateRenditionFill(e[1],94,84),t.generateRenditionFill(e[2],94,84),t.generateRenditionFill(e[3],94,84)]:e.length>=3?[t.generateRenditionFill(e[0],280,175),t.generateRenditionFill(e[1],140,175),t.generateRenditionFill(e[2],140,175)]:e.length>=2?[t.generateRenditionFill(e[0],280,175),t.generateRenditionFill(e[1],280,175)]:e.length>=1?[t.generateRenditionFill(e[0],280,350)]:void 0},fixDevUrlForLibraries:function(t){if(-1!=t.indexOf(".loc")){var n=e("<a>",{href:t})[0];n.hostname="staging-astock1.fotolia.net",t=n.href}var r=t.split("/");return"Download"!==r[3]&&(r.splice(3,1),t=r.join("/")),t}}}),function(){function e(){return{keys:Object.keys||function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("keys() called on a non-object");var t,n=[];for(t in e)e.hasOwnProperty(t)&&(n[n.length]=t);return n},uniqueId:function(e){var t=++o+"";return e?e+t:t},has:function(e,t){return i.call(e,t)},each:function(e,t,n){if(null!=e)if(r&&e.forEach===r)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,a=e.length;a>i;i++)t.call(n,e[i],i,e);else for(var o in e)this.has(e,o)&&t.call(n,e[o],o,e)},once:function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}}}var t,n=this,r=Array.prototype.forEach,i=Object.prototype.hasOwnProperty,a=Array.prototype.slice,o=0,s=e();t={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var r=this,i=s.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,a,o,c,l,h,d;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(o=e?[e]:s.keys(this._events),c=0,l=o.length;l>c;c++)if(e=o[c],a=this._events[e]){if(this._events[e]=r=[],t||n)for(h=0,d=a.length;d>h;h++)i=a[h],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;"object"==typeof t&&(n=this),e&&((r={})[e._listenerId]=e);for(var a in r)r[a].off(t,n,this),i&&delete this._listeners[a];return this}};var c=/\s+/,u=function(e,t,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(c.test(n)){for(var a=n.split(c),o=0,s=a.length;s>o;o++)e[t].apply(e,[a[o]].concat(r));return!1}return!0},l=function(e,t){var n,r=-1,i=e.length,a=t[0],o=t[1],s=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,a);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,a,o);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,a,o,s);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(e,n){t[n]=function(t,n,r){var i=this._listeners||(this._listeners={}),a=t._listenerId||(t._listenerId=s.uniqueId("l"));return i[a]=t,"object"==typeof n&&(r=this),t[e](n,r,this),this}}),t.bind=t.on,t.unbind=t.off,t.mixin=function(e){var t=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return s.each(t,function(t){e[t]=this[t]},this),e},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.BackboneEvents=t):"function"==typeof define?define("vendor/backbone-events-standalone",[],function(){return t}):n.BackboneEvents=t}(this),define("lib/uiEvents",["vendor/backbone-events-standalone"],function(e){return e.mixin({LIBRARIES_UPDATED:"librariesUpdated",DEFAULT_LIBRARY_UPDATED:"defaultLibraryUpdated",ENTITLEMENT_UPDATED:"entitlementUpdated",MEMBER_LOGGED_IN:"memberLoggedIn",ASSET_LICENSED:"assetLicensed"})}),define("lib/member",["lib/uiEvents","page_config"],function(e,t){return{_imsProfile:null,_stockProfile:null,setImsProfile:function(t){this._imsProfile=t,this._imsProfile&&e.trigger(e.MEMBER_LOGGED_IN)},setStockProfile:function(e){this._stockProfile=e},getCountryCode:function(){return this._imsProfile?this._imsProfile.countryCode:t.default_country_code?t.default_country_code:"US"},isLoggedIn:function(){return null!==this._imsProfile},isCCE:function(){return"type1"!=this._imsProfile.account_type},getDefaultEntitlement:function(){return this._stockProfile?this._stockProfile.default_entitlement:null},getMemberId:function(){return this._stockProfile?this._stockProfile.member_id:null},updateDefaultEntitlement:function(t){this._stockProfile.default_entitlement=t,e.trigger(e.ENTITLEMENT_UPDATED)},consumeDefaultEntitlementLicense:function(){this._stockProfile.default_entitlement&&this._stockProfile.default_entitlement.total_available_downloads>0&&(this._stockProfile.default_entitlement.total_available_downloads-=1,e.trigger(e.ENTITLEMENT_UPDATED))},getUsername:function(){return username=null,this._imsProfile&&(username=this._stockProfile&&this._stockProfile.default_entitlement&&this._stockProfile.default_entitlement.guid?this._stockProfile.default_entitlement.label:"JP"==this._imsProfile.countryCode?this._imsProfile.last_name+"さん":this._imsProfile.first_name),username}}}),function(e,t){function n(e){return h.PF.compile(e||"nplurals=2; plural=(n != 1);")}function r(e,t){this._key=e,this._i18n=t}var i=Array.prototype,a=Object.prototype,o=i.slice,s=a.hasOwnProperty,c=i.forEach,u={},l={forEach:function(e,t,n){var r,i,a;if(null!==e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(r=0,i=e.length;i>r;r++)if(r in e&&t.call(n,e[r],r,e)===u)return}else for(a in e)if(s.call(e,a)&&t.call(n,e[a],a,e)===u)return},extend:function(e){return this.forEach(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e}},h=function(e){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages",debug:!1},this.options=l.extend({},this.defaults,e),this.textdomain(this.options.domain),e.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+e.domain+"`")};h.context_delimiter=String.fromCharCode(4),l.extend(r.prototype,{onDomain:function(e){return this._domain=e,this},withContext:function(e){return this._context=e,this},ifPlural:function(e,t){return this._val=e,this._pkey=t,this},fetch:function(e){return"[object Array]"!={}.toString.call(e)&&(e=[].slice.call(arguments,0)),(e&&e.length?h.sprintf:function(e){return e})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),e)}}),l.extend(h.prototype,{translate:function(e){return new r(e,this)},textdomain:function(e){return e?void(this._textdomain=e):this._textdomain},gettext:function(e){return this.dcnpgettext.call(this,t,t,e)},dgettext:function(e,n){return this.dcnpgettext.call(this,e,t,n)},dcgettext:function(e,n){return this.dcnpgettext.call(this,e,t,n)},ngettext:function(e,n,r){return this.dcnpgettext.call(this,t,t,e,n,r)},dngettext:function(e,n,r,i){return this.dcnpgettext.call(this,e,t,n,r,i)},dcngettext:function(e,n,r,i){return this.dcnpgettext.call(this,e,t,n,r,i)},pgettext:function(e,n){return this.dcnpgettext.call(this,t,e,n)},dpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},dcpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},npgettext:function(e,n,r,i){return this.dcnpgettext.call(this,t,e,n,r,i)},dnpgettext:function(e,t,n,r,i){return this.dcnpgettext.call(this,e,t,n,r,i)},dcnpgettext:function(e,t,r,i,a){i=i||r,e=e||this._textdomain;var o;if(!this.options)return o=new h,o.dcnpgettext.call(o,void 0,void 0,r,i,a);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[e])throw new Error("Domain `"+e+"` was not found.");if(!this.options.locale_data[e][""])throw new Error("No locale meta information provided.");if(!r)throw new Error("No translation key found.");var s,c,u,l=t?t+h.context_delimiter+r:r,d=this.options.locale_data,p=d[e],f=(d.messages||this.defaults.locale_data.messages)[""],g=p[""].plural_forms||p[""]["Plural-Forms"]||p[""]["plural-forms"]||f.plural_forms||f["Plural-Forms"]||f["plural-forms"];if(void 0===a)u=0;else{if("number"!=typeof a&&(a=parseInt(a,10),isNaN(a)))throw new Error("The number that was passed in is not a number.");u=n(g)(a)}if(!p)throw new Error("No domain named `"+e+"` could be found.");return s=p[l],!s||u>s.length?(this.options.missing_key_callback&&this.options.missing_key_callback(l,e),c=[r,i],this.options.debug===!0,c[n()(a)]):(c=s[u],c?c:(c=[r,i],c[n()(a)]))}});var d=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){var i,a,o,s,c,u,l,h=1,p=n.length,f="",g=[];for(a=0;p>a;a++)if(f=e(n[a]),"string"===f)g.push(n[a]);else if("array"===f){if(s=n[a],s[2])for(i=r[h],o=0;o<s[2].length;o++){if(!i.hasOwnProperty(s[2][o]))throw d('[sprintf] property "%s" does not exist',s[2][o]);i=i[s[2][o]]}else i=s[1]?r[s[1]]:r[h++];if(/[^s]/.test(s[8])&&"number"!=e(i))throw d("[sprintf] expecting number but found %s",e(i));switch(("undefined"==typeof i||null===i)&&(i=""),s[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=s[7]?i.toExponential(s[7]):i.toExponential();break;case"f":i=s[7]?parseFloat(i).toFixed(s[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&s[7]?i.substring(0,s[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(s[8])&&s[3]&&i>=0?"+"+i:i,u=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",l=s[6]-String(i).length,c=s[6]?t(u,l):"",g.push(s[5]?i+c:c+i)}return g.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){i|=1;var a=[],o=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(o)))throw"[sprintf] huh?";for(a.push(s[1]);""!==(o=o.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(o)))a.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(o)))throw"[sprintf] huh?";a.push(s[1])}n[2]=a}else i|=2;if(3===i)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},n}(),p=function(e,t){return t.unshift(e),d.apply(null,t)};h.parse_plural=function(e,t){return e=e.replace(/n/g,t),h.parse_expression(e)},h.sprintf=function(e,t){return"[object Array]"=={}.toString.call(t)?p(e,[].slice.call(t)):d.apply(this,[].slice.call(arguments))},h.prototype.sprintf=function(){return h.sprintf.apply(this,arguments)},h.PF={},h.PF.parse=function(e){var t=h.PF.extractPluralExpr(e);return h.PF.parser.parse.call(h.PF.parser,t)},h.PF.compile=function(e){function t(e){return e===!0?1:e?e:0}var n=h.PF.parse(e);return function(e){return t(h.PF.interpreter(n)(e))}},h.PF.interpreter=function(e){return function(t){switch(e.type){case"GROUP":return h.PF.interpreter(e.expr)(t);case"TERNARY":return h.PF.interpreter(e.expr)(t)?h.PF.interpreter(e.truthy)(t):h.PF.interpreter(e.falsey)(t);case"OR":return h.PF.interpreter(e.left)(t)||h.PF.interpreter(e.right)(t);case"AND":return h.PF.interpreter(e.left)(t)&&h.PF.interpreter(e.right)(t);case"LT":return h.PF.interpreter(e.left)(t)<h.PF.interpreter(e.right)(t);case"GT":return h.PF.interpreter(e.left)(t)>h.PF.interpreter(e.right)(t);case"LTE":return h.PF.interpreter(e.left)(t)<=h.PF.interpreter(e.right)(t);case"GTE":return h.PF.interpreter(e.left)(t)>=h.PF.interpreter(e.right)(t);case"EQ":return h.PF.interpreter(e.left)(t)==h.PF.interpreter(e.right)(t);case"NEQ":return h.PF.interpreter(e.left)(t)!=h.PF.interpreter(e.right)(t);case"MOD":return h.PF.interpreter(e.left)(t)%h.PF.interpreter(e.right)(t);case"VAR":return t;case"NUM":return e.val;default:throw new Error("Invalid Token found.")}}},h.PF.extractPluralExpr=function(e){e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(e)||(e=e.concat(";"));var t,n=/nplurals\=(\d+);/,r=/plural\=(.*);/,i=e.match(n),a={};if(!(i.length>1))throw new Error("nplurals not found in plural_forms string: "+e);if(a.nplurals=i[1],e=e.replace(n,""),t=e.match(r),!(t&&t.length>1))throw new Error("`plural` expression not found: "+e);return t[1]},h.PF.parser=function(){var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(e,t,n,r,i,a){var o=a.length-1;switch(i){case 1:return{type:"GROUP",expr:a[o-1]};case 2:this.$={type:"TERNARY",expr:a[o-4],truthy:a[o-2],falsey:a[o]};break;case 3:this.$={type:"OR",left:a[o-2],right:a[o]};break;case 4:this.$={type:"AND",left:a[o-2],right:a[o]};break;case 5:this.$={type:"LT",left:a[o-2],right:a[o]};break;case 6:this.$={type:"LTE",left:a[o-2],right:a[o]};break;case 7:this.$={type:"GT",left:a[o-2],right:a[o]};break;case 8:this.$={type:"GTE",left:a[o-2],right:a[o]};break;case 9:this.$={type:"NEQ",left:a[o-2],right:a[o]};break;case 10:this.$={type:"EQ",left:a[o-2],right:a[o]};break;case 11:this.$={type:"MOD",left:a[o-2],right:a[o]};break;case 12:this.$={type:"GROUP",expr:a[o-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(e)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(e){throw new Error(e)},parse:function(e){function t(e){i.length=i.length-2*e,a.length=a.length-e,o.length=o.length-e}function n(){var e;return e=r.lexer.lex()||1,"number"!=typeof e&&(e=r.symbols_[e]||e),e}var r=this,i=[0],a=[null],o=[],s=this.table,c="",u=0,l=0,h=0,d=2,p=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;o.push(f),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var g,m,b,v,y,_,x,w,E,C={};;){if(b=i[i.length-1],this.defaultActions[b]?v=this.defaultActions[b]:(null==g&&(g=n()),v=s[b]&&s[b][g]),"undefined"==typeof v||!v.length||!v[0]){if(!h){E=[];for(_ in s[b])this.terminals_[_]&&_>2&&E.push("'"+this.terminals_[_]+"'");var k="";k=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+E.join(", ")+", got '"+this.terminals_[g]+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:f,expected:E})}if(3==h){if(g==p)throw new Error(k||"Parsing halted.");l=this.lexer.yyleng,c=this.lexer.yytext,u=this.lexer.yylineno,f=this.lexer.yylloc,g=n()}for(;;){if(d.toString()in s[b])break;if(0==b)throw new Error(k||"Parsing halted.");t(1),b=i[i.length-1]}m=g,g=d,b=i[i.length-1],v=s[b]&&s[b][d],h=3}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(v[0]){case 1:i.push(g),a.push(this.lexer.yytext),o.push(this.lexer.yylloc),i.push(v[1]),g=null,m?(g=m,m=null):(l=this.lexer.yyleng,c=this.lexer.yytext,u=this.lexer.yylineno,f=this.lexer.yylloc,h>0&&h--);break;case 2:if(x=this.productions_[v[1]][1],C.$=a[a.length-x],C._$={first_line:o[o.length-(x||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(x||1)].first_column,last_column:o[o.length-1].last_column},y=this.performAction.call(C,c,l,u,this.yy,v[1],a,o),"undefined"!=typeof y)return y;x&&(i=i.slice(0,-1*x*2),a=a.slice(0,-1*x),o=o.slice(0,-1*x)),i.push(this.productions_[v[1]][0]),a.push(C.$),o.push(C._$),w=s[i[i.length-2]][i[i.length-1]],i.push(w);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parseError)throw new Error(e);this.yy.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e;var t=e.match(/\n/);return t&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),i=0;i<r.length;i++)if(t=this._input.match(this.rules[r[i]]))return n=t[0].match(/\n.*/g),n&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-1:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,r[i],this.conditionStack[this.conditionStack.length-1]),e?e:void 0;return""===this._input?this.EOF:void this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.performAction=function(e,t,n,r){switch(n){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},e.rules=[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],e.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}},e}();return e.lexer=t,e}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.Jed=h):("function"==typeof define&&define.amd&&define("i18n",[],function(){return h}),e.Jed=h)}(this),function(e,t){"function"==typeof define&&define.amd?define("Handlebars",[],t):"object"==typeof exports?module.exports=t():e.Handlebars=t()}(this,function(){var e=function(){function e(e){return c[e]}function t(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function n(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}function r(t){return t&&t.toHTML?t.toHTML():null==t?"":t?(t=""+t,l.test(t)?t.replace(u,e):t):t+""}function i(e){return e||0===e?p(e)&&0===e.length?!0:!1:!0}function a(e,t){return e.path=t,e}function o(e,t){return(e?e+".":"")+t}var s={},c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,l=/[&<>"'`]/;s.extend=t;var h=Object.prototype.toString;s.toString=h;var d=function(e){return"function"==typeof e};d(/x/)&&(d=function(e){return"function"==typeof e&&"[object Function]"===h.call(e)});var d;s.isFunction=d;var p=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===h.call(e):!1};return s.isArray=p,s.indexOf=n,s.escapeExpression=r,s.isEmpty=i,s.blockParams=a,s.appendContextPath=o,s}(),t=function(){function e(e,t){var r,i,a=t&&t.loc;a&&(r=a.start.line,i=a.start.column,e+=" - "+r+":"+i);for(var o=Error.prototype.constructor.call(this,e),s=0;s<n.length;s++)this[n[s]]=o[n[s]];a&&(this.lineNumber=r,this.column=i)}var t,n=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e}(),n=function(e,t){function n(e,t){this.helpers=e||{},this.partials=t||{},r(this)}function r(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new o("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var r=n.inverse,i=n.fn;if(t===!0)return i(this);if(t===!1||null==t)return r(this);if(l(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):r(this);if(n.data&&n.ids){var o=m(n.data);o.contextPath=a.appendContextPath(n.data.contextPath,n.name),n={data:o}}return i(t,n)}),e.registerHelper("each",function(e,t){function n(t,n,o){r&&(r.key=t,r.index=n,r.first=0===n,r.last=!!o,i&&(r.contextPath=i+t)),d+=s(e[t],{data:r,blockParams:a.blockParams([e[t],t],[i+t,null])})}if(!t)throw new o("Must pass iterator to #each");var r,i,s=t.fn,c=t.inverse,u=0,d="";if(t.data&&t.ids&&(i=a.appendContextPath(t.data.contextPath,t.ids[0])+"."),h(e)&&(e=e.call(this)),t.data&&(r=m(t.data)),e&&"object"==typeof e)if(l(e))for(var p=e.length;p>u;u++)n(u,u,u===e.length-1);else{var f;for(var g in e)e.hasOwnProperty(g)&&(f&&n(f,u-1),f=g,u++);f&&n(f,u-1,!0)}return 0===u&&(d=c(this)),d}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||a.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){h(e)&&(e=e.call(this));var n=t.fn;if(a.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var r=m(t.data);r.contextPath=a.appendContextPath(t.data.contextPath,t.ids[0]),t={data:r}}return n(e,t)}),e.registerHelper("log",function(t,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(r,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var i={},a=e,o=t,s="3.0.0";i.VERSION=s;var c=6;i.COMPILER_REVISION=c;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};i.REVISION_CHANGES=u;var l=a.isArray,h=a.isFunction,d=a.toString,p="[object Object]";i.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:f,log:g,registerHelper:function(e,t){if(d.call(e)===p){if(t)throw new o("Arg not supported with multiple helpers");
a.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(d.call(e)===p)a.extend(this.partials,e);else{if("undefined"==typeof t)throw new o("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var f={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&f.level<=e){var n=f.methodMap[e];(console[n]||console.log).call(console,t)}}};i.logger=f;var g=f.log;i.log=g;var m=function(e){var t=a.extend({},e);return t._parent=e,t};return i.createFrame=m,i}(e,t),r=function(){function e(e){this.string=e}var t;return e.prototype.toString=e.prototype.toHTML=function(){return""+this.string},t=e}(),i=function(e,t,n){function r(e){var t=e&&e[0]||1,n=p;if(t!==n){if(n>t){var r=f[n],i=f[t];throw new d("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new d("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function i(e,t){if(!t)throw new d("No environment passed to template");if(!e||!e.main)throw new d("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,r,i){i.hash&&(r=h.extend({},r,i.hash)),n=t.VM.resolvePartial.call(this,n,r,i);var a=t.VM.invokePartial.call(this,n,r,i);if(null==a&&t.compile&&(i.partials[i.name]=t.compile(n,e.compilerOptions,t),a=i.partials[i.name](r,i)),null!=a){if(i.indent){for(var o=a.split("\n"),s=0,c=o.length;c>s&&(o[s]||s+1!==c);s++)o[s]=i.indent+o[s];a=o.join("\n")}return a}throw new d("The partial "+i.name+" could not be compiled when running in runtime-only mode")},r={strict:function(e,t){if(!(t in e))throw new d('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,r=0;n>r;r++)if(e[r]&&null!=e[r][t])return e[r][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n,r,i){var o=this.programs[e],s=this.fn(e);return t||i||r||n?o=a(this,e,s,t,n,r,i):o||(o=this.programs[e]=a(this,e,s)),o},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=h.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},i=function(t,n){n=n||{};var a=n.data;i._setup(n),!n.partial&&e.useData&&(a=u(t,a));var o,s=e.useBlockParams?[]:void 0;return e.useDepths&&(o=n.depths?[t].concat(n.depths):[t]),e.main.call(r,t,r.helpers,r.partials,a,s,o)};return i.isTop=!0,i._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,t.helpers),e.usePartial&&(r.partials=r.merge(n.partials,t.partials)))},i._child=function(t,n,i,o){if(e.useBlockParams&&!i)throw new d("must pass block params");if(e.useDepths&&!o)throw new d("must pass parent depths");return a(r,t,e[t],n,0,i,o)},i}function a(e,t,n,r,i,a,o){var s=function(t,i){return i=i||{},n.call(e,t,e.helpers,e.partials,i.data||r,a&&[i.blockParams].concat(a),o&&[t].concat(o))};return s.program=t,s.depth=o?o.length:0,s.blockParams=i||0,s}function o(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e=n.partials[n.name],e}function s(e,t,n){if(n.partial=!0,void 0===e)throw new d("The partial "+n.name+" could not be found");return e instanceof Function?e(t,n):void 0}function c(){return""}function u(e,t){return t&&"root"in t||(t=t?g(t):{},t.root=e),t}var l={},h=e,d=t,p=n.COMPILER_REVISION,f=n.REVISION_CHANGES,g=n.createFrame;return l.checkRevision=r,l.template=i,l.program=a,l.resolvePartial=o,l.invokePartial=s,l.noop=c,l}(e,t,n),a=function(e,t,n,r,i){var a,o=e,s=t,c=n,u=r,l=i,h=function(){var e=new o.HandlebarsEnvironment;return u.extend(e,o),e.SafeString=s,e.Exception=c,e.Utils=u,e.escapeExpression=u.escapeExpression,e.VM=l,e.template=function(t){return l.template(t,e)},e},d=h();d.create=h;var p="undefined"!=typeof global?global:window,f=p.Handlebars;return d.noConflict=function(){p.Handlebars===d&&(p.Handlebars=f)},d["default"]=d,a=d}(n,r,t,e,i),o=function(){var e,t={Program:function(e,t,n,r){this.loc=r,this.type="Program",this.body=e,this.blockParams=t,this.strip=n},MustacheStatement:function(e,t,n,r,i,a){this.loc=a,this.type="MustacheStatement",this.path=e,this.params=t||[],this.hash=n,this.escaped=r,this.strip=i},BlockStatement:function(e,t,n,r,i,a,o,s,c){this.loc=c,this.type="BlockStatement",this.path=e,this.params=t||[],this.hash=n,this.program=r,this.inverse=i,this.openStrip=a,this.inverseStrip=o,this.closeStrip=s},PartialStatement:function(e,t,n,r,i){this.loc=i,this.type="PartialStatement",this.name=e,this.params=t||[],this.hash=n,this.indent="",this.strip=r},ContentStatement:function(e,t){this.loc=t,this.type="ContentStatement",this.original=this.value=e},CommentStatement:function(e,t,n){this.loc=n,this.type="CommentStatement",this.value=e,this.strip=t},SubExpression:function(e,t,n,r){this.loc=r,this.type="SubExpression",this.path=e,this.params=t||[],this.hash=n},PathExpression:function(e,t,n,r,i){this.loc=i,this.type="PathExpression",this.data=e,this.original=r,this.parts=n,this.depth=t},StringLiteral:function(e,t){this.loc=t,this.type="StringLiteral",this.original=this.value=e},NumberLiteral:function(e,t){this.loc=t,this.type="NumberLiteral",this.original=this.value=Number(e)},BooleanLiteral:function(e,t){this.loc=t,this.type="BooleanLiteral",this.original=this.value="true"===e},Hash:function(e,t){this.loc=t,this.type="Hash",this.pairs=e},HashPair:function(e,t,n){this.loc=n,this.type="HashPair",this.key=e,this.value=t},helpers:{helperExpression:function(e){return!("SubExpression"!==e.type&&!e.params.length&&!e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!t.helpers.scopedId(e)&&!e.depth}}};return e=t}(),s=function(){var e,t=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,DATA:77,pathSegments:78,SEP:79,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"DATA",79:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[78,3],[78,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(e,t,n,r,i,a){var o=a.length-1;switch(i){case 1:return a[o-1];case 2:this.$=new r.Program(a[o],null,{},r.locInfo(this._$));break;case 3:this.$=a[o];break;case 4:this.$=a[o];break;case 5:this.$=a[o];break;case 6:this.$=a[o];break;case 7:this.$=a[o];break;case 8:this.$=new r.CommentStatement(r.stripComment(a[o]),r.stripFlags(a[o],a[o]),r.locInfo(this._$));break;case 9:this.$=new r.ContentStatement(a[o],r.locInfo(this._$));break;case 10:this.$=r.prepareRawBlock(a[o-2],a[o-1],a[o],this._$);break;case 11:this.$={path:a[o-3],params:a[o-2],hash:a[o-1]};break;case 12:this.$=r.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!1,this._$);break;case 13:this.$=r.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!0,this._$);break;case 14:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:r.stripFlags(a[o-5],a[o])};break;case 15:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:r.stripFlags(a[o-5],a[o])};break;case 16:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:r.stripFlags(a[o-5],a[o])};break;case 17:this.$={strip:r.stripFlags(a[o-1],a[o-1]),program:a[o]};break;case 18:var s=r.prepareBlock(a[o-2],a[o-1],a[o],a[o],!1,this._$),c=new r.Program([s],null,{},r.locInfo(this._$));c.chained=!0,this.$={strip:a[o-2].strip,program:c,chain:!0};break;case 19:this.$=a[o];break;case 20:this.$={path:a[o-1],strip:r.stripFlags(a[o-2],a[o])};break;case 21:this.$=r.prepareMustache(a[o-3],a[o-2],a[o-1],a[o-4],r.stripFlags(a[o-4],a[o]),this._$);break;case 22:this.$=r.prepareMustache(a[o-3],a[o-2],a[o-1],a[o-4],r.stripFlags(a[o-4],a[o]),this._$);break;case 23:this.$=new r.PartialStatement(a[o-3],a[o-2],a[o-1],r.stripFlags(a[o-4],a[o]),r.locInfo(this._$));break;case 24:this.$=a[o];break;case 25:this.$=a[o];break;case 26:this.$=new r.SubExpression(a[o-3],a[o-2],a[o-1],r.locInfo(this._$));break;case 27:this.$=new r.Hash(a[o],r.locInfo(this._$));break;case 28:this.$=new r.HashPair(a[o-2],a[o],r.locInfo(this._$));break;case 29:this.$=a[o-1];break;case 30:this.$=a[o];break;case 31:this.$=a[o];break;case 32:this.$=new r.StringLiteral(a[o],r.locInfo(this._$));break;case 33:this.$=new r.NumberLiteral(a[o],r.locInfo(this._$));break;case 34:this.$=new r.BooleanLiteral(a[o],r.locInfo(this._$));break;case 35:this.$=a[o];break;case 36:this.$=a[o];break;case 37:this.$=r.preparePath(!0,a[o],this._$);break;case 38:this.$=r.preparePath(!1,a[o],this._$);break;case 39:a[o-2].push({part:a[o],separator:a[o-1]}),this.$=a[o-2];break;case 40:this.$=[{part:a[o]}];break;case 41:this.$=[];break;case 42:a[o-1].push(a[o]);break;case 43:this.$=[];break;case 44:a[o-1].push(a[o]);break;case 51:this.$=[];break;case 52:a[o-1].push(a[o]);break;case 57:this.$=[];break;case 58:a[o-1].push(a[o]);break;case 63:this.$=[];break;case 64:a[o-1].push(a[o]);break;case 71:this.$=[];break;case 72:a[o-1].push(a[o]);break;case 75:this.$=[];break;case 76:a[o-1].push(a[o]);break;case 79:this.$=[];break;case 80:a[o-1].push(a[o]);break;case 83:this.$=[];break;case 84:a[o-1].push(a[o]);break;case 87:this.$=[a[o]];break;case 88:a[o-1].push(a[o]);break;case 89:this.$=[a[o]];break;case 90:a[o-1].push(a[o])}},table:[{3:1,4:2,5:[2,41],6:3,13:[2,41],14:[2,41],17:[2,41],27:[2,41],32:[2,41],46:[2,41],49:[2,41],53:[2,41]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,42],13:[2,42],14:[2,42],17:[2,42],27:[2,42],32:[2,42],37:[2,42],42:[2,42],45:[2,42],46:[2,42],49:[2,42],53:[2,42]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{18:31,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{4:32,6:3,13:[2,41],14:[2,41],17:[2,41],27:[2,41],32:[2,41],37:[2,41],42:[2,41],45:[2,41],46:[2,41],49:[2,41],53:[2,41]},{4:33,6:3,13:[2,41],14:[2,41],17:[2,41],27:[2,41],32:[2,41],42:[2,41],45:[2,41],46:[2,41],49:[2,41],53:[2,41]},{12:34,14:[1,18]},{18:36,54:35,58:37,59:[1,38],66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:39,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{18:40,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{18:41,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{31:[2,71],47:42,59:[2,71],66:[2,71],74:[2,71],75:[2,71],76:[2,71],77:[2,71]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34]},{21:[2,38],31:[2,38],52:[2,38],59:[2,38],62:[2,38],66:[2,38],69:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],79:[1,43]},{66:[1,30],78:44},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],79:[2,40]},{50:45,52:[2,75],59:[2,75],66:[2,75],74:[2,75],75:[2,75],76:[2,75],77:[2,75]},{23:46,36:48,37:[1,50],41:49,42:[1,51],43:47,45:[2,47]},{26:52,41:53,42:[1,51],45:[2,49]},{16:[1,54]},{31:[2,79],55:55,59:[2,79],66:[2,79],74:[2,79],75:[2,79],76:[2,79],77:[2,79]},{31:[2,35],59:[2,35],66:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35]},{31:[2,36],59:[2,36],66:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36]},{18:56,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{28:57,31:[2,51],59:[2,51],66:[2,51],69:[2,51],74:[2,51],75:[2,51],76:[2,51],77:[2,51]},{31:[2,57],33:58,59:[2,57],66:[2,57],69:[2,57],74:[2,57],75:[2,57],76:[2,57],77:[2,57]},{19:59,21:[2,43],59:[2,43],66:[2,43],74:[2,43],75:[2,43],76:[2,43],77:[2,43]},{18:63,31:[2,73],48:60,57:61,58:64,59:[1,38],63:62,64:65,65:66,66:[1,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{66:[1,68]},{21:[2,37],31:[2,37],52:[2,37],59:[2,37],62:[2,37],66:[2,37],69:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],79:[1,43]},{18:63,51:69,52:[2,77],57:70,58:64,59:[1,38],63:71,64:65,65:66,66:[1,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{24:72,45:[1,73]},{45:[2,48]},{4:74,6:3,13:[2,41],14:[2,41],17:[2,41],27:[2,41],32:[2,41],37:[2,41],42:[2,41],45:[2,41],46:[2,41],49:[2,41],53:[2,41]},{45:[2,19]},{18:75,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{4:76,6:3,13:[2,41],14:[2,41],17:[2,41],27:[2,41],32:[2,41],45:[2,41],46:[2,41],49:[2,41],53:[2,41]},{24:77,45:[1,73]},{45:[2,50]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:63,31:[2,81],56:78,57:79,58:64,59:[1,38],63:80,64:65,65:66,66:[1,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{59:[2,83],60:81,62:[2,83],66:[2,83],74:[2,83],75:[2,83],76:[2,83],77:[2,83]},{18:63,29:82,31:[2,53],57:83,58:64,59:[1,38],63:84,64:65,65:66,66:[1,67],69:[2,53],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{18:63,31:[2,59],34:85,57:86,58:64,59:[1,38],63:87,64:65,65:66,66:[1,67],69:[2,59],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{18:63,20:88,21:[2,45],57:89,58:64,59:[1,38],63:90,64:65,65:66,66:[1,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{31:[1,91]},{31:[2,72],59:[2,72],66:[2,72],74:[2,72],75:[2,72],76:[2,72],77:[2,72]},{31:[2,74]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:92,66:[1,93],69:[2,27]},{21:[2,87],31:[2,87],52:[2,87],62:[2,87],66:[2,87],69:[2,87]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],67:[1,94],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],79:[2,40]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],79:[2,39]},{52:[1,95]},{52:[2,76],59:[2,76],66:[2,76],74:[2,76],75:[2,76],76:[2,76],77:[2,76]},{52:[2,78]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:96,66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{36:48,37:[1,50],41:49,42:[1,51],43:98,44:97,45:[2,69]},{31:[2,63],38:99,59:[2,63],66:[2,63],69:[2,63],74:[2,63],75:[2,63],76:[2,63],77:[2,63]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,100]},{31:[2,80],59:[2,80],66:[2,80],74:[2,80],75:[2,80],76:[2,80],77:[2,80]},{31:[2,82]},{18:63,57:102,58:64,59:[1,38],61:101,62:[2,85],63:103,64:65,65:66,66:[1,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{30:104,31:[2,55],68:105,69:[1,106]},{31:[2,52],59:[2,52],66:[2,52],69:[2,52],74:[2,52],75:[2,52],76:[2,52],77:[2,52]},{31:[2,54],69:[2,54]},{31:[2,61],35:107,68:108,69:[1,106]},{31:[2,58],59:[2,58],66:[2,58],69:[2,58],74:[2,58],75:[2,58],76:[2,58],77:[2,58]},{31:[2,60],69:[2,60]},{21:[1,109]},{21:[2,44],59:[2,44],66:[2,44],74:[2,44],75:[2,44],76:[2,44],77:[2,44]},{21:[2,46]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,88],31:[2,88],52:[2,88],62:[2,88],66:[2,88],69:[2,88]},{67:[1,94]},{18:63,57:110,58:64,59:[1,38],66:[1,30],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,111]},{45:[2,18]},{45:[2,70]},{18:63,31:[2,65],39:112,57:113,58:64,59:[1,38],63:114,64:65,65:66,66:[1,67],69:[2,65],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,29],78:28},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,115]},{59:[2,84],62:[2,84],66:[2,84],74:[2,84],75:[2,84],76:[2,84],77:[2,84]},{62:[2,86]},{31:[1,116]},{31:[2,56]},{66:[1,118],70:117},{31:[1,119]},{31:[2,62]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,67],40:120,68:121,69:[1,106]},{31:[2,64],59:[2,64],66:[2,64],69:[2,64],74:[2,64],75:[2,64],76:[2,64],77:[2,64]},{31:[2,66],69:[2,66]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,123],71:[1,122]},{66:[2,89],71:[2,89]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,124]},{31:[2,68]},{31:[2,29]},{66:[2,90],71:[2,90]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],47:[2,48],49:[2,19],53:[2,50],62:[2,74],71:[2,78],76:[2,17],80:[2,82],90:[2,46],97:[2,18],98:[2,70],103:[2,86],105:[2,56],108:[2,62],109:[2,11],121:[2,68],122:[2,29]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||1,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],a=[],o=this.table,s="",c=0,u=0,l=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;a.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,g,m,b,v,y,_,x,w={};;){if(g=r[r.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===p||"undefined"==typeof p)&&(p=t()),m=o[g]&&o[g][p]),"undefined"==typeof m||!m.length||!m[0]){var E="";if(!l){x=[];for(v in o[g])this.terminals_[v]&&v>2&&x.push("'"+this.terminals_[v]+"'");E=this.lexer.showPosition?"Parse error on line "+(c+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(c+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(E,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:x})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+p);switch(m[0]){case 1:r.push(p),i.push(this.lexer.yytext),a.push(this.lexer.yylloc),r.push(m[1]),p=null,f?(p=f,f=null):(u=this.lexer.yyleng,s=this.lexer.yytext,c=this.lexer.yylineno,h=this.lexer.yylloc,l>0&&l--);break;case 2:if(y=this.productions_[m[1]][1],w.$=i[i.length-y],w._$={first_line:a[a.length-(y||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(y||1)].first_column,last_column:a[a.length-1].last_column},d&&(w._$.range=[a[a.length-(y||1)].range[0],a[a.length-1].range[1]]),b=this.performAction.call(w,s,u,c,this.yy,m[1],i,a),"undefined"!=typeof b)return b;y&&(r=r.slice(0,-1*y*2),i=i.slice(0,-1*y),a=a.slice(0,-1*y)),r.push(this.productions_[m[1]][0]),i.push(w.$),a.push(w._$),_=o[r[r.length-2]][r[r.length-1]],r.push(_);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),o=0;o<a.length&&(n=this._input.match(this.rules[a[o]]),!n||t&&!(n[0].length>t[0].length)||(t=n,r=o,this.options.flex));o++);return t?(i=t[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,a[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,n,r){function i(e,n){return t.yytext=t.yytext.substr(e,t.yyleng-n)}switch(n){case 0:if("\\\\"===t.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return t.yytext=t.yytext.substr(5,t.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(t.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 79;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return t.yytext=i(1,2).replace(/\\"/g,'"'),74;case 30:return t.yytext=i(1,2).replace(/\\'/g,"'"),74;case 31:return 77;case 32:return 76;case 33:return 76;case 34:return 75;case 35:return 69;case 36:return 71;case 37:return 66;case 38:return t.yytext=i(1,2),66;case 39:return"INVALID";case 40:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,40],inclusive:!0}},e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();return e=t}(),c=function(e,t){function n(){this.parents=[]}var r,i=e,a=t;return n.prototype={constructor:n,mutating:!1,acceptKey:function(e,t){var n=this.accept(e[t]);if(this.mutating){if(n&&(!n.type||!a[n.type]))throw new i('Unexpected node type "'+n.type+'" found when accepting '+t+" on "+e.type);e[t]=n}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new i(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,n=e.length;n>t;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,n--)},accept:function(e){if(e){this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:t!==!1?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},BlockStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash"),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")},PartialStatement:function(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},PartialExpression:function(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},r=n}(t,o),u=function(e){function t(){}function n(e,t,n){void 0===t&&(t=e.length);var r=e[t-1],i=e[t-2];return r?"ContentStatement"===r.type?(i||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(r.original):void 0:n}function r(e,t,n){void 0===t&&(t=-1);var r=e[t+1],i=e[t+2];return r?"ContentStatement"===r.type?(i||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(r.original):void 0:n}function i(e,t,n){var r=e[null==t?0:t+1];if(r&&"ContentStatement"===r.type&&(n||!r.rightStripped)){var i=r.value;r.value=r.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),r.rightStripped=r.value!==i}}function a(e,t,n){var r=e[null==t?e.length-1:t-1];if(r&&"ContentStatement"===r.type&&(n||!r.leftStripped)){var i=r.value;return r.value=r.value.replace(n?/\s+$/:/[ \t]+$/,""),r.leftStripped=r.value!==i,r.leftStripped}}var o,s=e;return t.prototype=new s,t.prototype.Program=function(e){var t=!this.isRootSeen;this.isRootSeen=!0;for(var o=e.body,s=0,c=o.length;c>s;s++){var u=o[s],l=this.accept(u);if(l){var h=n(o,s,t),d=r(o,s,t),p=l.openStandalone&&h,f=l.closeStandalone&&d,g=l.inlineStandalone&&h&&d;l.close&&i(o,s,!0),l.open&&a(o,s,!0),g&&(i(o,s),a(o,s)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(o[s-1].original)[1])),p&&(i((u.program||u.inverse).body),a(o,s)),f&&(i(o,s),a((u.inverse||u.program).body))}}return e},t.prototype.BlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,o=e.program&&e.inverse,s=o,c=o;if(o&&o.chained)for(s=o.body[0].program;c.chained;)c=c.body[c.body.length-1].program;var u={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:r(t.body),closeStandalone:n((s||t).body)};
if(e.openStrip.close&&i(t.body,null,!0),o){var l=e.inverseStrip;l.open&&a(t.body,null,!0),l.close&&i(s.body,null,!0),e.closeStrip.open&&a(c.body,null,!0),n(t.body)&&r(s.body)&&(a(t.body),i(s.body))}else e.closeStrip.open&&a(t.body,null,!0);return u},t.prototype.MustacheStatement=function(e){return e.strip},t.prototype.PartialStatement=t.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},o=t}(c),l=function(e){function t(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}}function n(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}}function r(e){return e.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function i(e,t,n){n=this.locInfo(n);for(var r=e?"@":"",i=[],a=0,o="",s=0,c=t.length;c>s;s++){var l=t[s].part;if(r+=(t[s].separator||"")+l,".."===l||"."===l||"this"===l){if(i.length>0)throw new u("Invalid path: "+r,{loc:n});".."===l&&(a++,o+="../")}else i.push(l)}return new this.PathExpression(e,a,i,r,n)}function a(e,t,n,r,i,a){var o=r.charAt(3)||r.charAt(2),s="{"!==o&&"&"!==o;return new this.MustacheStatement(e,t,n,s,i,this.locInfo(a))}function o(e,t,n,r){if(e.path.original!==n){var i={loc:e.path.loc};throw new u(e.path.original+" doesn't match "+n,i)}r=this.locInfo(r);var a=new this.Program([t],null,{},r);return new this.BlockStatement(e.path,e.params,e.hash,a,void 0,{},{},{},r)}function s(e,t,n,r,i,a){if(r&&r.path&&e.path.original!==r.path.original){var o={loc:e.path.loc};throw new u(e.path.original+" doesn't match "+r.path.original,o)}t.blockParams=e.blockParams;var s,c;return n&&(n.chain&&(n.program.body[0].closeStrip=r.strip),c=n.strip,s=n.program),i&&(i=s,s=t,t=i),new this.BlockStatement(e.path,e.params,e.hash,t,s,e.strip,c,r&&r.strip,this.locInfo(a))}var c={},u=e;return c.SourceLocation=t,c.stripFlags=n,c.stripComment=r,c.preparePath=i,c.prepareMustache=a,c.prepareRawBlock=o,c.prepareBlock=s,c}(t),h=function(e,t,n,r,i){function a(e,t){if("Program"===e.type)return e;s.yy=d,d.locInfo=function(e){return new d.SourceLocation(t&&t.srcName,e)};var n=new u;return n.accept(s.parse(e))}var o={},s=e,c=t,u=n,l=r,h=i.extend;o.parser=s;var d={};return h(d,l,c),o.parse=a,o}(s,o,u,l,e),d=function(e,t,n){function r(){}function i(e,t,n){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new u("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var r=n.parse(e,t),i=(new n.Compiler).compile(r,t);return(new n.JavaScriptCompiler).compile(i,t)}function a(e,t,n){function r(){var r=n.parse(e,t),i=(new n.Compiler).compile(r,t),a=(new n.JavaScriptCompiler).compile(i,t,void 0,!0);return n.template(a)}if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new u("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var i,a=function(e,t){return i||(i=r()),i.call(this,e,t)};return a._setup=function(e){return i||(i=r()),i._setup(e)},a._child=function(e,t,n,a){return i||(i=r()),i._child(e,t,n,a)},a}function o(e,t){if(e===t)return!0;if(l(e)&&l(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!o(e[n],t[n]))return!1;return!0}}function s(e){if(!e.path.parts){var t=e.path;e.path=new d.PathExpression(!1,0,[t.original+""],t.original+"",t.log)}}var c={},u=e,l=t.isArray,h=t.indexOf,d=n,p=[].slice;return c.Compiler=r,r.prototype={compiler:r,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;t>n;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||!o(r.args,i.args))return!1}for(t=this.children.length,n=0;t>n;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[];var n=t.knownHelpers;if(t.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},n)for(var r in n)t.knownHelpers[r]=n[r];return this.accept(e)},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++;return this.usePartial=this.usePartial||t.usePartial,this.children[n]=t,this.useDepths=this.useDepths||t.useDepths,n},accept:function(e){this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,n=0,r=t.length;r>n;n++)this.accept(t[n]);return this.options.blockParams.shift(),this.isSimple=1===r,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){s(e);var t=e.program,n=e.inverse;t=t&&this.compileProgram(t),n=n&&this.compileProgram(n);var r=this.classifySexpr(e);"helper"===r?this.helperSexpr(e,t,n):"simple"===r?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,n),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(e){this.usePartial=!0;var t=e.params;if(t.length>1)throw new u("Unsupported number of partial arguments: "+t.length,e);t.length||t.push({type:"PathExpression",parts:[],depth:0});var n=e.name.original,r="SubExpression"===e.name.type;r&&this.accept(e.name),this.setupFullMustacheParams(e,void 0,void 0,!0);var i=e.indent||"";this.options.preventIndent&&i&&(this.opcode("appendContent",i),i=""),this.opcode("invokePartial",r,n,i),this.opcode("append")},MustacheStatement:function(e){this.SubExpression(e),this.opcode(e.escaped&&!this.options.noEscape?"appendEscaped":"append")},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){s(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,n){var r=e.path,i=r.parts[0],a=null!=t||null!=n;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.accept(r),this.opcode("invokeAmbiguous",i,a)},simpleSexpr:function(e){this.accept(e.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var r=this.setupFullMustacheParams(e,t,n),i=e.path,a=i.parts[0];if(this.options.knownHelpers[a])this.opcode("invokeKnownHelper",r.length,a);else{if(this.options.knownHelpersOnly)throw new u("You specified knownHelpersOnly, but used the unknown helper "+a,e);i.falsy=!0,this.accept(i),this.opcode("invokeHelper",r.length,i.original,d.helpers.simpleId(i))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],n=d.helpers.scopedId(e),r=!e.depth&&!n&&this.blockParamIndex(t);r?this.opcode("lookupBlockParam",r,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts)):this.opcode("lookupOnContext",e.parts,e.falsy,n):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},Hash:function(e){var t,n,r=e.pairs;for(this.opcode("pushHash"),t=0,n=r.length;n>t;t++)this.pushParam(r[t].value);for(;t--;)this.opcode("assignToHash",r[t].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:p.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=d.helpers.simpleId(e.path),n=t&&!!this.blockParamIndex(e.path.parts[0]),r=!n&&d.helpers.helperExpression(e),i=!n&&(r||t),a=this.options;if(i&&!r){var o=e.path.parts[0];a.knownHelpers[o]?r=!0:a.knownHelpersOnly&&(i=!1)}return r?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;n>t;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var n;if(!e.parts||d.helpers.scopedId(e)||e.depth||(n=this.blockParamIndex(e.parts[0])),n){var r=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,r)}else t=e.original||t,t.replace&&(t=t.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,n,r){var i=e.params;return this.pushParams(i),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.accept(e.hash):this.opcode("emptyHash",r),i},blockParamIndex:function(e){for(var t=0,n=this.options.blockParams.length;n>t;t++){var r=this.options.blockParams[t],i=r&&h(r,e);if(r&&i>=0)return[t,i]}}},c.precompile=i,c.compile=a,c}(t,e,o),p=function(e){function t(e,t,n){if(i(e)){for(var r=[],a=0,o=e.length;o>a;a++)r.push(t.wrap(e[a],n));return r}return"boolean"==typeof e||"number"==typeof e?e+"":e}function n(e){this.srcFile=e,this.source=[]}var r,i=e.isArray;try{var a=require("source-map"),o=a.SourceNode}catch(s){o=function(e,t,n,r){this.src="",r&&this.add(r)},o.prototype={add:function(e){i(e)&&(e=e.join("")),this.src+=e},prepend:function(e){i(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}}return n.prototype={prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(e){for(var t=0,n=this.source.length;n>t;t++)e(this.source[t])},empty:function(e){return e=e||this.currentLocation||{start:{}},new o(e.start.line,e.start.column,this.srcFile)},wrap:function(e,n){return e instanceof o?e:(n=n||this.currentLocation||{start:{}},e=t(e,this,n),new o(n.start.line,n.start.column,this.srcFile,e))},functionCall:function(e,t,n){return n=this.generateList(n),this.wrap([e,t?"."+t+"(":"(",n,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var i=t(e[r],this);"undefined"!==i&&n.push([this.quotedString(r),":",i])}var a=this.generateList(n);return a.prepend("{"),a.add("}"),a},generateList:function(e,n){for(var r=this.empty(n),i=0,a=e.length;a>i;i++)i&&r.add(","),r.add(t(e[i],this,n));return r},generateArray:function(e,t){var n=this.generateList(e,t);return n.prepend("["),n.add("]"),n}},r=n}(e),f=function(e,t,n,r){function i(e){this.value=e}function a(){}function o(e,t,n,r){var i=t.popStack(),a=0,o=n.length;for(e&&o--;o>a;a++)i=t.nameLookup(i,n[a],r);return e?[t.aliasable("this.strict"),"(",i,", ",t.quotedString(n[a]),")"]:i}var s,c=e.COMPILER_REVISION,u=e.REVISION_CHANGES,l=t,h=n.isArray,d=r;a.prototype={nameLookup:function(e,t){return a.isValidJavaScriptVariableName(t)?[e,".",t]:[e,"['",t,"']"]},depthedLookup:function(e){return[this.aliasable("this.lookup"),'(depths, "',e,'")']},compilerInfo:function(){var e=c,t=u[e];return[e,t]},appendToBuffer:function(e,t,n){return h(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:n?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},compile:function(e,t,n,r){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!r,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var i,a,o,s,c=e.opcodes;for(o=0,s=c.length;s>o;o++)i=c[o],this.source.currentLocation=i.loc,a=a||i.loc,this[i.opcode].apply(this,i.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new l("Compile completed with content left on stack");var u=this.createFunctionContext(r);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u},d=this.context.programs;for(o=0,s=d.length;s>o;o++)d[o]&&(h[o]=d[o]);return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),r?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),t.srcName?(h=h.toStringWithSourceMap({file:t.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new d(this.options.srcName)},createFunctionContext:function(e){var t="",n=this.stackVars.concat(this.registers.list);n.length>0&&(t+=", "+n.join(", "));var r=0;for(var i in this.aliases){var a=this.aliases[i];this.aliases.hasOwnProperty(i)&&a.children&&a.referenceCount>1&&(t+=", alias"+ ++r+"="+i,a.children[0]="alias"+r)}var o=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&o.push("blockParams"),this.useDepths&&o.push("depths");var s=this.mergeSource(t);return e?(o.push(s),Function.apply(this,o)):this.source.wrap(["function(",o.join(","),") {\n  ",s,"}"])},mergeSource:function(e){var t,n,r,i,a=this.environment.isSimple,o=!this.forceBuffer;return this.source.each(function(e){e.appendToBuffer?(r?e.prepend("  + "):r=e,i=e):(r&&(n?r.prepend("buffer += "):t=!0,i.add(";"),r=i=void 0),n=!0,a||(o=!1))}),o?r?(r.prepend("return "),i.add(";")):n||this.source.push('return "";'):(e+=", buffer = "+(t?"":this.initializeBuffer()),r?(r.prepend("return buffer + "),i.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(t?"":";\n")),this.source.merge()},blockValue:function(e){var t=this.aliasable("helpers.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(e,0,n);var r=this.popStack();n.splice(1,0,r),this.push(this.source.functionCall(t,"call",n))},ambiguousBlockValue:function(){var e=this.aliasable("helpers.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var n=this.topStack();t.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(e){return[" != null ? ",e,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n){var r=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[r++])),this.resolvePath("context",e,r,t)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t){this.pushStackLiteral(e?"this.data(data, "+e+")":"data"),this.resolvePath("data",t,0,!0)},resolvePath:function(e,t,n,r){if(this.options.strict||this.options.assumeObjects)return void this.push(o(this.options.strict,this,t,e));for(var i=t.length;i>n;n++)this.replaceStack(function(i){var a=this.nameLookup(i,t[n],e);return r?[" && ",a]:[" != null ? ",a," : ",i]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)},invokeHelper:function(e,t,n){var r=this.popStack(),i=this.setupHelper(e,t),a=n?[i.name," || "]:"",o=["("].concat(a,r);this.options.strict||o.push(" || ",this.aliasable("helpers.helperMissing")),o.push(")"),this.push(this.source.functionCall(o,"call",i.callParams))},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var n=this.popStack();this.emptyHash();var r=this.setupHelper(0,e,t),i=this.lastHelper=this.nameLookup("helpers",e,"helper"),a=["(","(helper = ",i," || ",n,")"];this.options.strict||(a[0]="(helper = ",a.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",a,r.paramsInit?["),(",r.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",r.callParams)," : helper))"])},invokePartial:function(e,t,n){var r=[],i=this.setupParams(t,1,r,!1);e&&(t=this.popStack(),delete i.name),n&&(i.indent=JSON.stringify(n)),i.helpers="helpers",i.partials="partials",r.unshift(e?t:this.nameLookup("partials",t,"partial")),this.options.compat&&(i.depths="depths"),i=this.objectLiteral(i),r.push(i),this.push(this.source.functionCall("this.invokePartial","",r))},assignToHash:function(e){var t,n,r,i=this.popStack();this.trackIds&&(r=this.popStack()),this.stringParams&&(n=this.popStack(),t=this.popStack());var a=this.hash;t&&(a.contexts[e]=t),n&&(a.types[e]=n),r&&(a.ids[e]=r),a.values[e]=i},pushId:function(e,t,n){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===e?this.pushString(t):this.pushStackLiteral("SubExpression"===e?"true":"null")},compiler:a,compileChildren:function(e,t){for(var n,r,i=e.children,a=0,o=i.length;o>a;a++){n=i[a],r=new this.compiler;var s=this.matchExistingProgram(n);null==s?(this.context.programs.push(""),s=this.context.programs.length,n.index=s,n.name="program"+s,this.context.programs[s]=r.compile(n,t,this.context,!this.precompile),this.context.environments[s]=n,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams):(n.index=s,n.name="program"+s,this.useDepths=this.useDepths||n.useDepths,this.useBlockParams=this.useBlockParams||n.useBlockParams)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;n>t;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],n=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"this.program("+n.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof i||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new i(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t,n,r,a=["("];if(!this.isInline())throw new l("replaceStack on non-inline");var o=this.popStack(!0);if(o instanceof i)t=[o.value],a=["(",t],r=!0;else{n=!0;var s=this.incrStack();a=["((",this.push(s)," = ",o,")"],t=this.topStack()}var c=e.call(this,t);r||this.popStack(),n&&this.stackSlot--,this.push(a.concat(c,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,n=e.length;n>t;t++){var r=e[t];if(r instanceof i)this.compileStack.push(r);else{var a=this.incrStack();this.pushSource([a," = ",r,";"]),this.compileStack.push(a)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof i)return n.value;if(!t){if(!this.stackSlot)throw new l("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof i?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):(t=this.aliases[e]=this.source.wrap(e),t.aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,n){var r=[],i=this.setupHelperArgs(t,e,r,n),a=this.nameLookup("helpers",t,"helper");return{params:r,paramsInit:i,name:a,callParams:[this.contextName(0)].concat(r)}},setupParams:function(e,t,n){var r,i={},a=[],o=[],s=[];i.name=this.quotedString(e),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(i.fn=u||"this.noop",i.inverse=c||"this.noop");for(var l=t;l--;)r=this.popStack(),n[l]=r,this.trackIds&&(s[l]=this.popStack()),this.stringParams&&(o[l]=this.popStack(),a[l]=this.popStack());return this.trackIds&&(i.ids=this.source.generateArray(s)),this.stringParams&&(i.types=this.source.generateArray(o),i.contexts=this.source.generateArray(a)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(e,t,n,r){var i=this.setupParams(e,t,n,!0);return i=this.objectLiteral(i),r?(this.useRegister("options"),n.push("options"),["options=",i]):(n.push(i),"")}};for(var p="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),f=a.RESERVED_WORDS={},g=0,m=p.length;m>g;g++)f[p[g]]=!0;return a.isValidJavaScriptVariableName=function(e){return!a.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},s=a}(n,t,e,p),g=function(e,t,n,r,i){var a,o=e,s=t,c=n.parser,u=n.parse,l=r.Compiler,h=r.compile,d=r.precompile,p=i,f=o.create,g=function(){var e=f();return e.compile=function(t,n){return h(t,n,e)},e.precompile=function(t,n){return d(t,n,e)},e.AST=s,e.Compiler=l,e.JavaScriptCompiler=p,e.Parser=c,e.parse=u,e};o=g(),o.create=g;var m="undefined"!=typeof global?global:window,b=m.Handlebars;return o.noConflict=function(){m.Handlebars===o&&(m.Handlebars=b)},o["default"]=o,a=o}(a,o,h,d,f);return g}),define("i18n-config",["i18n","page_config","Handlebars"],function(e,t,n){return i18n=new e(void 0!=window.i18ndata?{locale_data:window.i18ndata[$("body").data("locale")],domain:"adobestock"}:{domain:"adobestock",locale_data:{adobestock:{"":{domain:"adobestock","plural-forms":"nplurals=2; plural=n != 1;",lang:""}}}}),n.registerHelper("_",function(e){return res=i18n.gettext(e),t.dirty_l10n&&(res_a=res.split("::"),res=res_a[res_a.length-1]),res}),n.registerHelper("ngettext",function(e,n,r){return res=i18n.ngettext(e,n,r),t.dirty_l10n&&(res_a=res.split("::"),res=res_a[res_a.length-1]),res}),n.registerHelper("sprintf",function(){return args=Array.prototype.slice.call(arguments,0,arguments.length-1),msg=args.shift(),e.sprintf(msg,args)}),n.registerHelper("escape_sprintf",function(){return args=Array.prototype.slice.call(arguments,0,arguments.length-1),msg=args.shift(),new n.SafeString(e.sprintf(msg,args))}),n.registerHelper("number",function(e){return intl=new Intl.NumberFormat($("body").data("locale").replace("_","-")),intl.format(e)}),i18n}),define("lib/localStorage",["jquery","lib/member"],function(){return{storage:function(){var e,t=new Date;try{return localStorage.setItem(t,t),e=localStorage.getItem(t)==t,localStorage.removeItem(t),e&&localStorage}catch(n){}},storeData:function(e,t,n){var r=this;r.storage&&(e?localStorage.setItem(e+t,JSON.stringify(n)):localStorage.setItem(t,JSON.stringify(n)))},retrieveData:function(e,t,n){var r=this;if(r.storage){var i;if(i=JSON.parse(e?localStorage.getItem(e+t):localStorage.getItem(t)))return i}return n}}}),define("lib/error",["jquery"],function(e){var t=e(".js-alert-error-modal-canvas"),n=t.find(".js-error-modal-header"),r=t.find(".js-error-modal-body"),i=t.find(".js-dismiss-error-modal"),a=e(".js-error-modal-canvas"),o=a.find(".js-error-modal-header"),s=a.find(".js-error-modal-body"),c=a.find(".js-dismiss-error-modal"),u=c.text(),l=e(".js-short-error-modal-canvas"),h=l.find(".js-short-error-modal-body"),d=l.find(".js-short-dismiss-error-modal"),p=d.text(),f=null;return a.on("click",c,function(){f&&f(),a.hide()}),t.on("click",i,function(){f&&f(),t.hide()}),l.on("click",d,function(){f&&f(),l.hide()}),{displayErrorModal:function(e,n,r,i){o.text(e),s.html(n),c.text(r||u),f=i,a.show(),t.hide(),l.hide()},displayAlertErrorModal:function(e,o,s,c){n.text(e),r.html(o),i.text(s||u),f=c,t.show(),a.hide(),l.hide()},displayShortErrorModal:function(e,n,r){h.text(e),d.text(n||p),f=r,l.show(),t.hide(),a.hide()},displayErrorMsgModal:function(e,t,n,r,i){var a=this;e&&e.title&&e.msg?e.msg.length<50?a.displayShortErrorModal(e.msg,r,i):a.displayErrorModal(e.title,e.msg,r,i):a.displayShortErrorModal(n,r,i)},errorMsg:function(e,t){var n={title:e,msg:t};return n}}}),define("lib/librariesStore",["jquery","lib/libraries","page_config","lib/uiEvents","lib/member","i18n-config","lib/localStorage","lib/error"],function(e,t,n,r,i,a,o,s){return{libraries:o.retrieveData(i.getMemberId(),"LibraryData",[]),getLibraries:function(n){var c=this,u=e.Deferred();return t.getLibraries().then(function(e){0==e.length&&n?c.createLibrary(a.gettext("LIBRARY::MYLIBRARY::My Library")).then(function(e){c.libraries=e.libraries,c.saveDefaultLibrary(e.newestLibrary.id).then(function(){u.resolve(c.libraries),o.storeData(i.getMemberId(),"LibraryData",c.libraries),r.trigger(r.DEFAULT_LIBRARY_UPDATED,e.newestLibrary.id)})}):(c.libraries=e,u.resolve(c.libraries),o.storeData(i.getMemberId(),"LibraryData",e),r.trigger(r.LIBRARIES_UPDATED))}).fail(function(){u.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not load libraries.")))}),u.promise()},getLibraryById:function(e){return t.getLibraries().then(function(t){var n=t.filter(function(t){return t.id===e});return n.length>0?n[0]:null})},createLibrary:function(n){var r=this,c=e.Deferred();return t.createLibrary(n).done(function(e){r.libraries||(r.libraries=[]),r.libraries.push(e);var t={};t.libraries=r.libraries,t.newestLibrary=e,r.libraries.sort(function(e,t){return e.name.localeCompare(t.name)}),o.storeData(i.getMemberId(),"LibraryData",r.libraries),c.resolve(t)}).fail(function(){c.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Failed to create library.")))}),c.promise()},deleteLibrary:function(n){var r=this,c=e.Deferred();return t.deleteLibrary(n).done(function(){for(var e=0;e<r.libraries.length;e++)r.libraries[e].id==n&&(r.libraries.splice(e,1),o.storeData(i.getMemberId(),"LibraryData",r.libraries));c.resolve()}).fail(function(){c.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not delete library.")))}),c},renameLibrary:function(n,r){var c=this,u=e.Deferred();return t.renameLibrary(n,r).done(function(e){for(var t=0;t<c.libraries.length;t++)c.libraries[t].id==n&&(c.libraries[t].name=r,o.storeData(i.getMemberId(),"LibraryData",c.libraries));u.resolve(e)}).fail(function(){u.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not rename library.")))}),u},getLibraryElements:function(n){var r=e.Deferred();return t.getLibraryElements(n).done(function(e){r.resolve(e)}).fail(function(){r.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not retrieve library items.")))}),r},getLibraryThumbnails:function(e){return t.getLibraryThumbnails(e)},libraryContains:function(n,r){var i=e.Deferred();return t.libraryContains(n,r).done(function(e){i.resolve(e)}).fail(function(){i.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not retrieve library items.")))}),i},deleteLibraryElement:function(n,r){var i=e.Deferred();return t.deleteLibraryElement(n,r).done(function(e){i.resolve(e)}).fail(function(){i.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not delete library item.")))}),i},analyticsLibraryElement:function(n,r){var i=e.Deferred();return t.analyticsLibraryElement(n,r).done(function(){i.resolve()}).fail(function(){i.resolve()}),i},addLibraryElement:function(n,r){var o=this,c=e.Deferred(),u=o.updateAssetHelper(r);return this.libraryContains(n,r.content_id).done(function(e){if(null!=e)c.resolve(e);else{var o=r.content_thumb_url.substring(r.content_thumb_url.lastIndexOf("_")+1,r.content_thumb_url.lastIndexOf("."))+","+i.getMemberId();t.addLibraryElement(n,r.content_id,o,u.downloadURL,r.state,r.license,r.title,u.mimetype,u.width,u.height).done(function(e){c.resolve(e)}).fail(function(){c.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not add to library.")))})}}).fail(function(){c.reject(s.errorMsg(a.gettext("GENERIC::Something Went Wrong"),a.gettext("LIBRARIES::Could not add to library.")))}),c.promise()},updateElementInAllLibraries:function(n){var r=this,a=e.Deferred(),o=r.updateAssetHelper(n),s=n.content_thumb_url.substring(n.content_thumb_url.lastIndexOf("_")+1,n.content_thumb_url.lastIndexOf("."))+","+i.getMemberId();return t.updateElementInAllLibraries(n.content_id,s,o.downloadURL,n.state,n.license,o.mimetype,o.width,o.height).done(function(e){a.resolve(e)}).fail(function(){a.resolve()}),a.promise()},updateAssetHelper:function(e){var t=new Object;return t.mimetype=-1!=e.format.indexOf("jpeg")?"image/jpeg":-1!=e.format.indexOf("ai")?"application/illustrator":null,e.downloaded?(t.downloadURL=e.licensed_file_path,t.width=Number(e.size.substring(0,e.size.indexOf("px"))),t.height=Number(e.size.substring(e.size.indexOf(" x ")+3,e.size.lastIndexOf("px")))):(t.downloadURL=e.comp_file_path,t.width=e.content_width,t.height=e.content_height,e.license=null),t},saveDefaultLibrary:function(t){return i.isLoggedIn()?e.post(n.base_url+"/Ajax/Library/SaveDefaultLibrary/"+t).then(function(){r.trigger(r.DEFAULT_LIBRARY_UPDATED,t)}):e.Deferred().resolve("No member to save default library to").promise()
},truncateText:function(){e(".js-truncate").each(function(){max_char=e(this).data("truncate-char"),text_length=e(this).text().length,text_length>max_char&&e(this).text(e(this).text().substr(0,max_char)+"...")})}}}),define("lib/assetsStore",["jquery","page_config"],function(e,t){var n=t.base_url+"/Ajax/MediaData/",r=t.base_url+"/Ajax/Similar/";return{_cache:{},ASSET_DETAIL:{NONE:0,MIN:1,BASIC:2,WITH_KEYWORDS:3,FULL:4},calculateAssetDetail:function(e){function t(t){return t.reduce(function(t,n){return t&&e.hasOwnProperty(n)},!0)}var n=this;return t(["content_id"])?t(["author","author_url","comp_file_path","content_height","content_thumb_large_url","content_thumb_url","content_width","format","size","title","downloaded"])?t(["keywords"])?t(["series"])?n.ASSET_DETAIL.FULL:n.ASSET_DETAIL.WITH_KEYWORDS:n.ASSET_DETAIL.BASIC:n.ASSET_DETAIL.MIN:n.ASSET_DETAIL.NONE},getAsset:function(t,n){var r=this,i=null;return i=r._cache.hasOwnProperty(t)?e.Deferred().resolve(r._cache[t]).promise():e.get("/Ajax/MediaData/"+t+"?full=1").then(function(e){return r._cache[t]=e,r._cache[t]}),i.then(function(i){if(!i)return null;var a=r.calculateAssetDetail(i);return"undefined"==typeof n||a>=n?i:a<r.ASSET_DETAIL.WITH_KEYWORDS?r.getKeywords(t).then(function(e){return e}):e.Deferred().resolve(r._cache[t]).promise()}).promise()},getKeywords:function(t){var r=this;return e.get(n+t+"?full=1").then(function(n){return n&&(r._cache[t]=e.extend(r._cache[t],n)),r._cache[t]}).promise()},getSeries:function(t){var n=this;return e.get(r+t).then(function(r){if(r){var i=r.result_similar_contents.reduce(function(e,t){return e[t.type]=t.results.map(function(e){return e.content_id=e.id,delete e.id,n._cache[e.content_id]=e,e}),e},{});return n._cache[t]=e.extend(n._cache[t],{series:i}),n._cache[t]}}).promise()},getAssetFromCacheOnly:function(e){var t=this;return t._cache.hasOwnProperty(e)?t._cache[e]:null},addAsset:function(t,n){var r=this;if(r._cache.hasOwnProperty(t)){var i=r._cache[t];e.extend(i,n)}else r._cache[t]=n;return r._cache[t]}}}),define("lib/deparam",[],function(){return function(e,t){var n={},r={"true":!0,"false":!1,"null":null};return e.replace(/\+/g," ").split("&").forEach(function(e){var i,a=e.split("="),o=decodeURIComponent(a[0]),s=n,c=0,u=o.split("]["),l=u.length-1;if(/\[/.test(u[0])&&/\]$/.test(u[l])?(u[l]=u[l].replace(/\]$/,""),u=u.shift().split("[").concat(u),l=u.length-1):l=0,2===a.length)if(i=decodeURIComponent(a[1]),t&&(i=i&&!isNaN(i)?+i:"undefined"===i?void 0:void 0!==r[i]?r[i]:i),l)for(c;l>=c;c++)o=""===u[c]?s.length:u[c],s=s[o]=l>c?s[o]||(u[c+1]&&isNaN(u[c+1])?{}:[]):i;else Array.isArray(n[o])?n[o].push(i):n[o]=void 0!==n[o]?[n[o],i]:i;else o&&(n[o]=t?void 0:"")}),n}}),define("lib/window",["lib/deparam"],function(e){return{getLocation:function(e){return e?window.location[e]:window.location},setLocation:function(e){window.location.assign(e)},reloadLocation:function(){window.location.reload()},getPath:function(){var e=window.location;return e.pathname+e.search+e.hash},supportsReplaceState:function(){return window.history&&window.history.replaceState},replaceState:function(){this.supportsReplaceState()&&window.history.replaceState.apply(window.history,arguments)},getSearchObject:function(){var t=this.getLocation("search");return t?(t=t.substr(1),e(t)):{}}}}),define("lib/susi",["jquery","lib/cookie","lib/window","lib/member","lib/error","page_config"],function(e,t,n,r,i){var a={},o=e.Deferred();return"withCredentials"in new XMLHttpRequest||i.displayErrorModal(e(".js-unsupported-browser-title").val(),e(".js-unsupported-browser-body").val(),null),{_thirdPartyCookiesDisabled:!1,_waitTime:5e3,ready:o.promise(),configure:function(e){a=e,e.profile&&(r.setImsProfile(e.profile),o.resolve(e.profile))},hasToken:function(){return!!t(a.COOKIE_IMS_ACCESS_TOKEN)},getToken:function(){return t(a.COOKIE_IMS_ACCESS_TOKEN)},setToken:function(e,n){if(a.IGNORE_COOKIE_UPDATE)return!1;if(e===this.getToken())return!1;var r=new Date;return n&&n.expiresAtMilliseconds>Date.now()?(r.setTime(n.expiresAtMilliseconds),t(a.COOKIE_IMS_ACCESS_TOKEN,e,{path:"/",expires:r})):this.setLoggedOutCookie(),!0},setLoggedOutCookie:function(){var e=new Date(Date.now()+1e3*a.COOKIE_IMS_LOGGED_OUT_TTL);t(a.COOKIE_IMS_LOGGED_OUT,!0,{path:"/",expires:e})},clearLoggedOutCookie:function(){t(a.COOKIE_IMS_LOGGED_OUT,null,{path:"/",expires:0})},clearLoggedInCookie:function(){t(a.COOKIE_IMS_ACCESS_TOKEN,null,{path:"/",expires:0}),t(a.COOKIE_IMS_IMPERSONATOR_TOKEN,null,{path:"/",expires:0})},setLoggedOut:function(){this.setLoggedOutCookie(),this.clearLoggedInCookie()},reloadPage:function(){n.reloadLocation()},cookielessRedirect:function(){if(this.hasCookies())return!1;var e=a.COOKIES_DISABLED+"=1",t=n.getLocation(),r=t.search?t.search+"&"+e:"?"+e;return n.setLocation("//"+t.hostname+t.pathname+r+t.hash),!0},removeTrackerFromUrl:function(){var e=new RegExp(a.QS_IMS_SIGNIN_ATTEMPT+"=1(&)?"),t=n.getPath().replace(e,"");n.replaceState({},document.title,t)},initPage:function(){var e=this,t=!1;window.adobeid={uses_redirect_mode:!0,uses_modal_mode:!1,api_parameters:{authorize:{ctx_id:a.DEFAULT_IMS_CONTEXT_ID,state:{ac:a.OMNITURE_AC_STATE}}},scope:a.SCOPES.join(","),onProfile:function(n){n||!e.hasToken()||a.IGNORE_COOKIE_UPDATE||(t=!0),r.setImsProfile(n),setTimeout(function(){o.resolve(n)},0)},onAccessTokenHasExpired:function(){},onAccessToken:function(t,n){e.setToken(t,n)},onError:function(){},onReady:function(){return t?void e.logout(!0):(e.removeTrackerFromUrl(),void e._bindLinks())}}},login:function(t,r){function i(e){if(e=e||"",e.indexOf(a.QS_IMS_SIGNIN_ATTEMPT)>-1)return e;var t=a.QS_IMS_SIGNIN_ATTEMPT,n=0===e.indexOf("?")?"&":"?";return e+n+t+"=1"}function o(){var t=n.getLocation(),o=t.protocol+"//"+t.host,s="";if(e.isEmptyObject(r)||e.each(r,function(e,t){s+="&"+e+"="+t}),a.REDIRECT_URI)return a.REDIRECT_URI+i()+s;if(c){var u=0===c.indexOf("/")?o+c:c;return u+i()+s}return o+t.pathname+i(t.search)+s+t.hash}var s=this,c=t,r=r;s.clearLoggedOutCookie(),window.adobeIMS.signIn({redirect_uri:o()})},signUp:function(){function e(e){if(e=e||"",e.indexOf(a.QS_IMS_SIGNIN_ATTEMPT)>-1)return e;var t=a.QS_IMS_SIGNIN_ATTEMPT,n=0===e.indexOf("?")?"&":"?";return e+n+t+"=1"}function t(){if(a.REDIRECT_URI)return a.REDIRECT_URI+e();var t=n.getLocation();return t.protocol+"//"+t.host+t.pathname+e(t.search)+t.hash}var r=this;r.clearLoggedOutCookie(),window.adobeIMS.signUp({redirect_uri:t()})},_bindLinks:function(){var t=this,n=!1,r={};e(document.body).on("click",".js-susi-signup",function(){t.hasCookies()?t.signUp():t._showCookiePopup(!1)}),e(document.body).on("click",".js-susi-login",function(){t.hasCookies()?(e(this).data("redirect-url")&&(n=e(this).data("redirect-url")),e(this).data("redirect-params")&&(r=e(this).data("redirect-params")),t.login(n,r)):t._showCookiePopup(!1)}),e(document.body).on("click",".js-susi-logout",function(){t.hasCookies()?t.logout():t._showCookiePopup(!1)})},initShim:function(){var t=this,r=!1;return t.cookielessRedirect()?!1:(window.adobeid={uses_redirect_mode:!0,uses_modal_mode:!1,api_parameters:{authorize:{ctx_id:a.DEFAULT_IMS_CONTEXT_ID,state:{ac:a.OMNITURE_AC_STATE}}},scope:a.SCOPES.join(","),onProfile:function(e){return e?void t.setLoggedOutCookie():(t.setLoggedOut(),void(a.AUTH_REQUIRED?(t.clearLoggedOutCookie(),window.adobeIMS.signIn()):r=!0))},onError:function(){t.reloadPage()},onAccessTokenHasExpired:function(){t.setLoggedOut()},onAccessToken:function(e,n){a.IGNORE_COOKIE_UPDATE||(t.clearLoggedOutCookie(),t.setToken(e,n),r=!0)},onReady:function(){if(r){var i,o=n.getSearchObject();return"undefined"==typeof o[a.QS_IMS_SSO_INBOUND]?void t.reloadPage():(delete o[a.QS_IMS_SSO_INBOUND],o[a.QS_IMS_SSO_COUNTRY_CHECK]=1,window.history&&window.history.replaceState?(i=window.location.pathname,e.isEmptyObject(o)||(i+="?"+e.param(o)),window.history.replaceState({},document.title,i),void t.reloadPage()):void(n.getLocation().search=""))}}},!0)},hasCookies:function(){if(!navigator.cookieEnabled)return!1;var e="modernizercookietest";try{document.cookie=e+"=1";var t=-1!==document.cookie.indexOf(e);return document.cookie=e+"=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",t}catch(n){return!1}},failedIMSLoad:function(){this.setLoggedOutCookie(),this.reloadPage()},logout:function(e){this.setLoggedOut();var t=n.getSearchObject(),r="undefined"!=typeof t[a.QS_IMS_SIGNIN_ATTEMPT];e?r?(this._thirdPartyCookiesDisabled=!0,this._showCookiePopup(!0)):n.getLocation("href")==a.URLS.LOGOUT?n.reloadLocation():n.setLocation(a.URLS.LOGOUT):window.adobeIMS?window.adobeIMS.signOut({redirect_uri:a.URLS.LOGOUT}):n.setLocation(a.URLS.LOGOUT)},loadPageIMS:function(){this._lazyload([a.URLS.IMS],function(){},{})},loadShimIMS:function(){var e=this;try{this._lazyload([a.URLS.IMS],function(){"undefined"==typeof window.adobeIMS&&e.failedIMSLoad()},function(){window.setTimeout(function(){e.failedIMSLoad()},e._waitTime)})}catch(t){e.failedIMSLoad()}window.setTimeout(function(){e.failedIMSLoad()},this._waitTime)},hasThirdPartyCookiesDisabled:function(){return this._thirdPartyCookiesDisabled===!0},_lazyload:function(){require.apply(null,arguments)},_showCookiePopup:function(t){var n=this,r=".js-cookies-title",a=".js-cookies-body";t&&(r=".js-third-party-cookies-title",a=".js-third-party-cookies-body"),i.displayErrorModal(e(r).val(),e(a).val(),null,function(){n.reloadPage()})}}}),define("lib/checkout",["jquery","lib/member","lib/susi","page_config","vendor/misc/anyware"],function(e,t,n,r){var i=r.ANYWARE.anyware_tracking_enabled;return{_container:null,_initialized:null,init:function(n){if(this._initialized||(this._initialized=new e.Deferred),!e.fn.anyware_checkout)return setTimeout(this.init.bind(this,n),100),this._initialized;this._container=e("<div>"),this._container.anyware_checkout({clientId:n.CLIENT_ID,countryCode:t.getCountryCode(),universalMode:!0,landscape:n.LANDSCAPE});var r=this;return this._container.on("configured",function(){r._initialized.resolve()}),this._initialized},destroy:function(){this._container&&(this._container.remove(),this._container=null),this._initialized=null},purchase:function(a){var o=this,s=({productKey:a.productKey},e.Deferred());return n.ready.then(function(){if(t.isLoggedIn()){var n=window.location.protocol+"//"+window.location.host+r.base_url,c=n+"/Orderconfirmation?order_number={{orderNumber}}",u=n+"/Error/Checkout",l="&nb={{isNewBuyer}}&products={{productList}}&currency={{currency}}&payment={{payment}}";i&&(c+=l);var h={};a.imageId&&(h.image_id=a.imageId),a.libraryId&&(h.library_id=a.libraryId),a.action&&(h.action=a.action);var d=e.param(h);""!==d&&(d="&"+d),c+=d;var p="GB"===t.getCountryCode()?"EN":"MULT";window.setTimeout(function(){window.location=u},1e3*r.ANYWARE.TIMEOUT);var f={imsContextId:r.ANYWARE.DEFAULT_IMS_CONTEXT_ID,confirmPageUrl:c,cancelPageUrl:u,countryCode:t.getCountryCode(),items:[{productKey:a.productKey,quantity:1,languageCode:p,serviceCommitment:a.serviceCommitment,fulfillmentMethod:a.fulfillmentMethod}]};o._container.anyware_checkout("startUniversalCheckout",f)}else{var g={product_key:a.productKey,country_code:t.getCountryCode(),service_commitment:a.serviceCommitment,fulfillment_method:a.fulfillmentMethod};a.imageId&&(g.image_id=a.imageId),a.libraryId&&(g.library_id=a.libraryId),a.action&&(g.action=a.action);var m=r.base_url+"/Purchase/Validate";m+="?"+e.param(g),window.location=m}s.resolve()}),s.promise()}}}),define("lib/workflowController",["jquery","page_config","lib/member","lib/susi","lib/checkout","lib/assetsStore","lib/librariesStore","lib/uiEvents","lib/window","lib/error","i18n-config","Handlebars"],function(e,t,n,r,i,a,o,s,c,u,l,h){function d(n){var r="/Plans";n&&(r+="?"+e.param(n)),c.setLocation(t.base_url+r)}function p(n){return e.get(t.base_url+"/Order/Next").then(function(t){return e.Deferred().resolve(n,t)})}function f(n){return e.get(t.base_url+"/Ajax/Content/IsPurchasable/"+n).then(function(){return e.Deferred().resolve()},function(t){return e.Deferred().reject({reason:"CONTENT_NOT_AVAILABLE",err:t})})}function g(e){return e.title=l.gettext("DOWNLOAD::ERROR::An error occurred with your download."),e.reason="PROBLEM_DOWNLOAD_IMAGE",e.msg=l.gettext("DOWNLOAD::ERROR::There was a problem downloading your image. Please try again."),e.msg+="<br /><br />",e.msg+=Jed.sprintf(h.Utils.escapeExpression(l.gettext("DOWNLOAD::ERROR::If this problem persists, contact %sCustomer Service%s.")),'<br /><a href="https://helpx.adobe.com'+t.base_url+'/support.html">',"</a>"),e}function m(t){return i.purchase(t),e.Deferred().resolve({state:"overage_success",action:"navigating to anyware for overage"})}function b(n){return e.ajax({url:t.base_url+"/Order/Overage",method:"POST",data:n})}function v(e){return"STOCK_DEMAND"===e.fulfillment_method}function y(e){return"STOCK_OVERAGE"===e.fulfillment_method&&(e.is_on_demand_key||e.is_team||!e.is_first_overage)}return{licenseImageAndSaveToLibrary:function(i,c){var u=e.Deferred();return r.ready.then(function(){return n.isLoggedIn()?void 0:(u.resolve({state:"redirecting"}),d({image_id:i}),e.Deferred().reject())}).then(function(){return f(i)}).then(function(){a.getAsset(i,a.ASSET_DETAIL.BASIC).then(function(n){return n.downloaded?(e.get(t.base_url+"/Ajax/GetDownloadUrl/"+i).then(function(e){return n.state="purchased",n.downloaded=!0,n.license="standard",n.licensed_file_path=e.download_url,o.addLibraryElement(c,n)}).then(function(){return o.updateElementInAllLibraries(n)}).then(function(){u.resolve({state:"success",action:"already licensed image, saved to library"})}).fail(function(e){e=g(e),u.reject(e)}),e.Deferred().reject()):n}).then(function(e){return p(e)}).then(function(r,a){if(a.available_downloads>0)return e.get(t.base_url+"/Ajax/GetDownload/"+i).then(function(e){return r.state="purchased",r.downloaded=!0,r.license="standard",r.licensed_file_path=e.split("\\").join("").replace(/"/g,""),o.addLibraryElement(c,r)}).then(function(){return o.updateElementInAllLibraries(r)}).then(function(){s.trigger(s.ASSET_LICENSED,{contentId:i}),n.consumeDefaultEntitlementLicense(),u.resolve()}).fail(function(e){0==e.msg.localeCompare(l.gettext("LIBRARIES::Could not add to library."))&&(e=g(e)),u.reject(e)}),e.Deferred().reject();if("undefined"==typeof a.product_key||null===a.product_key)return u.resolve({state:"redirecting"}),d({image_id:i,library_id:c,action:"Save"}),e.Deferred().reject();if(a.is_unsupported_payment_method)return u.reject({reason:"UNSUPPORTED_PAYMENT_METHOD"}),e.Deferred().reject();var h=null;return h=v(a)?function(){return m({productKey:a.product_key,serviceCommitment:a.service_commitment,fulfillmentMethod:a.fulfillment_method,imageId:i,libraryId:c,action:"Save"})}:function(){return b({product_key:a.product_key,image_id:i,fulfillment_method:a.fulfillment_method}).then(function(){return e.get(t.base_url+"/Ajax/GetDownload/"+i).then(function(e){return r.state="purchased",r.downloaded=!0,r.license="standard",r.licensed_file_path=e.split("\\").join("").replace(/"/g,""),o.addLibraryElement(c,r)}).then(function(){return o.updateElementInAllLibraries(r)}).then(function(){return s.trigger(s.ASSET_LICENSED,{contentId:i}),{state:"success",action:"overage purchased and licensed image to library"}}).fail(function(t){return 0==t.msg.localeCompare(l.gettext("LIBRARIES::Could not add to library."))&&(t=g(t)),e.Deferred().reject(t)})},function(t){return e.Deferred().reject(t)})},u.resolve({action:"OVERAGE",price:a.price,currency_symbol:a.currency_symbol,locale_price:a.locale_price,plan_units:a.plan_units,currency_iso_code:a.iso_code,is_exclusive_vat:a.is_exclusive_vat,asset:r,next:h,isInlineOverageConfirmation:y(a)}),e.Deferred().reject()})},function(e){u.reject(e)}),u.promise()},saveWatermarkedImageToLibrary:function(t,i){var s=e.Deferred();return r.ready.then(function(){return n.isLoggedIn()?void 0:(r.login(),s.resolve(),e.Deferred().reject())}).then(function(){return f(t)}).then(function(){a.getAsset(t,a.ASSET_DETAIL.BASIC).then(function(e){return o.addLibraryElement(i,e)}).then(function(){s.resolve()}).fail(function(e){e=g(e),s.reject(e)})},function(e){s.reject(e)}),s.promise()},licenseImageAndSaveToDesktop:function(i){var c=e.Deferred();return r.ready.then(function(){return n.isLoggedIn()?void 0:(c.resolve({state:"redirecting"}),d({image_id:i,action:"Download"}),e.Deferred().reject())}).then(function(){return f(i)}).then(function(){a.getAsset(i,a.ASSET_DETAIL.BASIC).then(function(n){return n.downloaded?(n.licensed_file_path?(document.getElementById("downloadTarget").src=n.licensed_file_path,c.resolve()):e.get(t.base_url+"/Ajax/GetDownloadUrl/"+i).then(function(e){document.getElementById("downloadTarget").src=e.download_url,c.resolve()}),e.Deferred().reject()):n}).then(function(e){return p(e)}).then(function(r,a){if(a.available_downloads>0)return e.get(t.base_url+"/Ajax/GetDownload/"+i).then(function(t){return r.state="purchased",r.downloaded=!0,r.license="standard",r.licensed_file_path=t.split("\\").join("").replace(/"/g,""),o.updateElementInAllLibraries(r).then(function(){return r},function(t){return t=g(t),e.Deferred().reject(t)})},function(t){return t=g(t),e.Deferred().reject(t)}).then(function(e){s.trigger(s.ASSET_LICENSED,{contentId:i}),n.consumeDefaultEntitlementLicense(),document.getElementById("downloadTarget").src=e.licensed_file_path,c.resolve()}).fail(function(e){e=g(e),c.reject(e)}),e.Deferred().reject();if(a.is_cce)return c.reject({reason:"ENTERPRISE_NO_LICENSES"}),e.Deferred().reject();if("undefined"==typeof a.product_key||null===a.product_key)return d({image_id:i,action:"Download"}),c.resolve({state:"redirecting"}),e.Deferred().reject();if(a.is_unsupported_payment_method)return c.reject({reason:"UNSUPPORTED_PAYMENT_METHOD"}),e.Deferred().reject();var u=null;return u=v(a)?function(){return m({productKey:a.product_key,serviceCommitment:a.service_commitment,fulfillmentMethod:a.fulfillment_method,imageId:i,action:"Save"})}:function(){return b({product_key:a.product_key,image_id:i,fulfillment_method:a.fulfillment_method}).then(function(){return e.get(t.base_url+"/Ajax/GetDownload/"+i).then(function(t){return r.state="purchased",r.downloaded=!0,r.license="standard",r.licensed_file_path=t.split("\\").join("").replace(/"/g,""),o.updateElementInAllLibraries(r).then(function(){return r},function(t){return t=g(t),e.Deferred().reject(t)})}).then(function(e){return s.trigger(s.ASSET_LICENSED,{contentId:i}),document.getElementById("downloadTarget").src=e.licensed_file_path,{state:"success",action:"overage purchased and image downloaded"}}).fail(function(t){return t=g(t),e.Deferred().reject(t)})},function(t){return e.Deferred().reject(t)})},c.resolve({action:"OVERAGE",price:a.price,currency_symbol:a.currency_symbol,locale_price:a.locale_price,plan_units:a.plan_units,currency_iso_code:a.iso_code,is_exclusive_vat:a.is_exclusive_vat,asset:r,next:u,isInlineOverageConfirmation:y(a)}),e.Deferred().reject()})},function(e){c.reject(e)}),c.promise()},saveWatermarkedImageToDesktop:function(t){var i=e.Deferred();return r.ready.then(function(){return n.isLoggedIn()?void 0:(r.login(),i.resolve(),e.Deferred().reject())}).then(function(){return f(t)}).then(function(){a.getAsset(t,a.ASSET_DETAIL.BASIC).then(function(e){document.getElementById("downloadTarget").src=e.comp_file_path,i.resolve()},function(e){e=g(e),i.reject(e)})},function(e){i.reject(e)}),i.promise()},buyAdditionalLicense:function(i,o){var c=e.Deferred();return r.ready.then(function(){return n.isLoggedIn()?void 0:(c.resolve({state:"redirecting"}),d({image_id:i}),e.Deferred().reject())}).then(function(){return f(i)}).then(function(){a.getAsset(i,a.ASSET_DETAIL.BASIC).then(function(e){return p(e)}).then(function(r,a){if(a.available_downloads>0)return e.get(t.base_url+"/Ajax/Content/AdditionalLicense/"+o).then(function(e){e.error?c.reject(e.error):(s.trigger(s.ASSET_LICENSED,{contentId:i}),n.consumeDefaultEntitlementLicense(),c.resolve(e))}),e.Deferred().reject();if(a.is_cce)return c.reject({reason:"ENTERPRISE_NO_LICENSES"}),e.Deferred().reject();if("undefined"==typeof a.product_key||null===a.product_key)return d({image_id:i,action:"Additional"}),c.resolve(),e.Deferred().reject();if(a.is_unsupported_payment_method)return c.reject({reason:"UNSUPPORTED_PAYMENT_METHOD"}),e.Deferred().reject();var u=null;return u=v(a)?function(){return m({productKey:a.product_key,serviceCommitment:a.service_commitment,fulfillmentMethod:a.fulfillment_method,imageId:i,action:"Save"})}:function(){return b({product_key:a.product_key,image_id:i,fulfillment_method:a.fulfillment_method}).then(function(){return e.get(t.base_url+"/Ajax/Content/AdditionalLicense/"+o).then(function(t){return t.error?e.Deferred().reject(t.error).promise():(s.trigger(s.ASSET_LICENSED,{contentId:i}),n.consumeDefaultEntitlementLicense(),t)})},function(){return e.Deferred().reject({error:l.gettext("MEMBER::ERROR::Failed to purchase an additional license.")})})},c.resolve({action:"OVERAGE",price:a.price,currency_symbol:a.currency_symbol,locale_price:a.locale_price,plan_units:a.plan_units,is_exclusive_vat:a.is_exclusive_vat,asset:r,next:u,isInlineOverageConfirmation:y(a)}),e.Deferred().reject()})},function(e){c.reject(e)}),c.promise()},performImageActionOnPurchaseReturn:function(){var i=e.Deferred(),s=c.getSearchObject();if(!s.image_id)return i.reject("No image_id"),i.promise();var u=s.image_id,h=s.action,d=s.library_id;return r.ready.then(function(){return n.isLoggedIn()?void 0:(i.reject("Member not logged in"),e.Deferred().reject())}).then(function(){var n=a.getAsset(u,a.ASSET_DETAIL.BASIC),r=null;r=t.download_url?t.download_url:e.get(t.base_url+"/Ajax/GetDownloadUrl/"+u).then(function(e){return e.download_url.split("\\").join("").replace(/"/g,"")}),e.when(n,r).then(function(e,t){e.state="purchased",e.downloaded=!0,e.license="standard",e.licensed_file_path=t,o.updateElementInAllLibraries(e).then(function(){return d?o.addLibraryElement(d,e):void 0}).then(function(){"Download"===h?i.resolve({downloadUrl:t}):i.resolve()},function(e){0==e.msg.localeCompare(l.gettext("LIBRARIES::Could not add to library."))&&(e=g(e)),i.reject(e)})},function(e){i.reject(e)})}),i.promise()},performPlanUpgradeAndLicenseImage:function(n){var r=e.Deferred();if(!n.subscriptionGuid)return r.reject("Missing subscription guid").promise();if(!n.upgradeSku)return r.reject("Missing upgrade SKU").promise();var i=e.ajax({url:t.base_url+"/Order/Upgrade",method:"POST",data:{subscription_guid:n.subscriptionGuid,upgrade_sku:n.upgradeSku,product_key:n.productKey,service_name:n.serviceName,image_id:n.imageId}});return i.then(function(i){if(!n.imageId)return void r.resolve();var s=null;s=i&&i.downloadUrl&&""!==i.downloadUrl?i.downloadUrl:e.get(t.base_url+"/Ajax/GetDownloadUrl/"+n.imageId).then(function(e){return e.download_url.split("\\").join("").replace(/"/g,"")});var c=a.getAsset(n.imageId,a.ASSET_DETAIL.BASIC);e.when(c,s).then(function(e,t){e.state="purchased",e.downloaded=!0,e.license="standard",e.licensed_file_path=t,o.updateElementInAllLibraries(e).then(function(){return n.libraryId?o.addLibraryElement(n.libraryId,e):void 0}).then(function(){"Download"===n.action?r.resolve({downloadUrl:t}):r.resolve()},function(e){0==e.msg.localeCompare(l.gettext("LIBRARIES::Could not add to library."))&&(e=g(e)),r.reject(e)})},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()}}}),define("text",["module"],function(e){var t,n,r,i,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,l=u&&location.protocol&&location.protocol.replace(/\:/,""),h=u&&location.hostname,d=u&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.12",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,a=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!o||a>1)?(t=e.substring(0,a),n=e.substring(a+1,e.length)):t=e,r=n||t,a=r.indexOf("!"),-1!==a&&(i="strip"===r.substring(a+1),r=r.substring(0,a),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var a,o,s,c=t.xdRegExp.exec(e);return c?(a=c[2],o=c[3],o=o.split(":"),s=o[1],o=o[0],!(a&&a!==n||o&&o.toLowerCase()!==r.toLowerCase()||(s||o)&&s!==i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,f.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText)return void r();f.isBuild=i&&i.isBuild;var a=t.parseName(e),o=a.moduleName+(a.ext?"."+a.ext:""),s=n.toUrl(o),c=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void r():void(!u||c(s,l,h,d)?t.get(s,function(n){t.finishLoad(e,a.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,r)}))},write:function(e,n,r){if(p.hasOwnProperty(n)){var i=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,n,r,i,a){var o=t.parseName(n),s=o.ext?"."+o.ext:"",c=o.moduleName+s,u=r.toUrl(o.moduleName+s)+".js";t.load(c,r,function(){var n=function(e){return i(u,e)};n.asModule=function(e,t){return i.asModule(e,u,t)},t.write(e,c,n,a)},a)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),t(i)}catch(a){r&&r(a)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,r,i){var a,o=t.createXhr();if(o.open("GET",e,!0),i)for(a in i)i.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),i[a]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(){var t,i;4===o.readyState&&(t=o.status||0,t>399&&600>t?(i=new Error(e+" HTTP status: "+t),i.xhr=o,r&&r(i)):n(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,r,i="utf-8",a=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),i)),c="";try{for(n=new java.lang.StringBuffer,r=s.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&n.append(r);null!==(r=s.readLine());)n.append(o),n.append(r);c=String(n.toString())}finally{s.close()}t(c)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,s,c={};a&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(s,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),c),o.close(),n.close(),t(c.value)}catch(u){throw new Error((s&&s.path||"")+": "+u)}}),t}),define("hbs",["text","Handlebars"],function(e,t){var n={},r="define('{pluginName}!{moduleName}', ['Handlebars'], function (Handlebars) { return Handlebars.template({content}); });\n";return{version:"0.0.2",load:function(r,i,a,o){if(n[r])a(n[r]);else{var s=o.hbars&&o.hbars.extension||".html",c=o.hbars&&o.hbars.path||"",u=o.hbars&&o.hbars.compileOptions||{},l=function(e){o.isBuild?(n[r]=t.precompile(e,u),a()):(n[r]=t.compile(e),a(n[r]))};l.error=a.error,e.load(c+r+s,i,l,o)}},write:function(e,t,i){var a=n[t];a&&i.asModule(e+"!"+t,r.replace("{pluginName}",e).replace("{moduleName}",t).replace("{content}",a))}}}),define("hbs!templates/libraryMenu",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i;return'    <li class="library-hover-menu-initial-action-item js-library-hover-menu-initial-action-item">\n'+(null!=(i=t["if"].call(e,null!=e?e.isLicenseAction:e,{name:"if",hash:{},fn:this.program(2,r,0),inverse:this.program(4,r,0),data:r}))?i:"")+'    </li>\n    <li class="separator"></li>\n'},2:function(e,t,n,r){var i,a;return'            <button class="js-hover-save-to-lib save-instruction js-default-library" data-lib-id="'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.id:i,e))+'" data-lib-name="'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.name:i,e))+'" data-action="'+this.escapeExpression((a=null!=(a=t.action||(null!=e?e.action:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"action",hash:{},data:r}):a))+'">\n                <span class="js-save-title" data-has-licenses-language="'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::License & Save to",{name:"_",hash:{},data:r}))+'" data-no-licenses-language="'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Buy License & Save to",{name:"_",hash:{},data:r}))+'" data-post-licensing-language="'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Save to",{name:"_",hash:{},data:r}))+'">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::License & Save to",{name:"_",hash:{},data:r}))+'</span>\n            </button>\n            <div class="truncate truncate-w200 hover-save-to-library-name-container">\n                <span class="js-hover-save-to-library-name hover-save-to-library-name">'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.name:i,e))+'</span>\n            </div>\n            <button class="js-toggle-expanded-menu-button toggle-expanded-menu-button"><i class="icon-arrow-down"></i></button>\n'},4:function(e,t,n,r){var i,a;return'            <button class="js-hover-save-to-lib save-instruction js-default-library" data-lib-id="'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.id:i,e))+'" data-lib-name="'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.name:i,e))+'" data-action="'+this.escapeExpression((a=null!=(a=t.action||(null!=e?e.action:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"action",hash:{},data:r}):a))+'">\n                '+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Save Preview to",{name:"_",hash:{},data:r}))+'\n            </button>\n            <div class="truncate truncate-w200 hover-save-to-library-name-container">\n                <span class="js-hover-save-to-library-name hover-save-to-library-name">'+this.escapeExpression(this.lambda(null!=(i=null!=(i=null!=e?e.libraries:e)?i.defaultLib:i)?i.name:i,e))+'</span>\n            </div>\n            <button class="js-toggle-expanded-menu-button toggle-expanded-menu-button"><i class="icon-arrow-down"></i></button>\n'},6:function(e,t,n,r,i,a){var o;return'        <li>\n            <div class="library-option cursor-pointer">\n                <div class="js-hover-save-to-lib js-truncate" data-truncate-char="35" data-lib-id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-action="'+this.escapeExpression(this.lambda(null!=a[1]?a[1].action:a[1],e))+'" data-lib-name="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"name",hash:{},data:r}):o))+'">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"name",hash:{},data:r}):o))+"</div>\n            </div>\n        </li>\n"
},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i,a){var o,s;return'<ul class="hover-menu-list default-library-menu js-default-library-menu">\n'+(null!=(o=t["if"].call(e,null!=(o=null!=e?e.libraries:e)?o.defaultLib:o,{name:"if",hash:{},fn:this.program(1,r,0,i,a),inverse:this.noop,data:r}))?o:"")+'</ul>\n<div class="js-collapsable-libraries-menu" style="display: none;">\n    <ul class="existing-libraries-menu hover-menu-list js-library-hover-menu-initial-action-item">\n        <li class="new-library-list-item">\n            <span class="save-to-library-header" style=>'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Save to a Creative Cloud Library",{name:"_",hash:{},data:r}))+'</span>\n            <br>\n            <input class="js-new-library-input new-library-input" placeholder="'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Add new library",{name:"_",hash:{},data:r}))+'" />\n            <button class="js-new-library new-library-button" style="display: none;" data-action="'+this.escapeExpression((s=null!=(s=t.action||(null!=e?e.action:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"action",hash:{},data:r}):s))+'">\n                +\n            </button>\n        </li>\n'+(null!=(o=t.each.call(e,null!=(o=null!=e?e.libraries:e)?o.libraries:o,{name:"each",hash:{},fn:this.program(6,r,0,i,a),inverse:this.noop,data:r}))?o:"")+'    </ul>\n    <ul class="desktop-button-menu">\n        <li class="separator"></li>\n        <li>\n            <button class="js-hover-save-to-lib desktop-button" data-action="'+this.escapeExpression((s=null!=(s=t.action||(null!=e?e.action:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"action",hash:{},data:r}):s))+'" data-lib-id="desktop" data-lib-name="'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"PHOTO::DOWNLOAD::Desktop",{name:"_",hash:{},data:r}))+'">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::MENU::Save to Desktop",{name:"_",hash:{},data:r}))+"</button>\n        </li>\n    </ul>\n</div>\n"},useData:!0,useDepths:!0})}),define("hbs!templates/overageModal",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i;return'data-content-id="'+this.escapeExpression((i=null!=(i=t.content_id||(null!=e?e.content_id:e))?i:t.helperMissing,"function"==typeof i?i.call(e,{name:"content_id",hash:{},data:r}):i))+'"'},3:function(e,t,n,r){var i;return'                <div class="exclusive-vat">\n'+(null!=(i=t["if"].call(e,null!=e?e.is_label_not_taxable:e,{name:"if",hash:{},fn:this.program(4,r,0),inverse:this.noop,data:r}))?i:"")+"\n"+(null!=(i=t["if"].call(e,null!=e?e.is_label_no_gst_payable:e,{name:"if",hash:{},fn:this.program(6,r,0),inverse:this.noop,data:r}))?i:"")+"\n"+(null!=(i=t["if"].call(e,null!=e?e.is_label_exclusive_vat:e,{name:"if",hash:{},fn:this.program(8,r,0),inverse:this.noop,data:r}))?i:"")+"                </div>\n"},4:function(e,t,n,r){return"                        "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"PLANS::Not taxable",{name:"_",hash:{},data:r}))+"\n"},6:function(e,t,n,r){return"                        "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"PLANS::No GST payable",{name:"_",hash:{},data:r}))+"\n"},8:function(e,t,n,r){return"                        "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"PLANS::Exclusive of VAT",{name:"_",hash:{},data:r}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,a;return'<div class="modal overage">\n    <button class="modal-close js-overage-modal-cancel" type="button" '+(null!=(i=t["if"].call(e,null!=e?e.content_id:e,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.noop,data:r}))?i:"")+'><i class="icon-close"></i></button>\n\n    <h1 class="modal-header">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"MEMBER::DOWNLOAD::You're out of licenses. What would you like to do?",{name:"_",hash:{},data:r}))+'</h1>\n    <p class="modal-body-text">\n        '+this.escapeExpression((t.sprintf||e&&e.sprintf||t.helperMissing).call(e,(t.ngettext||e&&e.ngettext||t.helperMissing).call(e,"MEMBER::DOWNLOAD::Your plan entitles you to %s image a month","MEMBER::DOWNLOAD::Your plan entitles you to %s images a month",null!=e?e.entitlement:e,{name:"ngettext",hash:{},data:r}),(t.number||e&&e.number||t.helperMissing).call(e,null!=e?e.entitlement:e,{name:"number",hash:{},data:r}),{name:"sprintf",hash:{},data:r}))+'\n    </p>\n\n    <div class="overage-options-container">\n        <div class="option option-image">\n            <img src="'+this.escapeExpression((a=null!=(a=t.thumb_url||(null!=e?e.thumb_url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"thumb_url",hash:{},data:r}):a))+'" />\n        </div>\n        <div class="option">\n            <h3>'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"MEMBER::DOWNLOAD::One-Time Download",{name:"_",hash:{},data:r}))+'</h3>\n            <p class="price">'+this.escapeExpression((a=null!=(a=t.locale_price||(null!=e?e.locale_price:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"locale_price",hash:{},data:r}):a))+"</p>\n"+(null!=(i=t["if"].call(e,null!=e?e.is_exclusive_vat:e,{name:"if",hash:{},fn:this.program(3,r,0),inverse:this.noop,data:r}))?i:"")+'            <p class="action">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"MEMBER::DOWNLOAD::One-time Payment",{name:"_",hash:{},data:r}))+'</p>\n            <button class="rounded-button blue js-action-overage" '+(null!=(i=t["if"].call(e,null!=e?e.content_id:e,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.noop,data:r}))?i:"")+">"+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"MEMBER::DOWNLOAD::Buy",{name:"_",hash:{},data:r}))+'</button>\n        </div>\n    </div>\n</div>\n\n<div class="modal-mask">\n</div>\n'},useData:!0})}),define("hbs!templates/inlineBlock/multiRowsOverageConfirmation",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i;return'    <span class="inline-exclusive-vat js-inline-exclusive-vat">\n'+(null!=(i=t["if"].call(e,null!=e?e.is_label_not_taxable:e,{name:"if",hash:{},fn:this.program(2,r,0),inverse:this.noop,data:r}))?i:"")+(null!=(i=t["if"].call(e,null!=e?e.is_label_no_gst_payable:e,{name:"if",hash:{},fn:this.program(4,r,0),inverse:this.noop,data:r}))?i:"")+(null!=(i=t["if"].call(e,null!=e?e.is_label_exclusive_vat:e,{name:"if",hash:{},fn:this.program(6,r,0),inverse:this.noop,data:r}))?i:"")+"    </span>\n    <br />\n"},2:function(e,t,n,r){return"            "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::OVERAGE::NO_ABBREVIATION::Not taxable",{name:"_",hash:{},data:r}))+"\n"},4:function(e,t,n,r){return"            "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::OVERAGE::NO_ABBREVIATION::No GST payable",{name:"_",hash:{},data:r}))+"\n"},6:function(e,t,n,r){return"            "+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::OVERAGE::NO_ABBREVIATION::Exclusive of VAT",{name:"_",hash:{},data:r}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return'<br />\n<span class="inline-overage-price-string js-inline-overage-price-string">'+this.escapeExpression((t.sprintf||e&&e.sprintf||t.helperMissing).call(e,(t._||e&&e._||t.helperMissing).call(e,"FILE::ACTION::Pay %s for this image?",{name:"_",hash:{},data:r}),null!=e?e.locale_price:e,{name:"sprintf",hash:{},data:r}))+"</span>\n<br />\n"+(null!=(i=t["if"].call(e,null!=e?e.is_exclusive_vat:e,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.noop,data:r}))?i:"")+'<br />\n<button class="rounded-button blue js-action-overage">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::OVERAGE::Yes",{name:"_",hash:{},data:r}))+'</button>\n<button class="rounded-button gray js-overage-modal-cancel">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"LIB::OVERAGE::Cancel",{name:"_",hash:{},data:r}))+"</button>\n"},useData:!0})}),define("lib/hoverMenu",["jquery","page_config","lib/librariesStore","lib/assetsStore","lib/workflowController","lib/uiEvents","i18n-config","hbs!templates/libraryMenu","hbs!templates/overageModal","hbs!templates/inlineBlock/multiRowsOverageConfirmation","lib/member","lib/error","lib/susi","Handlebars"],function(e,t,n,r,i,a,o,s,c,u,l,h,d){function p(t,i){var a,c=e("#memberDefaultLibraryId").val(),u={libraries:t};t&&(a=t.filter(function(e){return e.id===c})),u.defaultLib=a&&a.length>0?a[0]:{id:"desktop",name:o.gettext("PHOTO::DOWNLOAD::Desktop")},e(".js-libraries-expansion .js-libraries-menu").html(s({action:"License",isLicenseAction:!0,libraries:u})),e(".js-downloads-expansion .js-libraries-menu").html(s({action:"Save",isLicenseAction:!1,libraries:u})),e(".js-libraries-expansion .js-libraries-menu").each(function(){var t=e(this).closest(".js-hover-container"),n=t.attr("data-content-id"),a=r.getAssetFromCacheOnly(n);a&&(a.downloaded||a.licensed)&&x(t,!1),i||v(t)}),f(),n.truncateText()}function f(){var t=l.getDefaultEntitlement(),n=e(".js-save-title").not(".js-post-saved");n.text(e(".js-save-title").data(t&&t.total_available_downloads?"hasLicensesLanguage":"noLicensesLanguage"))}function g(e){var t="License",n="new",r="new",i=e.closest(".js-hover-container").attr("data-content-id");E(e,t,n,r,i)}function m(n){var r=n.closest(".js-hover-container").attr("data-content-id"),i=e("#filter-content-form").serialize();window.location=t.base_url+"/Search?similia_id="+r+"&"+i}function b(e){var t=e,r=t.siblings(".js-new-library-input"),i=r.val();if(i){var a=t.data("action"),s=t.closest(".js-search-result-cell");y(s,"creatinglibrary"),n.createLibrary(i).done(function(e){var t=e.newestLibrary;p(n.libraries,!0);var r=s.data("contentId");y(s,"notsaving"),E(s,a,t.id,t.name,r)}).fail(function(e){h.displayErrorMsgModal(e,o.gettext("GENERIC::Something Went Wrong"),o.gettext("GENERIC::There was an error processing your request.")),w(s)}),r.val("")}}function v(e){e.find(".js-hover-menu-pre-library-loading-state").addClass("hidden"),w(e)}function y(e,t){var n=e.find(".js-hover-menu-pre-library-loading-state"),r=e.find(".js-hover-menu-savinglibrary-spinner-state"),i=e.find(".js-hover-menu-creatinglibrary-spinner-state");0==t.indexOf("notsaving")?(n.removeClass("not-saving hidden"),r.addClass("not-saving hidden"),i.addClass("not-saving hidden")):0==t.indexOf("saving")?(r.removeClass("not-saving hidden"),n.addClass("not-saving hidden"),i.addClass("not-saving hidden")):0==t.indexOf("creatinglibrary")&&(i.removeClass("not-saving hidden"),r.addClass("not-saving hidden"),i.removeClass("not-saving hidden")),e.find(".js-hover-menu-active-state").addClass("hidden"),e.find(".js-hover-menu-saved-state").addClass("hidden"),e.find(".js-post-saving-data-div").addClass("hidden"),e.find(".js-expansion").fadeOut(300),e.find(".js-hover-expand-btn").removeClass("active"),e.find(".js-collapsable-libraries-menu").slideUp(),e.find(".js-hover-menu").addClass("must-show")}function _(e,t){e.find(".js-hover-menu-savinglibrary-spinner-state").addClass("not-saving hidden"),e.find(".js-hover-menu-creatinglibrary-spinner-state").addClass("not-saving hidden"),e.find(".js-hover-menu-active-state").addClass("hidden"),e.find(".js-hover-menu-saved-state").removeClass("hidden"),t?e.find(".js-post-saving-data-div").removeClass("hidden").find(".lib-name").text(t):e.find(".js-post-saving-data-div").removeClass("hidden"),setTimeout(function(){w(e)},2e3)}function x(e,t){e.find(".js-hover-icon-licensing").addClass("hidden"),e.find(".js-hover-icon-downloading").addClass("hidden"),e.find(".js-hover-icon-saving").removeClass("hidden");var n=e.find(".js-save-title");n.addClass("js-post-saved"),n.text(n.data("postLicensingLanguage")),f(),t?setTimeout(function(){e.find(".js-image-licensed-badge").removeClass("hidden")},2e3):e.find(".js-image-licensed-badge").removeClass("hidden")}function w(e){e.find(".js-hover-menu-pre-library-loading-state").addClass("not-saving hidden"),e.find(".js-hover-menu-savinglibrary-spinner-state").addClass("not-saving hidden"),e.find(".js-hover-menu-creatinglibrary-spinner-state").addClass("not-saving hidden"),e.find(".js-hover-menu-active-state").removeClass("hidden"),e.find(".js-hover-menu-saved-state").addClass("hidden"),e.find(".js-post-saving-data-div").addClass("hidden"),e.find(".js-hover-menu").removeClass("must-show")}function E(t,r,a,s,l){var p=null;p="License"===r?"desktop"===a?i.licenseImageAndSaveToDesktop(l):i.licenseImageAndSaveToLibrary(l,a):"Save"===r?"desktop"===a?i.saveWatermarkedImageToDesktop(l):i.saveWatermarkedImageToLibrary(l,a):e.Deferred().reject("Invalid action").promise();var f=t.closest(".js-search-result-cell");return y(f,"notsaving"),p.then(function(t){if(t&&"OVERAGE"===t.action){var n,r=!t.isInlineOverageConfirmation,i=e.Deferred(),a=e("body"),s=!1,l=!1,h=!1;return t.is_exclusive_vat&&("JPY"==t.currency_iso_code?l=!0:"AUD"==t.currency_iso_code?h=!0:s=!0),r?a.append(c({entitlement:t.plan_units,thumb_url:t.asset.content_thumb_large_url,currency_symbol:t.currency_symbol,locale_price:t.locale_price,price:t.price,is_exclusive_vat:t.is_exclusive_vat,is_label_exclusive_vat:s,is_label_not_taxable:l,is_label_no_gst_payable:h})):(n=f.find(".js-confirm-additional-overage-div").removeClass("hidden"),n.html(u({locale_price:t.locale_price,is_exclusive_vat:t.is_exclusive_vat,is_label_exclusive_vat:s,is_label_not_taxable:l,is_label_no_gst_payable:h}))),a.on("click.saveOverage",".js-action-overage",function(){var a=e(this).closest(".modal");a.siblings(".modal-mask").remove(),a.remove(),e("body").off("click.saveOverage"),e("body").off("click.cancelOverage"),r||n.addClass("hidden"),t.next().then(function(e){i.resolve(e)}).fail(function(e){var t,n,r=e.responseJSON;r&&(t=r.error,n=r.action),t||(t=o.gettext("API::LIBRARIES::We are experiencing technical difficulties. Please try again later.")),i.reject({error:t,action:n})})}).on("click.cancelOverage",".js-overage-modal-cancel",function(){if(e("body").off("click.saveOverage"),e("body").off("click.cancelOverage"),r){var t=e(this).closest(".modal");t.siblings(".modal-mask").remove(),t.remove()}else n.addClass("hidden");i.reject({overageCancelled:!0})}),i.promise()}return t&&t.action&&"function"==typeof t.action?t.action():t}).then(function(t){if(!t||"redirecting"!==t.state){y(f,"saving"),e(".js-default-library").attr("data-lib-id",a).attr("data-lib-name",s);var i=e("#memberDefaultLibraryId").val(),o=e('.js-search-result-cell[data-content-id="'+l+'"]');0!=i.localeCompare(a)?(e(".js-hover-save-to-library-name").text(s),n.saveDefaultLibrary(a).done(function(){e("#memberDefaultLibraryId").val(a),_(o,s),"License"===r&&x(o,!0)})):(e("#memberDefaultLibraryId").val(a),_(o,s),"License"===r&&x(o,!0))}},function(t){if(t&&t.overageCancelled)return w(f),void e.Deferred().reject();var n={error:null,action:null};if(t&&t.error)n.error=t.error,n.action=t.action;else{if(t&&"PROBLEM_DOWNLOAD_IMAGE"===t.reason)return void h.displayAlertErrorModal(o.gettext("DOWNLOAD::ERROR::An error occurred with your download."),t.msg,null,function(){v(e('.search-result-cell[data-content-id="'+l+'"]'))});if(t&&"CONTENT_NOT_AVAILABLE"===t.reason)return void h.displayShortErrorModal(o.gettext("CONTENT::ERROR::Licenses for this image are no longer available."),null,function(){v(e('.search-result-cell[data-content-id="'+l+'"]'))});if(t&&"UNSUPPORTED_PAYMENT_METHOD"===t.reason)n.error=o.gettext("PURCHASE::ERROR::Sorry! You have no more images available in your subscription. More will become available next month.");else if(t&&"ENTERPRISE_NO_LICENSES"===t.reason){var r;return r="undefined"==typeof t.nb_licenses||null===t.nb_licenses?0:t.nb_licenses,void h.displayShortErrorModal(Jed.sprintf(o.ngettext("PURCHASE::ERROR::You have %s license. Please contact your administrator to add licenses to your account.","PURCHASE::ERROR::You have %s licenses. Please contact your administrator to add licenses to your account.",r),r),null,function(){v(e('.search-result-cell[data-content-id="'+l+'"]'))})}}w(f),n.error?h.displayErrorModal(o.gettext("API::LIBRARIES::Payment error"),n.error,null,function(){"signout"===n.action&&d.logout()}):h.displayErrorMsgModal(t,o.gettext("GENERIC::Something Went Wrong"),o.gettext("GENERIC::There was an error processing your request.")),e.Deferred().reject()}),p}p(n.libraries),d.ready.then(function(){l.isLoggedIn()&&n.getLibraries(!0).done(p)}),a.on(a.DEFAULT_LIBRARY_UPDATED,function(t){e("#memberDefaultLibraryId").val(t),p(n.libraries)}).on(a.LIBRARIES_UPDATED,function(){p(n.libraries)});var C=!1;e("body").on("mouseenter",".js-hover-expand-btn",function(t){t.stopPropagation();var n=e(this).data("target");e(".js-expansion").hide();var r=e(this).closest(".js-hover-container"),i=r.find(n);i.fadeToggle(300),position_right=e(window).width()-(i.offset().left+i.outerWidth()),position_right<0&&i.css({right:0,position:"absolute"}),e(".js-hover-loggedout-info-div").addClass("hidden"),e(".js-hover-expand-btn").removeClass("active"),e(this).addClass("active")}).on("mouseleave",".js-search-result-cell",function(){e(".js-loggedout-menu-description").fadeOut(300)}).on("click",".js-hover-similar-btn",function(t){t.stopPropagation(),m(e(this))}).on("click",".js-loggedout-similar-expansion",function(t){t.stopPropagation(),m(e(this))}).on("mouseenter",".js-hover-similar-btn",function(){e(".js-expansion").not(".js-loggedout-similar-expansion").fadeOut(300),e(".js-hover-expand-btn").not(".js-hover-similar-btn").removeClass("active")}).on("click",".js-toggle-expanded-menu-button",function(t){t.stopPropagation(),e(this).closest(".js-default-library-menu").siblings(".js-collapsable-libraries-menu").slideToggle()}).on("click",".js-library-hover-menu-initial-action-item",function(){e(this).closest(".js-default-library-menu").siblings(".js-collapsable-libraries-menu").slideToggle()}).on("click",".js-hover-save-to-lib",function(t){if(!C){C=!0;var r=e(this),i=r.data("action"),a=r.attr("data-lib-id"),s=r.attr("data-lib-name"),c=r.closest(".js-hover-container").attr("data-content-id"),u=e("#memberDefaultLibraryId").val();a&&s?E(r,i,a,s,c).always(function(){C=!1}):"desktop"===u?E(r,i,u,o.gettext("PHOTO::DOWNLOAD::Desktop"),c).always(function(){C=!1}):e.isEmptyObject(s)&&n.getLibraryById(u).then(function(e){return E(r,i,e.id,e.name,c)}).then(function(){C=!1}).fail(function(e){h.displayErrorMsgModal(e,o.gettext("GENERIC::Something Went Wrong"),o.gettext("GENERIC::There was an error processing your request.")),C=!1})}t.stopPropagation(),t.preventDefault()}).on("click",".js-hover-loggedout-licensing",function(t){g(e(this)),t.stopPropagation(),t.preventDefault()}).on("click",".js-loggedout-licensing-expansion",function(t){g(e(this)),t.stopPropagation(),t.preventDefault()}).on("click",".js-hover-save-to-library-name",function(t){e(this).closest(".js-default-library-menu").siblings(".js-collapsable-libraries-menu").slideToggle(),t.stopPropagation(),t.preventDefault()}).on("mouseenter",".js-hover-container",function(){e(this).css("z-index",150)}).on("mouseleave",".js-hover-container",function(){e(this).find(".js-expansion").hide(),e(".js-hover-expand-btn").removeClass("active"),e(this).css("z-index",102),e(".js-collapsable-libraries-menu").slideUp(),e(".js-hover-loggedout-info-div").addClass("hidden")}).on("click",".js-new-library",function(){b(e(this))}).on("input",".js-new-library-input",function(){var t=e(this).siblings(".js-new-library");e(this).val()?(t.show(),e(this).addClass("nonitalic")):(t.hide(),e(this).removeClass("nonitalic")),e(this).keypress(function(e){13==e.which&&b(t)})}).on("click",".js-hover-loggedout-modal-presenter",function(){var t=e(this).closest(".js-hover-menu").find(".js-hover-loggedout-info-div").removeClass("hidden");position_left=t.offset().left,position_right=e(window).width()-(t.offset().left+t.outerWidth()),position_left<0&&(t.removeClass("hover-loggedout-margin"),t.css("left",0)),position_right<0&&(t.removeClass("hover-loggedout-margin"),t.css("left",-(t.outerWidth()/2)));var n=t.offset().top+t.height()-e(window).scrollTop();if(n>window.innerHeight){var r=n-window.innerHeight;e("html, body").animate({scrollTop:e(window).scrollTop()+r+50},500)}}).on("click",".js-hover-menu",function(e){e.stopPropagation()})}),define("hbs!templates/licenseHistory",["Handlebars"],function(e){return e.template({1:function(e){return'            <a href="'+this.escapeExpression(this.lambda(null!=e?e.content_url:e,e))+'">\n                <img src="'+this.escapeExpression(this.lambda(null!=e?e.thumbnail_url:e,e))+'" />\n            </a>\n'},3:function(e){return'                <img src="'+this.escapeExpression(this.lambda(null!=e?e.thumbnail_url:e,e))+'" />\n'},5:function(e){return'        <a href="'+this.escapeExpression(this.lambda(null!=e?e.content_url:e,e))+'">#'+this.escapeExpression(this.lambda(null!=e?e.content_id:e,e))+"</a>\n"},7:function(e){return"        #"+this.escapeExpression(this.lambda(null!=e?e.content_id:e,e))+"\n"},9:function(e,t,n,r){return'            <button data-download-id32="'+this.escapeExpression(this.lambda(null!=e?e.download_id32:e,e))+'" data-content-id="'+this.escapeExpression(this.lambda(null!=e?e.content_id:e,e))+'" class="rounded-button js-btn-buy-additional-license btn-buy-additional-license detail-button-group">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"MEMBER::License Again",{name:"_",hash:{},data:r}))+'</button>\n\n            <div class="action-saving-group">\n                <i class="icon-cart small"></i>'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"FILE::ACTION::Saving...",{name:"_",hash:{},data:r}))+'\n                <img src="'+this.escapeExpression((t.staticCdn||e&&e.staticCdn||t.helperMissing).call(e,"/v1/pics/all/default/loading_circle.svg",{name:"staticCdn",hash:{},data:r}))+'" class="spinner">\n            </div>\n\n            <div class="action-wait-group">\n                <i class="icon-cart small"></i>'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"FILE::ACTION::Please wait...",{name:"_",hash:{},data:r}))+'\n                <img src="'+this.escapeExpression((t.staticCdn||e&&e.staticCdn||t.helperMissing).call(e,"/v1/pics/all/default/loading_circle.svg",{name:"staticCdn",hash:{},data:r}))+'" class="spinner">\n            </div>\n\n            <div class="action-second-overage-group">\n                <div class="second-overage-text"><span class="js-overage-price-string"></span></div>\n                <button class="rounded-button blue js-action-overage" data-content-id="'+this.escapeExpression(this.lambda(null!=e?e.content_id:e,e))+'">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"FILE::ACTION::Yes",{name:"_",hash:{},data:r}))+'</button>\n                <button class="rounded-button gray js-overage-modal-cancel" data-content-id="'+this.escapeExpression(this.lambda(null!=e?e.content_id:e,e))+'">'+this.escapeExpression((t._||e&&e._||t.helperMissing).call(e,"FILE::ACTION::Cancel",{name:"_",hash:{},data:r}))+"</button>\n            </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return'<tr>\n    <td>\n        <div class="license-image">\n'+(null!=(i=t["if"].call(e,null!=e?e.is_purchasable:e,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.program(3,r,0),data:r}))?i:"")+'        </div>\n    </td>\n    <td class="title">'+this.escapeExpression(this.lambda(null!=e?e.display_name:e,e))+"</td>\n    <td>\n"+(null!=(i=t["if"].call(e,null!=e?e.is_purchasable:e,{name:"if",hash:{},fn:this.program(5,r,0),inverse:this.program(7,r,0),data:r}))?i:"")+"    </td>\n    <td>"+this.escapeExpression(this.lambda(null!=e?e.download_date:e,e))+"</td>\n    <td>"+this.escapeExpression(this.lambda(null!=e?e.license_type:e,e))+"</td>\n    <td>"+this.escapeExpression(this.lambda(null!=e?e.team_name:e,e))+'</td>\n    <td class="action-license-history">\n'+(null!=(i=t["if"].call(e,null!=e?e.can_additional_license:e,{name:"if",hash:{},fn:this.program(9,r,0),inverse:this.noop,data:r}))?i:"")+"    </td>\n</tr>\n"},useData:!0})}),define("hbs!templates/modalWindow/message",["Handlebars"],function(e){return e.template({1:function(e){var t;return' <a href="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.message:e)?t.body_link:t,e))+'" target="_blank">'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.message:e)?t.body_link_label:t,e))+"</a>"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return'<div class="modal-message">\n    <div class="modal-window-canvas">\n        <div class="modal-window-wrapper">\n            <div class="modal-window-container">\n                <p class="modal-window-badge"><img src="'+this.escapeExpression((t.staticCdn||e&&e.staticCdn||t.helperMissing).call(e,"/v1/pics/all/default/adobeLogoAndTitle.png",{name:"staticCdn",hash:{},data:r}))+'" class="adobestock-logo" /></p>\n                <p class="modal-window-header">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.subject:i,e))+'</p>\n                <p class="modal-window-body">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.body:i,e))+(null!=(i=t["if"].call(e,null!=(i=null!=e?e.message:e)?i.body_link_label:i,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.noop,data:r}))?i:"")+'</p>\n                <p class="modal-window-footer">\n                    <a href="'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.button_link:i,e))+'" class="modal-window-dismiss-button rounded-button blue js-modal-window-dismiss-button">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.button_label:i,e))+"</a>\n                </p>\n            </div>\n        </div>\n    </div>\n</div>"},useData:!0})}),define("hbs!templates/modalWindow/confirmation",["Handlebars"],function(e){return e.template({1:function(e){var t;return'                    <div class="modal-window-thumb">\n                        <img src="'+this.escapeExpression(this.lambda(null!=(t=null!=e?e.message:e)?t.thumb_url:t,e))+'"/>\n                    </div>\n'},3:function(e){var t;return"<br>"+this.escapeExpression(this.lambda(null!=(t=null!=e?e.message:e)?t.notes:t,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return'<div class="modal-confirmation">\n    <div class="modal-window-canvas">\n        <div class="modal-window-wrapper">\n            <div class="modal-window-container">\n                <p class="modal-window-badge"><img src="'+this.escapeExpression((t.staticCdn||e&&e.staticCdn||t.helperMissing).call(e,"/v1/pics/all/default/adobeLogoAndTitle.png",{name:"staticCdn",hash:{},data:r}))+'" class="adobestock-logo" /></p>\n                <p class="modal-window-header">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.subject:i,e))+"</p>\n"+(null!=(i=t["if"].call(e,null!=(i=null!=e?e.message:e)?i.thumb_url:i,{name:"if",hash:{},fn:this.program(1,r,0),inverse:this.noop,data:r}))?i:"")+'                <p class="modal-window-body">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.question:i,e))+(null!=(i=t["if"].call(e,null!=(i=null!=e?e.message:e)?i.notes:i,{name:"if",hash:{},fn:this.program(3,r,0),inverse:this.noop,data:r}))?i:"")+'</p>\n                <p class="modal-window-footer">\n                    <a href="javascript:void(0);" class="modal-window-cancel-button rounded-button gray js-modal-window-cancel-button">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.cancel_button_label:i,e))+'</a>\n                    <a href="javascript:void(0);" class="modal-window-confirm-button rounded-button blue js-modal-window-confirm-button">'+this.escapeExpression(this.lambda(null!=(i=null!=e?e.message:e)?i.confirm_button_label:i,e))+"</a>\n                </p>\n            </div>\n        </div>\n    </div>\n</div>"},useData:!0})}),define("lib/hbsBasicHelpers",["page_config","Handlebars"],function(e,t){return t.registerHelper("staticCdn",function(t){return e.static_base_uri+t}),t.registerHelper("linkBuilder",function(e,n){var r,i=[],a=["class","target"];return a.forEach(function(e){n.hash[e]&&i.push(e+'="'+t.escapeExpression(n.hash[e])+'"')}),i.push('href="'+t.escapeExpression(e)+'"'),r=n.hash.text?n.hash.text:e,r?new t.SafeString("<a "+i.join(" ")+">"+t.escapeExpression(r)+"</a>"):""}),t}),define("lib/modal-window",["jquery","Handlebars","lib/window","i18n-config","hbs!templates/modalWindow/message","hbs!templates/modalWindow/confirmation","lib/hbsBasicHelpers"],function(e,t,n,r,i,a){var o=function(e){var t=45;return e=e.trim(),e.length>t&&(e=e.substring(0,t-3)+"..."),s({subject:Jed.sprintf(r.gettext('MODAL::Delete "%s"'),e),question:Jed.sprintf(r.gettext('MODAL::Are you sure you want to delete "%s"?'),e),notes:r.gettext("MODAL::This library will no longer be available to anyone who shares it.")})},s=function(e){return"undefined"==typeof e&&(e={}),"undefined"==typeof e.confirm_button_label&&(e.confirm_button_label=r.gettext("MODAL::Delete")),l("confirmation",e)},c=function(e){return"undefined"==typeof e&&(e={}),"undefined"==typeof e.subject&&(e.subject=r.gettext("CHECKOUT::You're Ready to Go!")),"undefined"==typeof e.body&&(e.body=r.gettext("CHECKOUT::You now have access to a growing collection of millions of images, conveniently integrated into Adobe Illustrator CC, Adobe InDesign CC, Adobe Photoshop CC, Adobe After Effects CC and Adobe Premiere Pro CC.")),"undefined"==typeof e.button_label&&(e.button_label=r.gettext("PLANS::Okay")),"undefined"==typeof e.button_link&&(e.button_link="javascript:void(0);"),l("message",e)},u=function(e,t,n){var r={thumb_url:e,subject:t,question:n};return l("confirmation",r)},l=function(t,o){var s=e.Deferred(),c=e('<div style="display: none;"></div>');switch(t){case"message":"undefined"!=typeof o.button_link&&o.button_link&&o.button_link!=n.getPath()||(o.button_link="javascript:void(0);"),c.html(i({message:o})),c.find(".js-modal-window-dismiss-button").click(function(){c.remove(),s.resolve()});break;case"confirmation":"undefined"==typeof o.cancel_button_label&&(o.cancel_button_label=r.gettext("MODAL::Cancel")),"undefined"==typeof o.confirm_button_label&&(o.confirm_button_label=r.gettext("MODAL::Ok")),c.html(a({message:o})),c.find(".js-modal-window-confirm-button").click(function(){c.remove(),s.resolve()}),c.find(".js-modal-window-cancel-button").click(function(){c.remove(),s.reject()});break;default:throw new Error("Unregistered message template: "+t)}return o.thumb_url&&c.find(".modal-window-container").addClass("with-thumb"),e("body").append(c),c.show(),e("body").find(".modal-window-canvas").removeClass("grey").first().addClass("grey"),s.promise()};return{show:l,showSuccessfulPlanPurchaseMessage:c,showDeleteConfirmation:s,showLibraryDeleteConfirmation:o,showBadgedModalConfirmationWithThumbnail:u}}),require(["jquery","lib/hoverMenu","lib/member","page_config","hbs!templates/licenseHistory","hbs!templates/overageModal","lib/workflowController","lib/error","i18n-config","Handlebars","lib/modal-window","lib/assetsStore"],function(e,t,n,r,i,a,o,s,c,u,l,h){function d(e){return h.getAsset(e,h.ASSET_DETAIL.BASIC).then(function(e){var t=c.gettext("FILE::ACTION::Buy Additional License"),n=c.gettext("FILE::ACTION::Are you sure you want to license this image again?");return l.showBadgedModalConfirmationWithThumbnail(e.content_thumb_large_url,t,n)})}function p(t,n,r,u,l,h,d){l.removeClass(h.join(" ")).addClass("wait");var p=o.buyAdditionalLicense(r,t);p.then(function(t){if(t&&"OVERAGE"===t.action){var n=!t.isInlineOverageConfirmation,i=e.Deferred(),o=!1,s=!1,u=!1;return t.is_exclusive_vat&&("JPY"==t.currency_iso_code?s=!0:"AUD"==t.currency_iso_code?u=!0:o=!0),n?e("body").append(a({entitlement:t.plan_units,thumb_url:t.asset.content_thumb_large_url,currency_symbol:t.currency_symbol,locale_price:t.locale_price,price:t.price,is_exclusive_vat:t.is_exclusive_vat,is_label_exclusive_vat:o,is_label_not_taxable:s,is_label_no_gst_payable:u,content_id:r})):(l.find(".js-overage-price-string").html(f(t.locale_price)),l.removeClass(h.join(" ")).addClass("second-overage")),d.on("click.saveOverage"+r,'.js-action-overage[data-content-id="'+r+'"]',function(){if(n){var a=e(this).closest(".modal");
a.siblings(".modal-mask").remove(),a.remove()}else l.removeClass(h.join(" ")).addClass("saving");d.off("click.saveOverage"+r),d.off("click.cancelOverage"+r),t.next().then(function(e){i.resolve(e)},function(e){var t,n,r=e.responseJSON;r&&(t=r.error,n=r.action),t||(t=c.gettext("API::LIBRARIES::We are experiencing technical difficulties. Please try again later.")),i.reject({error:t,action:n})})}).on("click.cancelOverage"+r,'.js-overage-modal-cancel[data-content-id="'+r+'"]',function(){if(d.off("click.saveOverage"+r),d.off("click.cancelOverage"+r),n){var t=e(this).closest(".modal");t.siblings(".modal-mask").remove(),t.remove()}l.removeClass(h.join(" "))}),i.promise()}return t&&t.action&&"function"==typeof t.action?t.action():t}).then(function(t){l.removeClass(h.join(" "));var n=i(t);e(n).insertBefore(u.children().first())},function(e){if(!e||!e.overageCancelled){var t={error:null,action:null};if(e&&e.error)t.error=e.error,t.action=e.action;else{if(e&&"CONTENT_NOT_AVAILABLE"===e.reason)return void s.displayShortErrorModal(c.gettext("CONTENT::ERROR::Licenses for this image are no longer available."),null,function(){l.removeClass(h.join(" "))});if(e&&"UNSUPPORTED_PAYMENT_METHOD"===e.reason)t.error=c.gettext("PURCHASE::ERROR::Sorry! You have no more images available in your subscription. More will become available next month.");else{if(e&&"ENTERPRISE_NO_LICENSES"===e.reason){var n;return n="undefined"==typeof e.nb_licenses||null===e.nb_licenses?0:e.nb_licenses,void s.displayShortErrorModal(Jed.sprintf(c.ngettext("PURCHASE::ERROR::You have %s license. Please contact your administrator to add licenses to your account.","PURCHASE::ERROR::You have %s licenses. Please contact your administrator to add licenses to your account.",n),n),null,function(){l.removeClass(h.join(" "))})}t.error=c.gettext("MEMBER::ERROR::Failed to purchase an additional license.")}}s.displayErrorModal(c.gettext("API::LIBRARIES::Payment error"),t.error,null,function(){"signout"===t.action&&susi.logout()})}})}var f=u.compile('{{sprintf (_ "FILE::ACTION::Pay %s for this image?") this }}'),g=e("body");g.on("click",".js-btn-buy-additional-license",function(t){t.preventDefault(),t.stopPropagation();var n=e(this).data("download-id32"),r=e(".badge"),i=e(this).data("content-id"),a=e(".license-history .table tbody"),o=e(this).parent(".action-license-history"),s=["saving","second-overage","wait"];d(i).then(function(){p(n,r,i,a,o,s,g)})})}),define("licenseHistory",function(){}),define("css",[],function(){if("undefined"==typeof window)return{load:function(e,t,n){n()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,r=!0;t[1]||t[7]?n=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]||t[8]?r=!1:t[4]&&(n=parseInt(t[4])<18);var i={};i.pluginBuilder="./css-builder";var a,o,s,c=function(){a=document.createElement("style"),e.appendChild(a),o=a.styleSheet||a.sheet},u=0,l=[],h=function(e){u++,32==u&&(c(),u=0),o.addImport(e),a.onload=function(){d()}},d=function(){s();var e=l.shift();return e?(s=e[1],void h(e[0])):void(s=null)},p=function(e,t){if(o&&o.addImport||c(),o&&o.addImport)s?l.push([e,t]):(h(e),s=t);else{a.textContent='@import "'+e+'";';var n=setInterval(function(){try{a.sheet.cssRules,clearInterval(n),t()}catch(e){}},10)}},f=function(t,n){var i=document.createElement("link");if(i.type="text/css",i.rel="stylesheet",r)i.onload=function(){i.onload=function(){},setTimeout(n,7)};else var a=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==i.href)return clearInterval(a),n()}},10);i.href=t,e.appendChild(i)};return i.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},i.load=function(e,t,r){(n?p:f)(t.toUrl(e+".css"),r)},i}),define("hbs!templates/licenseBadge",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return'<span class="badge">'+this.escapeExpression((t.number||e&&e.number||t.helperMissing).call(e,null!=(i=null!=(i=null!=e?e.member:e)?i.default_entitlement:i)?i.total_available_downloads:i,{name:"number",hash:{},data:r}))+"</span> "+this.escapeExpression((t.ngettext||e&&e.ngettext||t.helperMissing).call(e,"HEADER::MEMBER::Image","HEADER::MEMBER::Images",null!=(i=null!=(i=null!=e?e.member:e)?i.default_entitlement:i)?i.total_available_downloads:i,{name:"ngettext",hash:{},data:r}))},useData:!0})}),define("lib/globalnav",["jquery","lib/uiEvents","lib/member","hbs!templates/licenseBadge","page_config","lib/susi"],function(e,t,n,r,i,a){require([i.globalnav.js,"css!"+i.globalnav.css]);var o=null;return t.on(t.ENTITLEMENT_UPDATED,function(){var t=n.getDefaultEntitlement(),i={member:{default_entitlement:t}};e("#memberLicensesCounter").html(r(i))}),a.ready.then(function(){e(".avatar-username").html(n.getUsername())}),e("body").on("click",".js-gnav-section",function(t){var n=e(this).data("gnavsection");o&&o.openSection(n),t.preventDefault()}).on("click",".js-profile-expand",function(t){e(".header-dropdown-menu").toggleClass("hidden"),e(this).parent("li.avatar").toggleClass("avatar-active");var n=e(".header-dropdown-menu ul"),r=e(".header-menu li.avatar"),i=10;n.css("top",e(".header").height()),n.css("right",e(window).width()-(r.offset().left+r.outerWidth()-i)),t.preventDefault(),t.stopPropagation()}).on("click",function(){e(".header-dropdown-menu").addClass("hidden"),e("li.avatar").hasClass("avatar-active")&&e("li.avatar").toggleClass("avatar-active")}),{initGlobalNav:function(){require([i.globalnav.js,"css!"+i.globalnav.css],function(){o=new window.AdobeGlobalNav({adobeid:window.adobeid,sections:["sitemap","profile"],locale:e("body").data("locale"),events:{avatar:function(t){var n=e(".avatar-img");n.css("background-image")!="url("+t+")"&&(n.css("background-image","url("+t+")"),e.post(i.base_url+"/Ajax/Member/SaveAvatar",{avatar:t}))}}}),window.adobeGlobalNav=o})},getNav:function(){return o}}}),define("lib/footer",["jquery","lib/cookie","page_config"],function(e,t,n){var r=e(".js-region-modal-canvas");e(".region-selector-toggler").on("click",function(e){e.preventDefault(),r.show()}),e("body").on("click",".modal-toggler",function(){r.hide()}),e("body").on("click",".region-link",function(){var r=e(this).attr("href").replace(/[\/]/g,""),i=new Date,a=i.getTime();i.setTime(a+31536e6),t(n.SUSI.COOKIE_VHOST,r,{path:"/",expires:i})})}),define("lib/header",["jquery"],function(e){e("body").on("click",".js-switch-team",function(){var t=e("#details-wrapper"),n=e(this);"block"==t.css("display")&&n.attr("href",n.attr("href")+"?return_id="+t.find(".js-details").data("content_id"))})}),define("lib/prettyCheckbox",["jquery"],function(e){function t(e){var t=e.find("input").is(":checked");t?e.find("i").addClass("active"):e.find("i").removeClass("active")}var n=e("body");return n.on("change",".js-pretty-checkbox input",function(){if("radio"===e(this).attr("type")){var r=e(this).attr("name"),i=r.replace("[","\\[").replace("]","\\]");$radios=n.find("input[name="+i+"]"),$radios.each(function(){t(e(this).closest(".js-pretty-checkbox"))})}else t(e(this).closest(".js-pretty-checkbox"))}),e(".js-pretty-checkbox").each(function(){t(e(this))}),{updateCheckboxStateForPrettyCheckbox:t}}),function(e){"function"==typeof define&&define.amd?define("vendor/bootstrap/dropdown",["jquery"],e):e(jQuery)}(function(e){function t(t){t&&3===t.which||(e(i).remove(),e(a).each(function(){var r=e(this),i=n(r),a={relatedTarget:this};i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown",a)),t.isDefaultPrevented()||(r.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",a)))}))}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}function r(t){return this.each(function(){var n=e(this),r=n.data("bs.dropdown");r||n.data("bs.dropdown",r=new o(this)),"string"==typeof t&&r[t].call(n)})}var i=".dropdown-backdrop",a='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.4",o.prototype.toggle=function(r){var i=e(this);if(!i.is(".disabled, :disabled")){var a=n(i),o=a.hasClass("open");if(t(),!o){"ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var s={relatedTarget:this};if(a.trigger(r=e.Event("show.bs.dropdown",s)),r.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),a.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var r=e(this);if(t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled")){var i=n(r),o=i.hasClass("open");if(!o&&27!=t.which||o&&27==t.which)return 27==t.which&&i.find(a).trigger("focus"),r.trigger("click");var s=" li:not(.disabled):visible a",c=i.find('[role="menu"]'+s+', [role="listbox"]'+s);if(c.length){var u=c.index(t.target);38==t.which&&u>0&&u--,40==t.which&&u<c.length-1&&u++,~u||(u=0),c.eq(u).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=r,e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",a,o.prototype.toggle).on("keydown.bs.dropdown.data-api",a,o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',o.prototype.keydown)}),require(["jquery","page_config","lib/susi","lib/globalnav","lib/member","lib/checkout","lib/modal-window","lib/uiEvents","lib/footer","lib/header","lib/prettyCheckbox","vendor/bootstrap/dropdown"],function(e,t,n,r,i,a,o){e.ajaxSetup({headers:{"X-Request-Id":t.x_request_id}}),i.setStockProfile(t.member),n.configure(t.SUSI),r.initGlobalNav(),n.initPage(),n.loadPageIMS(),a.init(t.ANYWARE),t.flash_messages&&e.each(t.flash_messages,function(t,n){e.each(n,function(e,n){o.show(t,n)})})}),define("adobestock",function(){});