g367CB268B1094004A3689751E7AC568F.Modules.PopUnder=function(media,topWindow){var Module={Loader:g367CB268B1094004A3689751E7AC568F,Media:media,_Top:topWindow,PopWin:null,PopLoaded:false,PopRedirectDelay:200,Init:function(){var _this=this;window.console=window.console||{log:function(d){}};console.log("INF_PU: Initiated");var g=g367CB268B1094004A3689751E7AC568F;var uaParser=new UAParser();var os=uaParser.getOS();var device=uaParser.getDevice();var browser=uaParser.getBrowser();if(this.Media.Settings.AttachEvent){var element=this._Top.document.getElementById(this.Media.Settings.AttachEvent);if(element!=null){this.AddEvent(element,"click",function(e){_this.CreatePop(e)})}}else{if(g.IsMobile.any(Module._Top)){if(os.name=="iOS"&&parseFloat(os.version)<parseFloat("6")){return}if(device.vendor=="Samsung"&&os.name=="Android"){return}if(g.IsMobile.Windows(Module._Top)){return}var userAgent=uaParser.getUA();if(userAgent.indexOf("FBAN/FBIOS")>-1||userAgent.indexOf("FB_IAB/FB4A")>-1||userAgent.indexOf("FBAV")>-1){return}var createMobilePop=function(event){var link=event.target||event.srcElement;if(Module.Loader.IsDontTriggerForSelectorMatch(Module.Media.Settings.PopUnderDontTriggerSelector,link)){return}if(link.nodeName.toLowerCase()!=="a"){link=_this.Loader.GetParentLink(link)}if(link.nodeName.toLowerCase()==="a"&&link.getAttribute("href")!="#"&&link.getAttribute("href").indexOf("javascript:")==-1&&link.getAttribute("target")!=="_blank"){if(Module.PopLoaded){return true}Module.PopLoaded=true;Module.AdShown=true;if(Module.Loader.IsCapped("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.cap)){return true}Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);if(Module.Media.Settings.Tracking===true){Module.DoTrackingPop()}else{if(os.name==="iOS"&&(browser.name==="Chrome"||(browser.name==="Mobile Safari"&&parseFloat(browser.version)<parseFloat("8")))){window.open(link.getAttribute("href"))}else{if(Module.Media.Settings.MobileHistory){var w=window.open("about:blank");w.history.replaceState({previous:Module._Top.location.href},null,Module._Top.location.href);w.addEventListener("popstate",function(e){w.location=e.state.previous});w.location=link.getAttribute("href")}else{window.open(link.getAttribute("href"))}}var redirectUrl=g.FetchMediaUrl(Module.Media);if(os.name=="Android"){link.setAttribute("href",redirectUrl)}Module._Top.document.location=redirectUrl}if(event.preventDefault!==undefined){event.preventDefault()}return false}return true};g.BindOnDocmentClick(createMobilePop)}else{if(this._Top.chrome){try{if(navigator.mimeTypes["application/x-shockwave-flash"]&&!Module.Media.Settings.Tracking&&!Module.Loader.IsCapped("InfNumPops"+Module.Media.ZoneId,"InfNumPopsExpire"+Module.Media.ZoneId,Module.Media.Settings.cap)&&!Module.Media.Settings.ChromeTabunder&&(Module.Media.Settings.SameTabAdSettings===undefined||(Module.Media.Settings.SameTabAdSettings.AdblockOnly&&!g.IsAdblockRequest)||!Module.Media.Settings.SameTabAdSettings.Chrome)){if(os.name==="Mac OS"){Module.Media.Settings.SameTabAdSettings={};Module.Media.Settings.SameTabAdSettings.AdblockOnly=Module.Media.Settings.SameTabAdSettings.AdblockOnly||false;Module.Media.Settings.SameTabAdSettings.Chrome=true;Module.Media.Settings.SameTabAdSettings.Firefox=Module.Media.Settings.SameTabAdSettings.Firefox||false;Module.Media.Settings.SameTabAdSettings.IE=Module.Media.Settings.SameTabAdSettings.IE||false;Module.Media.Settings.SameTabAdSettings.Safari=Module.Media.Settings.SameTabAdSettings.Safari||false}else{Module.Loader.InitChromePopunder(media);return}}}catch(err){g367CB268B1094004A3689751E7AC568F.LogError(err)}this.AddEvent(this._Top.document,"click",function(e){if(Module.PopLoaded){return}try{if(((e.srcElement.nodeName.toLowerCase()==="a"&&(e.srcElement.getAttribute("target")==="_blank"||e.srcElement.getAttribute("rel")==="nofollow"))||Module.Loader.GetParentLink(e.srcElement).getAttribute("target")==="_blank"||Module.Loader.GetParentLink(e.srcElement).getAttribute("rel")==="nofollow")&&Module.Media.Settings.RespectTargetBlank){return}}catch(err){g367CB268B1094004A3689751E7AC568F.LogError(err)}Module.PopLoaded=true;Module.CreateChromePop(e)})}else{this.AddEvent(this._Top.document,"click",function(e){if(_this.Media.Settings.RequireOffsiteClick){var obj=_this.GetAnchorElement(e);if(obj==null||_this._Top.location.host.indexOf(_this.GetRootDomain(obj.href))!=-1){return}}_this.CreatePop(e)})}}}},CreateChromePop:function(event){var scriptHost=g367CB268B1094004A3689751E7AC568F.ScriptHost;var domainAliasUrl=this.Media.Settings.PublisherDomainAliasUrl;var isAdblockPlusEnabled=g367CB268B1094004A3689751E7AC568F.IsAdblockRequest;if(Module.Loader.Storage.FailedLocalStorage){return}var popURL="about:blank";var popID="ad_"+Math.floor(89999999*Math.random()+10000000);var pxLeft=0;var pxTop=0;pxLeft=(this.Loader.GetWindowLeft()+(this.Loader.GetWindowWidth()/2)-(this.Media.Settings.Width/2));pxTop=(this.Loader.GetWindowTop()+(this.Loader.GetWindowHeight()/2)-(this.Media.Settings.Height/2));var sOptions="toolbar=no,scrollbars=yes,location=yes,statusbar=yes,menubar=no,resizable=1,width="+this.Media.Settings.Width.toString()+",height="+this.Media.Settings.Height.toString()+",screenX="+pxLeft+",screenY="+pxTop;if(!Module.Loader.IsCapped("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.cap)){var link=event.target||event.srcElement;if(Module.Loader.IsDontTriggerForSelectorMatch(Module.Media.Settings.PopUnderDontTriggerSelector,link)){return}if(link.nodeName.toLowerCase()!=="a"){link=Module.Loader.GetParentLink(link)}var doChromeSameTabAd=function(){uaParser=new UAParser();var userAgent=uaParser.getUA();if(userAgent.indexOf("FBAN/FBIOS")>-1||userAgent.indexOf("FB_IAB/FB4A")>-1||userAgent.indexOf("FBAV")>-1){Module.PopLoaded=true;return}if(link.tagName.toLowerCase()==="a"&&link.getAttribute("href").lastIndexOf("javascript:",0)!==0){event.preventDefault();Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);link.setAttribute("data-tabunder",true);var tabWinName="inftabwindow_"+Math.floor((Math.random()*100000000)+1).toString();var w;var currentUrl=top.document.location.href;var reg=/#$/;var targetUrl=link.href.replace(reg,"");try{w=window.open("about:blank",tabWinName);w.history.replaceState({previous:currentUrl},null,currentUrl);w.addEventListener("popstate",function(e){w.location=e.state.previous});w.location=targetUrl}catch(err){w=window.open(targetUrl,tabWinName)}w.focus();Module.PopLoaded=true;Module._Top.location.href=Module.Loader.FetchMediaUrl(Module.Media,true)}else{Module.PopLoaded=false}};var doChromeTabunder=function(){Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);var url=Module.Loader.FetchMediaUrl(Module.Media,true);var l=Module._Top.document.createElement("a");l.setAttribute("data-tabunder",true);if(Module.Media.Settings.UseRemoteMediaHost==="true"&&isAdblockPlusEnabled){if(Module.Media.Settings.UsePopCustomHost==="true"){l.href=Module.Media.Settings.PopCustomHostUrl}else{l.href=Module._Top.document.location.href}setTimeout(function(){w.location.href=url},Module.PopRedirectDelay)}else{l.href=url}var tabWinName="inftabwindow_"+Math.floor((Math.random()*100000000)+1).toString();l.target=tabWinName;Module._Top.document.body.appendChild(l);var e=Module._Top.document.createEvent("MouseEvents");e.initMouseEvent("click",true,true,Module._Top,0,0,0,0,0,true,false,false,true,0,null);l.dispatchEvent(e)};var doChromePopunder=function(){Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);var url=Module.Loader.FetchMediaUrl(Module.Media);if(Module.Media.Settings.UseRemoteMediaHost==="true"&&isAdblockPlusEnabled){var randPopUrl;if(Module.Media.Settings.UsePopCustomHost==="true"){randPopUrl=Module.Media.Settings.PopCustomHostUrl}else{randPopUrl=Module._Top.document.location.href}var randW=window.open(randPopUrl,popID,sOptions);setTimeout(function(){randW.location.href=url},Module.PopRedirectDelay)}else{window.open(url,popID,sOptions)}};if(Module.Media.Settings.Tracking===true){Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);Module.DoTrackingPop()}else{if(Module.Media.Settings.SameTabAdSettings!==undefined&&Module.Media.Settings.SameTabAdSettings.Chrome){if(Module.Media.Settings.SameTabAdSettings.AdblockOnly){if(isAdblockPlusEnabled){doChromeSameTabAd()}else{if(Module.Media.Settings.ChromeTabunder){doChromeTabunder()}else{doChromePopunder()}}}else{doChromeSameTabAd()}}else{if(Module.Media.Settings.ChromeTabunder||this._Top.navigator.userAgent.indexOf("Chrome/33.0.1750.146")>-1){doChromeTabunder()}else{doChromePopunder()}}}}},CreatePop:function(event){if(Module.PopLoaded){return}var uaParser=new UAParser();var browser=uaParser.getBrowser();var scriptHost=g367CB268B1094004A3689751E7AC568F.ScriptHost;var domainAliasUrl=Module.Media.Settings.PublisherDomainAliasUrl;var isAdblockPlusEnabled=g367CB268B1094004A3689751E7AC568F.IsAdblockRequest;var link=event.target||event.srcElement;if(Module.Loader.IsDontTriggerForSelectorMatch(Module.Media.Settings.PopUnderDontTriggerSelector,link)){return}if(link.nodeName.toLowerCase()!=="a"){link=Module.Loader.GetParentLink(link)}Module.PopLoaded=true;if(Module.Loader.IsCapped("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.cap)){return}if(Module.Loader.Storage.FailedLocalStorage){return}var doSameTabAd=function(){uaParser=new UAParser();var userAgent=uaParser.getUA();if(userAgent.indexOf("FBAN/FBIOS")>-1||userAgent.indexOf("FB_IAB/FB4A")>-1||userAgent.indexOf("FBAV")>-1){Module.PopLoaded=true;return}if(link.tagName.toLowerCase()==="a"&&link.getAttribute("href").lastIndexOf("javascript:",0)!==0){event.preventDefault();Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);link.setAttribute("data-tabunder",true);var tabWinName="inftabwindow_"+Math.floor((Math.random()*100000000)+1).toString();var w;var currentUrl=Module._Top.document.location.href;var reg=/#$/;var targetUrl=link.href.replace(reg,"");try{w=window.open("about:blank",tabWinName);w.history.replaceState({previous:currentUrl},null,currentUrl);w.onpageshow=function(e){if(e.persisted){w.location.reload()}};w.addEventListener("popstate",function(e){w.location=e.state.previous});w.location=targetUrl}catch(e){console.log(e);w=window.open(targetUrl,tabWinName)}w.focus();Module.PopLoaded=true;Module._Top.location.href=Module.Loader.FetchMediaUrl(Module.Media,true)}else{Module.PopLoaded=false}};var doPopunder=function(){if(browser.name==="IE"){if((event.srcElement.nodeName.toLowerCase()==="a"&&event.srcElement.getAttribute("target")=="_blank")||Module.Loader.GetParentLink(event.srcElement).getAttribute("target")=="_blank"){return}}var popURL="about:blank";var popID="ad_"+Math.floor(89999999*Math.random()+10000000);var pxLeft=0;var pxTop=0;pxLeft=(Module.Loader.GetWindowLeft()+(Module.Loader.GetWindowWidth()/2)-(Module.Media.Settings.Width/2));pxTop=(Module.Loader.GetWindowTop()+(Module.Loader.GetWindowHeight()/2)-(Module.Media.Settings.Height/2));popURL=Module.Loader.FetchMediaUrl(Module.Media);var options="scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,top="+pxTop+",left="+pxLeft+",width="+Module.Media.Settings.Width+",height="+Module.Media.Settings.Height+"index=0,total=1";Module.PopWin=window.open(popURL,popID,options);if(Module.PopWin){Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);Module.PopWin.blur();Module.PopWin.opener.window.focus();Module._Top.self.window.focus();Module._Top.focus();try{var ghost;if(browser.name==="Firefox"){ghost=window.open("about:blank");ghost.focus();ghost.close()}if(browser.name==="Safari"){var nothing="";ghost=Module._Top.window.document.createElement("a");ghost.href="data:text/html,<scr"+nothing+"ipt>window.close();</scr"+nothing+"ipt>";Module._Top.document.getElementsByTagName("body")[0].appendChild(ghost);var clk=top.window.document.createEvent("MouseEvents");clk.initMouseEvent("click",false,true,Module._Top,0,0,0,0,0,true,false,false,true,0,null);ghost.dispatchEvent(clk);ghost.parentNode.removeChild(ghost)}if(browser.name==="IE"){var _this=Module;_this._Top.document.focus()}}catch(err){g367CB268B1094004A3689751E7AC568F.LogError(err)}}else{Module.PopLoaded=false}};if(Module.Media.Settings.Tracking===true){Module.Loader.IncrementCap("InfNumPops"+media.ZoneId,"InfNumPopsExpire"+media.ZoneId,media.Settings.capLength);Module.DoTrackingPop()}else{if(browser.name==="Firefox"&&Module.Media.Settings.SameTabAdSettings!==undefined&&Module.Media.Settings.SameTabAdSettings.Firefox){if(Module.Media.Settings.SameTabAdSettings.AdblockOnly){if(isAdblockPlusEnabled){doSameTabAd()}else{doPopunder()}}else{doSameTabAd()}}else{if(browser.name==="IE"&&Module.Media.Settings.SameTabAdSettings!==undefined&&Module.Media.Settings.SameTabAdSettings.InternetExplorer){if(Module.Media.Settings.SameTabAdSettings.AdblockOnly){if(isAdblockPlusEnabled){doSameTabAd()}else{doPopunder()}}else{doSameTabAd()}}else{if(browser.name==="Safari"&&Module.Media.Settings.SameTabAdSettings!==undefined&&Module.Media.Settings.SameTabAdSettings.Safari){if(Module.Media.Settings.SameTabAdSettings.AdblockOnly){if(isAdblockPlusEnabled){doSameTabAd()}else{doPopunder()}}else{doSameTabAd()}}else{doPopunder()}}}}},DoTrackingPop:function(){var iframe=Module._Top.document.createElement("iframe");iframe.setAttribute("style","display:none;");Module._Top.document.body.appendChild(iframe);iframe.src=Module.Loader.FetchMediaUrl(Module.Media)},GetAnchorElement:function(e){if(!e){e=this._Top.window.event}var srcElement=e.srcElement?e.srcElement:e.target;do{if(srcElement.tagName=="A"){return srcElement}if(srcElement.parentNode){srcElement=srcElement.parentNode}}while(srcElement.parentNode);return null},GetRootDomain:function(src){var baseUrl="";var rootDomain="";if(src.length>0){baseUrl=src}else{baseUrl=this._Top.document.location.href}rootDomain=baseUrl.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0];return rootDomain},AddEvent:function(target,eventName,handlerName){if(target.addEventListener){target.addEventListener(eventName,eval(handlerName),false)}else{if(target.attachEvent){target.attachEvent("on"+eventName,eval(handlerName))}else{var originalHandler=target["on"+eventName];if(originalHandler){target["on"+eventName]=eval(handlerName)}else{target["on"+eventName]=eval(handlerName)}}}},ChromeDomReady:function(callback){if(Module._Top.document.readyState!="loading"){callback()}if(Module._Top.document.addEventListener){Module._Top.document.addEventListener("DOMContentLoaded",callback,false)}}};Module.Init()};